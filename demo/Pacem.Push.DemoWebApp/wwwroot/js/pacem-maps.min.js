/**
 * pacem v0.20.0-alexandria (https://js.pacem.it)
 * Copyright 2021 Pacem (https://pacem.it)
 * Licensed under MIT
 */
var Pacem,__decorate=this&&this.__decorate||function(e,t,o,a){var n,s=arguments.length,i=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,a);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(i=(s<3?n(i):s>3?n(t,o,i):n(t,o))||i);return s>3&&i&&Object.defineProperty(t,o,i),i};!function(e){!function(t){!function(o){o.MapConsts={MAP_SELECTOR:e.P+"-map",LINK_SELECTOR:e.P+"-map-link",MARKER_SELECTOR:e.P+"-map-marker",POLYLINE_SELECTOR:e.P+"-map-polyline",CIRCLE_SELECTOR:e.P+"-map-circle",LAYER_SELECTOR:e.P+"-map-layer",DEFAULT_COORDS:{lat:44.71418802507798,lng:10.296516444873811}};o.MapUtils=class MapUtils{static parseCoords(t){if(t&&!isNaN(t.lat)&&!isNaN(t.lng))return[t.lat,t.lng];if(e.Utils.isArray(t)&&t.length>1)return[t[0],t[1]];if(/^\s*(\+|-)?[\d]+(.[\d]+)?\s*,\s*(\+|-)?[\d]+(.[\d]+)?\s*$/.test(t)){var a=t.split(",");return[parseFloat(a[0]),parseFloat(a[1])]}return[o.MapConsts.DEFAULT_COORDS.lat,o.MapConsts.DEFAULT_COORDS.lng]}static expandBounds(e,t){t&&(Array.isArray(t)||(t=[t.lat,t.lng]),e.push(t))}static isContentEmpty(e){return 0==e.children.length}};class MapRelevantElement extends t.PacemEventTarget{get map(){return this._map=this._map||e.CustomElementUtils.findAncestorOfType(this,s)}viewActivatedCallback(){super.viewActivatedCallback(),this.map&&this.map.register(this)}disconnectedCallback(){this.map&&this.map.unregister(this),super.disconnectedCallback()}}__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],MapRelevantElement.prototype,"hide",void 0),o.MapRelevantElement=MapRelevantElement;class PacemMapAdapterElement extends t.PacemEventTarget{updateMapElement(e,t,o){var a,n;const s=t.lat,i=t.lng;e.zoom=o,s==(null===(a=e.center)||void 0===a?void 0:a.lat)&&i==(null===(n=e.center)||void 0===n?void 0:n.lng)||(e.center={lat:s,lng:i})}}o.PacemMapAdapterElement=PacemMapAdapterElement;class MapEvent extends e.CustomTypedEvent{constructor(e,t){super(e,t)}}o.MapEvent=MapEvent;let a=class PacemMapMarkerElement extends MapRelevantElement{onDragEnd(e){this.position=e,this.dispatchEvent(new MapEvent("dragend",{position:e}))}onInfoOpen(){this.dispatchEvent(new MapEvent("openinfo"))}onInfoClose(){this.dispatchEvent(new MapEvent("closeinfo"))}};__decorate([e.Watch({converter:e.PropertyConverters.Json})],a.prototype,"position",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],a.prototype,"icon",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],a.prototype,"caption",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],a.prototype,"draggable",void 0),a=__decorate([e.CustomElement({tagName:o.MapConsts.MARKER_SELECTOR})],a),o.PacemMapMarkerElement=a;let n=class PacemMapLayerElement extends MapRelevantElement{};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],n.prototype,"url",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],n.prototype,"include",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],n.prototype,"mode",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],n.prototype,"minZoom",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],n.prototype,"maxZoom",void 0),n=__decorate([e.CustomElement({tagName:o.MapConsts.LAYER_SELECTOR})],n),o.PacemMapLayerElement=n;let s=class PacemMapElement extends t.PacemEventTarget{constructor(){super(...arguments),this.zoom=12,this.center=o.MapConsts.DEFAULT_COORDS,this.scale=!0,this.mousewheel=!0,this.draggable=!0,this.doubleClickZoom=!0,this.keyboardShortcuts=!0,this.autofit=!0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this._drawHandler=e=>{this._draw(e.target)},this._initialized=!1,this._afterInit=(t,o)=>{for(var a of(this._initialized=!0,e.CustomElementUtils.findDescendants(this,(e=>e instanceof MapRelevantElement))))this._erase(a,o),this._draw(a);null==o||o.destroy(this)},this._resizeHandler=e=>{this.onResize(e)}}get container(){return this._container}register(t){t.addEventListener(e.PropertyChangeEventName,this._drawHandler,!1),this._draw(t)}unregister(t){this._erase(t),t.removeEventListener(e.PropertyChangeEventName,this._drawHandler,!1)}_draw(e,t=this.adapter){this._initialized&&t&&t.drawItem(e)}_erase(e,t=this.adapter){this._initialized&&t&&t.removeItem(e)}propertyChangedCallback(t,o,a,n){if(super.propertyChangedCallback(t,o,a,n),"adapter"===t)e.Utils.isNull(this._container)||(this._initialized=!1,this.adapter.initialize(this).then((e=>this._afterInit(e,o))));else{switch(t){case"zoom":case"center":this.adapter&&this.adapter.setView(a);break;case"autofit":a&&this.adapter&&this.adapter.fitBounds()}this.adapter&&this.adapter.invalidateSize()}}viewActivatedCallback(){super.viewActivatedCallback();const t=this._container=document.createElement("div");e.Utils.addClass(t,e.PCSS+"-map"),this.insertAdjacentElement("afterend",t);const o=this._resizer=document.createElement(e.P+"-resize");o.addEventListener("resize",this._resizeHandler,!1),o.target=t,t.insertAdjacentElement("afterend",o),this.adapter&&this.adapter.initialize(this).then(this._afterInit)}disconnectedCallback(){const t=this._resizer;e.Utils.isNull(t)||(t.removeEventListener("resize",this._resizeHandler,!1),t.remove()),super.disconnectedCallback()}onResize(e){this.adapter&&this.adapter.invalidateSize()}};__decorate([e.Watch({emit:!0,converter:e.PropertyConverters.Number})],s.prototype,"zoom",void 0),__decorate([e.Watch({emit:!0,converter:e.PropertyConverters.Json})],s.prototype,"center",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],s.prototype,"scale",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],s.prototype,"mousewheel",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],s.prototype,"zoomControl",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],s.prototype,"draggable",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],s.prototype,"doubleClickZoom",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],s.prototype,"keyboardShortcuts",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],s.prototype,"autofit",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],s.prototype,"paddingTop",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],s.prototype,"paddingLeft",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],s.prototype,"paddingRight",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],s.prototype,"paddingBottom",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Element})],s.prototype,"adapter",void 0),s=__decorate([e.CustomElement({tagName:o.MapConsts.MAP_SELECTOR})],s),o.PacemMapElement=s}(t.Maps||(t.Maps={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const o="//webapi.amap.com/maps",a="//webapi.amap.com/ui/1.1/main.js?v=1.1.1",n={getLocation:e=>(Array.isArray(e)&&(e={lat:e[0],lng:e[1]}),[e.lng,e.lat]),getLngLat(e){const t=n.getLocation(e);return new AMap.LngLat(t[0],t[1])},getPosition(e){switch(e.toLowerCase()){case"topleft":return"lt";case"bottomleft":return"lb";case"bottomright":return"rb";default:return"rt"}},getLang(e){switch(e){case"zh-cn":return"zh_cn";case"zh-en":return"zh_en";default:return"en"}},expandBounds(t,o){var a=t.getSouthWest(),n=t.getNorthEast();const s=e.Utils.isArray(o)?new AMap.LngLat(o[0],o[1]):o,i=s.getLat(),r=s.getLng();return a.lat>i&&(a=new AMap.LngLat(a.lng,i)),a.lng>r&&(a=new AMap.LngLat(r,a.lat)),n.lat<i&&(n=new AMap.LngLat(n.lng,i)),n.lng<r&&(n=new AMap.LngLat(r,n.lat)),new AMap.Bounds(a,n)}};class PacemAMapMarkerAdapter{constructor(e){this.map=e,this.markers=new Map,this.infoWindows=new Map}_onDragEnd(e,t){const o=this.markers.get(e).getPosition(),a={lat:o.lat,lng:o.lng};e.onDragEnd(a)}_onInfo(e){e.onInfoOpen()}_onClose(e){e.onInfoClose()}drawMarker(t){var o=this;if(!e.Utils.isNull(o.map.map))if(e.Utils.isNull(t&&t.position))o.map.removeItem(t);else{var a;if(o.markers.has(t)?a=o.markers.get(t):((a=new AMap.Marker({position:[0,0],map:o.map.map})).on("click",(e=>o.openInfoWindow(t,e))),a.on("drag",(()=>o.map.fitBounds(!0))),a.on("dragend",(e=>o._onDragEnd(t,e))),o.markers.set(t,a)),a.setPosition(n.getLocation(t.position)),"string"==typeof t.icon)a.setIcon(t.icon);else if(!e.Utils.isNull(t.icon)){const o={image:t.icon.url};e.Utils.isNullOrEmpty(t.icon.size)||(o.size=o.imageSize=new AMap.Size(t.icon.size.width,t.icon.size.height),a.setAnchor("bottom-center")),a.setIcon(new AMap.Icon(o)),e.Utils.isNullOrEmpty(t.icon.anchor)||(a.setAnchor("top-left"),a.setOffset(new AMap.Pixel(-t.icon.anchor.x,-t.icon.anchor.y)))}a.setLabel({content:t.caption,offset:[0,0],direction:"ltr"}),a.setDraggable(t.draggable)}}closeInfoWindow(e,t){const o=this;if(o.infoWindows.has(e)){const t=o.infoWindows.get(e);t.getIsOpen()&&t.close()}}openInfoWindow(o,a){var n=this,s=n.markers.get(o),i=o.caption;if(t.MapUtils.isContentEmpty(o)||(i=o.innerHTML),!e.Utils.isNullOrEmpty(i)){var r;if(n.infoWindows.has(o))r=n.infoWindows.get(o);else{let e=s.getSize()[1];(r=new AMap.InfoWindow({anchor:"bottom-center",offset:[0,-e]})).on("close",(function(){n._onClose(o)})),n.infoWindows.set(o,r)}r.setContent(i);const e=s.getPosition(),t=[e.getLng(),e.getLat()];r.open(n.map.map,t,0),n._onInfo(o)}}}const s=["zoomend","moveend","dragend"];let i=class PacemAMapAdapterElement extends t.PacemMapAdapterElement{constructor(){super(),this._mapUpdateHandler=t=>{const o=this._map,a=this._container;e.Utils.isNull(o)||e.Utils.isNull(a)||this.updateMapElement(a,o.getCenter(),o.getZoom())},this._shapes=new Map,this._markersAdapter=new PacemAMapMarkerAdapter(this)}popupInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.openInfoWindow(e)}popoutInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.closeInfoWindow(e)}invalidateSize(){const e=this._map;e&&e.emit("resize")}destroy(e){s.forEach((e=>{this._map.on(e,this._mapUpdateHandler)})),this._map.destroy()}async initialize(i){const r=this.apiVersion||"2.0",l=this.apiKey||"";await e.CustomElementUtils.importjs(o+"?v="+r+"&key="+l),await e.CustomElementUtils.importjs(a);const p=this._container=i;if(e.Utils.isNull(AMap))return;var c=p.scale,d=p.draggable,m=p.doubleClickZoom,h=p.keyboardShortcuts;const g=t.MapUtils.parseCoords(p.center),u={center:n.getLocation(g),scrollWheel:p.mousewheel,animateEnable:!0,dragEnable:d,keyboardEnable:h,doubleClickZoom:m,zoomEnable:c,viewMode:"2D",zoom:p.zoom,langForeign:n.getLang(e.Utils.lang(i)),layers:[AMap.createDefaultLayer()]};var f=p.container,_=document.createElement("div");_.style.width="100%",_.style.height="100%",f.innerHTML="",f.appendChild(_);const v=this._map=new AMap.Map(_,u);return window.AMapUI.loadUI(["control/BasicControl"],(e=>{p.zoomControl&&v.addControl(new e.Zoom({position:n.getPosition(p.zoomControl)}))})),v.on("complete",(()=>{i.dispatchEvent(new t.MapEvent("maploaded"))}),v,!0),s.forEach((e=>{v.on(e,this._mapUpdateHandler)})),_}drawItem(e){if(e instanceof t.PacemMapMarkerElement){var o=this._markersAdapter,a=o.drawMarker(e);o.markers.has(e)||o.markers.set(e,a)}this.fitBounds(!0)}removeItem(o){if(o instanceof t.PacemMapMarkerElement){var a=this._markersAdapter,n=a.markers.get(o);e.Utils.isNull(n)||(n.setMap(null),a.markers.delete(o))}this.fitBounds(!0)}get map(){return this._map}setView(t,o){const a=this._map;if(!e.Utils.isNull(a))if("number"==typeof t)a.setZoom(t);else{const e=n.getLngLat(t);a.setCenter(e),o&&a.setZoom(o)}}fitBounds(t){if(!this.map)return;const o=this._container;if(!o.autofit&&!0===t)return;const a=this._markersAdapter.markers,s=this._shapes,i=this._map;if(a.size||s.size){var r=null,l=0;for(var p of a.keys()){let t=a.get(p);if(e.Utils.isNull(t))continue;const o=t.getPosition();o&&(r=e.Utils.isNull(r)?new AMap.Bounds(o,o):n.expandBounds(r,o),l++)}for(var c of s.keys()){var d=s.get(c).getBounds();const e=d.getSouthWest(),t=d.getNorthEast();r=n.expandBounds(r,e),r=n.expandBounds(r,t),l+=2}if(l>=2){const e=this._padBounds(r);i.setBounds(e)}else 1==l&&(i.setCenter(r.getCenter()),i.setZoom(o.zoom))}else i.setCenter(n.getLocation(o.center)),i.setZoom(o.zoom)}_padBounds(e){const t=this._container,o=t.paddingTop||0,a=t.paddingLeft||0,s=t.paddingRight||0,i=t.paddingBottom||0,r=this._map;if(a||o||s||i){const t=e.getNorthWest(),c=e.getSouthEast(),d=r.lngLatToPixel(c),m=r.lngLatToPixel(t);var l=r.pixelToLngLat(new AMap.Pixel(m.x-a,m.y-o)),p=r.pixelToLngLat(new AMap.Pixel(d.x+s,d.y+i));e=n.expandBounds(e,l),e=n.expandBounds(e,p)}return e}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"apiKey",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"apiVersion",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-map-adapter-amap"})],i),t.PacemAMapAdapterElement=i}(t.Maps||(t.Maps={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const o=1e3,a="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.js",n="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.css";class AtlasMapUtils{static getPosition(e){return Array.isArray(e)&&(e={lat:e[0],lng:e[1]}),atlas.data.Position.fromLatLng(e)}static getBounds(e){return atlas.data.BoundingBox.fromPositions(e.map((e=>[e[1],e[0]])))}static getLatLng(e){return{lat:e[1],lng:e[0]}}}class PacemAzureMarkerAdapter{constructor(e){this.map=e,this.markers=new Map}_onDragEnd(e,t){var o=t.target.getOptions().position;e.onDragEnd(AtlasMapUtils.getLatLng(o))}_onInfo(e){e.onInfoOpen()}_onClose(e){e.onInfoClose()}drawMarker(t){var o,a=this;if(e.Utils.isNull(a.map.map))return;if(e.Utils.isNull(t&&t.position))return void a.map.removeItem(t);var n=AtlasMapUtils.getPosition(t.position);if(a.markers.has(t))o=a.markers.get(t);else{o=new atlas.HtmlMarker;const e=a.map.map;e.markers.add(o,n),e.events.add("click",o,(e=>a.openInfoWindow(t,e))),e.events.add("drag",o,(()=>a.map.fitBounds(!0))),e.events.add("dragend",o,(e=>a._onDragEnd(t,e))),a.markers.set(t,o)}let s={position:n,pixelOffset:[0,-36]},i={position:n,draggable:t.draggable,popup:new atlas.Popup},r=(e,t,o)=>`<img width="${t||"auto"}" height="${o||"auto"}" style="pointer-events: none" src="${e}" />`;if("string"==typeof t.icon)i.htmlContent=r(t.icon);else if(!e.Utils.isNull(t.icon)){const e=t.icon.size,o=t.icon.anchor;i.htmlContent=r(t.icon.url,e&&e.width,e&&e.height),o?(i.anchor="top-left",i.pixelOffset=[-o.x,-o.y],s.pixelOffset=[0,-o.y]):e&&e.height&&(s.pixelOffset=[0,-e.height/2])}i.popup.setOptions(s),i.text=t.caption,o.setOptions(i)}closeInfoWindow(e,t){var o=((null==t?void 0:t.target)||this.markers.get(e)).getOptions().popup;o&&o.isOpen()&&o.close()}openInfoWindow(o,a){var n=this,s=(null==a?void 0:a.target)||n.markers.get(o),i=o.caption,r=s.getOptions().popup;r&&(t.MapUtils.isContentEmpty(o)||(i=o.innerHTML),e.Utils.isNullOrEmpty(i)||(r.setOptions({content:`<div style="padding: 24px;">${i}</div>`}),s.togglePopup(),n._onInfo(o),n.map.map.events.addOnce("close",r,(e=>{r.setOptions({content:""}),n._onClose(o)}))))}}const s=["moveend","dragend","zoomend","rotateend"];let i=class PacemAzureMapAdapterElement extends t.PacemMapAdapterElement{constructor(){super(),this._mapUpdateHandler=e=>{this._updateMap()},this._shapes=new Map,this._markersAdapter=new PacemAzureMarkerAdapter(this)}popupInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.openInfoWindow(e)}popoutInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.closeInfoWindow(e)}setView(t,o){const a=this._map;if(!e.Utils.isNull(a)){const e=a.getCamera();"number"==typeof t?a.setCamera({zoom:t,center:e.center}):a.setCamera({position:AtlasMapUtils.getPosition(t),zoom:o||e.zoom})}}get map(){return this._map}destroy(e){const t=this._map;s.forEach((e=>{t.events.remove(e,this._mapUpdateHandler)})),t.dispose()}async initialize(o){await Promise.all([e.CustomElementUtils.importjs(a),e.CustomElementUtils.importcss(n)]);const i=this._container=o;var r=i.scale,l=i.draggable,p=i.doubleClickZoom,c=i.keyboardShortcuts,d={center:AtlasMapUtils.getPosition(i.center),zoom:i.zoom,subscriptionKey:this.subscriptionKey,dragPanInteraction:l,scrollZoomInteraction:i.mousewheel,dblClickZoomInteraction:!p,keyboardInteraction:c,language:e.Utils.lang(o)},m=i.container,h=document.createElement("div");h.id=`azure-maps-${e.Utils.uniqueCode()}`,h.style.width="100%",h.style.height="100%",m.innerHTML="",m.appendChild(h);var g=this._map=new atlas.Map(h.id,d);return r&&i.zoomControl&&g.events.addOnce("ready",(e=>{let t=atlas.ControlPosition.NonFixed;switch(i.zoomControl){case"topleft":t=atlas.ControlPosition.TopLeft;break;case"topright":t=atlas.ControlPosition.TopRight;break;case"bottomright":t=atlas.ControlPosition.BottomRight;break;case"bottomleft":t=atlas.ControlPosition.BottomLeft}g.controls.add(new atlas.control.ZoomControl,{position:t})})),s.forEach((e=>{g.events.add(e,this._mapUpdateHandler)})),g.events.addOnce("ready",(()=>{o.dispatchEvent(new t.MapEvent("maploaded"))})),h}invalidateSize(){this.map&&this.map.resize()}removeItem(o){if(o instanceof t.PacemMapMarkerElement){var a=this._markersAdapter,n=a.markers.get(o);e.Utils.isNull(n)||(this.map.markers.remove(n),a.markers.delete(o))}this.fitBounds(!0)}drawItem(e){if(e instanceof t.PacemMapMarkerElement){var o=this._markersAdapter,a=o.drawMarker(e);o.markers.has(e)||o.markers.set(e,a)}this.fitBounds(!0)}_updateMap(){const t=this._map,o=this._container;if(!e.Utils.isNull(t)&&!e.Utils.isNull(o)){const e=t.getCamera(),a=e.center,n=e.zoom;1===e.zoom?console.warn("Azure Maps control lacks in reflecting the actual map zoom onto the camera property. Cannot reflect info back to PacemMapElement."):this.updateMapElement(o,AtlasMapUtils.getLatLng(a),n)}}fitBounds(o){if(this.map){var a=this._container;if(a.autofit||!0!==o){var n=this._markersAdapter.markers,s=this._shapes;if(n.size||s.size){var i=[];for(var r of n.keys()){let o=n.get(r);e.Utils.isNull(o)||t.MapUtils.expandBounds(i,AtlasMapUtils.getLatLng(o.getOptions().position))}for(var l of s.keys()){var p=s.get(l).getBounds();t.MapUtils.expandBounds(i,AtlasMapUtils.getLatLng(atlas.data.BoundingBox.getSouthWest(p))),t.MapUtils.expandBounds(i,AtlasMapUtils.getLatLng(atlas.data.BoundingBox.getNorthEast(p)))}var c=a.paddingTop||0,d=a.paddingLeft||0,m=a.paddingRight||0,h=a.paddingBottom||0;i.length>=2?this._map.setCamera({bounds:AtlasMapUtils.getBounds(i),padding:{top:c,bottom:h,left:d,right:m}}):1===i.length&&this._map.setCamera({center:AtlasMapUtils.getPosition(i[0]),zoom:a.zoom})}else this._map.setCamera({center:AtlasMapUtils.getPosition(a.center),zoom:a.zoom})}}}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"subscriptionKey",void 0),__decorate([e.Debounce(500)],i.prototype,"_updateMap",null),__decorate([e.Debounce(o)],i.prototype,"fitBounds",null),i=__decorate([e.CustomElement({tagName:e.P+"-map-adapter-azure"})],i),t.PacemAzureMapAdapterElement=i}(t.Maps||(t.Maps={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const o=1e3,a="https://maps.googleapis.com/maps/api/js";class PacemGoogleMarkerAdapter{constructor(e){this.map=e,this.markers=new Map,this.infoWindows=new Map}_onDragEnd(e,t){const o=this.markers.get(e).getPosition(),a={lat:o.lat(),lng:o.lng()};e.onDragEnd(a)}_onInfo(e){e.onInfoOpen()}_onClose(e){e.onInfoClose()}drawMarker(t){var o=this;if(!e.Utils.isNull(o.map.map))if(e.Utils.isNull(t&&t.position))o.map.removeItem(t);else{var a;if(o.markers.has(t)?a=o.markers.get(t):((a=new google.maps.Marker({position:{lat:0,lng:0},map:o.map.map})).addListener("click",(e=>o.openInfoWindow(t,e))),a.addListener("drag",(()=>o.map.fitBounds(!0))),a.addListener("dragend",(e=>o._onDragEnd(t,e))),o.markers.set(t,a)),a.setPosition(class GMapsUtils{static getPosition(e){return Array.isArray(e)&&(e={lat:e[0],lng:e[1]}),e}}.getPosition(t.position)),"string"==typeof t.icon)a.setIcon(t.icon);else if(!e.Utils.isNull(t.icon)){let o={url:t.icon.url};e.Utils.isNullOrEmpty(t.icon.size)||(o.size=new google.maps.Size(t.icon.size.width,t.icon.size.height),o.anchor=new google.maps.Point(t.icon.size.width/2,t.icon.size.height)),e.Utils.isNullOrEmpty(t.icon.anchor)||(o.anchor=new google.maps.Point(t.icon.anchor.x,t.icon.anchor.y)),a.setIcon(o)}a.setLabel(t.caption),a.setDraggable(t.draggable)}}closeInfoWindow(e,t){const o=this;if(o.infoWindows.has(e)){o.infoWindows.get(e).close()}}openInfoWindow(o,a){var n,s,i,r,l=this,p=l.markers.get(o),c=o.caption;if(t.MapUtils.isContentEmpty(o)||(c=o.innerHTML),!e.Utils.isNullOrEmpty(c)){var d;if(l.infoWindows.has(o))d=l.infoWindows.get(o);else{let t=0;"string"==typeof o.icon||e.Utils.isNull(o.icon)||(t=null!==(r=(null!==(s=null===(n=o.icon.size)||void 0===n?void 0:n.width)&&void 0!==s?s:0)/2-(null===(i=o.icon.anchor)||void 0===i?void 0:i.x))&&void 0!==r?r:0),(d=new google.maps.InfoWindow({pixelOffset:new google.maps.Size(-t,0)})).addListener("closeclick",(function(){l._onClose(o)})),l.infoWindows.set(o,d)}d.setContent(c),d.open(l.map.map,p),l._onInfo(o)}}}const n=["dragend","zoom_changed"];let s=class PacemGoogleMapAdapterElement extends t.PacemMapAdapterElement{constructor(){super(),this._listeners=[],this._mapUpdateHandler=()=>{const t=this._map,o=this._container;if(!e.Utils.isNull(t)&&!e.Utils.isNull(o)){const e=t.getCenter();this.updateMapElement(o,{lat:e.lat(),lng:e.lng()},t.getZoom())}},this._shapes=new Map,this._markersAdapter=new PacemGoogleMarkerAdapter(this)}popupInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.openInfoWindow(e)}popoutInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.closeInfoWindow(e)}setView(t,o){const a=this._map;e.Utils.isNull(a)||("number"==typeof t?a.setZoom(t):(a.setCenter(t),o&&a.setZoom(o)))}get map(){return this._map}propertyChangedCallback(e,t,o,a){super.propertyChangedCallback(e,t,o,a),this.invalidateSize()}destroy(e){const t=this._listeners;for(;t.length;)google.maps.event.removeListener(t.pop())}async initialize(o){await e.CustomElementUtils.importjs(a+"?key="+this.apiKey);const s=this._container=o;if(e.Utils.isNull(google&&google.maps))return;var i=s.scale,r=s.draggable,l=s.doubleClickZoom,p=s.keyboardShortcuts;const c=t.MapUtils.parseCoords(s.center);var d=new google.maps.LatLng(c[0],c[1]),m={zoomControl:i&&!e.Utils.isNullOrEmpty(s.zoomControl),zoomControlOptions:{position:function(e){switch(e){case"topright":return google.maps.ControlPosition.RIGHT_TOP;case"bottomleft":return google.maps.ControlPosition.LEFT_BOTTOM;case"bottomright":return google.maps.ControlPosition.RIGHT_BOTTOM;default:return google.maps.ControlPosition.LEFT_TOP}}(s.zoomControl)},scrollwheel:s.mousewheel,disableDoubleClickZoom:l,keyboardShortcuts:p,draggable:r},h=s.container,g=document.createElement("div");g.style.width="100%",g.style.height="100%",h.innerHTML="",h.appendChild(g);var u=this._map=new google.maps.Map(g,m);if(i&&s.zoomControl){var f=google.maps.ControlPosition.TOP_LEFT;switch(s.zoomControl){case"topright":f=google.maps.ControlPosition.TOP_RIGHT;break;case"bottomleft":f=google.maps.ControlPosition.BOTTOM_LEFT;break;case"bottomright":f=google.maps.ControlPosition.BOTTOM_RIGHT}var _={position:f};u.setOptions({zoomControlOptions:_})}const v=this._listeners;n.forEach((e=>{v.push(u.addListener(e,this._mapUpdateHandler))})),u.setCenter(d),u.setZoom(s.zoom);var M=u.addListener("idle",(function(e){M.remove(),o.dispatchEvent(new t.MapEvent("maploaded"))}));const C=t.MapUtils.parseCoords(s.center),y=new google.maps.LatLng(C[0],C[1]);return u.setCenter(y),u.setZoom(s.zoom),g}invalidateSize(){this.map&&google.maps.event.trigger(this.map,"resize")}removeItem(o){if(o instanceof t.PacemMapMarkerElement){var a=this._markersAdapter,n=a.markers.get(o);e.Utils.isNull(n)||(n.setMap(null),a.markers.delete(o))}this.fitBounds(!0)}drawItem(e){if(e instanceof t.PacemMapMarkerElement){var o=this._markersAdapter,a=o.drawMarker(e);o.markers.has(e)||o.markers.set(e,a)}this.fitBounds(!0)}fitBounds(t){if(!this.map)return;const o=this._container;if(!o.autofit&&!0===t)return;const a=this._markersAdapter.markers,n=this._shapes,s=this._map;if(!a.size&&!n.size)return s.setCenter(o.center),void s.setZoom(o.zoom);var i=new google.maps.LatLngBounds,r=0;for(var l of a.keys()){let t=a.get(l);if(e.Utils.isNull(t))continue;const o=t.getPosition();o&&(i.extend({lat:o.lat(),lng:o.lng()}),r++)}for(var p of n.keys()){var c=n.get(p).getBounds();const e=c.getSouthWest(),t=c.getNorthEast();i.extend({lat:e.lat(),lng:e.lng()}),i.extend({lat:t.lat(),lng:t.lng()}),r+=2}r>=2?s.fitBounds(i):1==r&&(s.setCenter(i.getCenter()),s.setZoom(o.zoom)),this._padBounds()}_padBounds(){const e=this._container,t=e.paddingTop||0,o=e.paddingLeft||0,a=e.paddingRight||0,n=e.paddingBottom||0;if(o||t||a||n){const e=this._map;var s=e.getBounds();const l=e.getDiv().clientWidth,p=e.getDiv().clientHeight;var i=e.getProjection().fromPointToLatLng(new google.maps.Point(-o,-t)),r=e.getProjection().fromPointToLatLng(new google.maps.Point(l+a,p+n));s.extend(i),s.extend(r)}}_redrawMap(){}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],s.prototype,"apiKey",void 0),__decorate([e.Debounce(o)],s.prototype,"fitBounds",null),s=__decorate([e.CustomElement({tagName:e.P+"-map-adapter-google"})],s),t.PacemGoogleMapAdapterElement=s}(t.Maps||(t.Maps={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const o=1e3,a="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js",n="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og==",s="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css",i="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==";class PacemLeafletMarkerAdapter{constructor(e){this._map=e,this._markers=new Map}get markers(){return this._markers}_onDragEnd(e,t){var o=t.target.getLatLng();e.onDragEnd(o)}_onInfo(e){e.onInfoOpen()}_onClose(e){e.onInfoClose()}drawMarker(t){var o=this;if(!e.Utils.isNull(o._map.map))if(e.Utils.isNullOrEmpty(t&&t.position)||t&&t.hide)e.Utils.isNull(t)||(o._map.removeItem(t),this._markers.delete(t));else{var a;if(o._markers.has(t)?a=o._markers.get(t):((a=L.marker(t.position).addTo(o._map.map)).on("click",(e=>o.openInfoWindow(t,e))),a.on("drag",(()=>o._map.fitBounds(!0))),a.on("dragend",(e=>o._onDragEnd(t,e))),o._markers.set(t,a)),a.setLatLng(t.position),"string"==typeof t.icon)o._setIcon(a,t.icon);else if(!e.Utils.isNull(t.icon)){let n={iconUrl:t.icon.url};e.Utils.isNullOrEmpty(t.icon.size)||e.Utils.extend(n,{iconSize:[t.icon.size.width,t.icon.size.height],iconAnchor:[t.icon.size.width/2,t.icon.size.height],popupAnchor:[0,-t.icon.size.height]}),e.Utils.isNullOrEmpty(t.icon.anchor)||e.Utils.extend(n,{iconAnchor:[t.icon.anchor.x,t.icon.anchor.y]}),o._setIcon(a,new L.Icon(n))}o._setCaption(a,t.caption),o._setDraggable(a,t.draggable)}}closeInfoWindow(e,t){((null==t?void 0:t.target)||this._markers.get(e)).closePopup()}openInfoWindow(o,a){var n=this,s=(null==a?void 0:a.target)||n._markers.get(o),i=o.caption;t.MapUtils.isContentEmpty(o)||(i=o.innerHTML),e.Utils.isNullOrEmpty(i)||(s.bindPopup(i).openPopup(),n._onInfo(o),s.on("popupclose",(function(){s.unbindPopup(),n._onClose(o)})))}_setDraggable(e,t){!0===t?e.dragging.enable():e.dragging.disable()}_setIcon(e,t){if("string"==typeof t){var o,a,n,s={iconUrl:t};if((o=this.size)&&/[\d]+,[\d]+/.test(o)){var i=-1,r=[parseInt(o.substring(0,i=o.indexOf(","))),parseInt(o.substring(i+1))];Object.assign(s,{iconSize:r})}if((a=this.anchor)&&/[\d]+,[\d]+/.test(a)){i=-1;var l=[parseInt(a.substring(0,i=a.indexOf(","))),parseInt(a.substring(i+1))];Object.assign(s,{iconAnchor:l,popupAnchor:[0,-l[1]]})}if((n=this.popupAnchor)&&/[\d]+,[\d]+/.test(n)){i=-1,l=[parseInt(a.substring(0,i=a.indexOf(","))),parseInt(a.substring(i+1))];Object.assign(s,{popupAnchor:l})}e.setIcon(L.icon(s))}else t&&e.setIcon(t)}_setCaption(e,t){e.getPopup()&&e.getPopup().getContent()!=t&&e.setPopupContent(t)}removeMarker(e){const t=this._markers;t.has(e)&&(t.get(e).remove(),t.delete(e))}}class PacemLeafletLayerAdapter{constructor(e){this._map=e,this._layers=new Map}drawLayer(e){const t=this._layers;if(t.has(e)){let o=t.get(e);o&&o.remove()}if(e.hide)return void t.delete(e);const o=(e.mode||"").toLowerCase(),a=this._map.map;switch(o){case"wms":let n=L.tileLayer.wms(e.url,{layers:(e.include||[]).join(","),minZoom:e.minZoom,maxZoom:e.maxZoom,transparent:!0,format:"image/png"}).addTo(a);t.set(e,n);break;default:let s=L.tileLayer(e.url,{tms:"tms"===o,minZoom:e.minZoom,maxZoom:e.maxZoom}).addTo(a);t.set(e,s)}}removeLayer(e){const t=this._layers;t.has(e)&&(t.get(e).remove(),t.delete(e))}}let r=class PacemLeafletMapAdapterElement extends t.PacemMapAdapterElement{constructor(){super(),this.tiles="//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",this.attribution='Map data © <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',this._mapUpdateHandler=()=>{const t=this._map,o=this._container;e.Utils.isNull(t)||e.Utils.isNull(o)||this.updateMapElement(o,t.getCenter(),t.getZoom())},this._tileLayer=null,this._shapes=new Map,this._markersAdapter=new PacemLeafletMarkerAdapter(this),this._layersAdapter=new PacemLeafletLayerAdapter(this)}popupInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.openInfoWindow(e)}popoutInfoWindow(e){e instanceof t.PacemMapMarkerElement&&this._markersAdapter.closeInfoWindow(e)}setView(t,o){const a=this._map;e.Utils.isNull(a)||("number"==typeof t?a.setZoom(t):a.setView(t,o||a.getZoom()))}get map(){return this._map}propertyChangedCallback(e,t,o,a){switch(super.propertyChangedCallback(e,t,o,a),e){case"tiles":this._redrawMap()}this.invalidateSize()}destroy(e){this._map.clearAllEventListeners()}async initialize(o){await Promise.all([e.CustomElementUtils.importjs(a,n,!0),e.CustomElementUtils.importcss(s,i,!0)]);const r=this._container=o;var l=r.scale,p=r.draggable,c=r.doubleClickZoom,d=r.keyboardShortcuts,m=L.latLng(t.MapUtils.parseCoords(r.center)),h={zoomControl:l&&!e.Utils.isNullOrEmpty(r.zoomControl),scrollWheelZoom:r.mousewheel,dragging:p,doubleClickZoom:!c,keyboard:d},g=r.container,u=document.createElement("div");u.style.width="100%",u.style.height="100%",g.innerHTML="",g.appendChild(u);var f=this._map=L.map(u,h);["zoomend","moveend"].forEach((e=>{f.on(e,(e=>{this._idleFiller(),this._mapUpdateHandler()}))})),f.on("load",(()=>{l&&r.zoomControl&&f.zoomControl.setPosition(r.zoomControl),this._idleFiller()})),this._tileLayer=L.tileLayer(this.tiles,{attribution:this.attribution}).addTo(f),f.setView(m,r.zoom),f.once("idle",(function(){f.fire("resize"),o.dispatchEvent(new t.MapEvent("maploaded"))}));const _=t.MapUtils.parseCoords(r.center),v=[_[0],_[1]];return f.setView(v,r.zoom),u}invalidateSize(){this.map&&this.map.invalidateSize()}removeItem(e){e instanceof t.PacemMapMarkerElement?this._markersAdapter.removeMarker(e):e instanceof t.PacemMapLayerElement&&this._layersAdapter.removeLayer(e),this.fitBounds(!0)}drawItem(e){e instanceof t.PacemMapMarkerElement?this._markersAdapter.drawMarker(e):e instanceof t.PacemMapLayerElement&&this._layersAdapter.drawLayer(e),this.fitBounds(!0)}_idleFiller(){this.map&&this.map.fire("idle")}fitBounds(o){if(this.map){var a=this._container;if(a.autofit||!0!==o){var n=this._markersAdapter.markers,s=this._shapes;if(n.size||s.size){var i=[];for(var r of n.keys()){let o=n.get(r);e.Utils.isNull(o)||t.MapUtils.expandBounds(i,o.getLatLng())}for(var l of s.keys()){var p=s.get(l).getBounds();t.MapUtils.expandBounds(i,p.getSouthWest()),t.MapUtils.expandBounds(i,p.getNorthEast())}var c=a.paddingTop,d=a.paddingLeft,m=a.paddingRight,h=a.paddingBottom,g={paddingTopLeft:new L.Point(d,c),paddingBottomRight:new L.Point(m,h)};if(i.length>=2||1==i.length&&(c||d||h||m)){const e=L.latLngBounds(i),t=e.getNorthEast(),o=e.getSouthWest();try{this.map.fitBounds([[t.lat,t.lng],[o.lat,o.lng]],g)}catch(e){throw e}}else 1==i.length&&this.map.setView(i[0],a.zoom)}else this._map.setView(t.MapUtils.parseCoords(a.center),a.zoom)}}}_redrawMap(){var t=this;e.Utils.isNull(t.tiles&&t._tileLayer)||t._tileLayer.setUrl(t.tiles)}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],r.prototype,"tiles",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],r.prototype,"attribution",void 0),__decorate([e.Debounce(500)],r.prototype,"_idleFiller",null),__decorate([e.Debounce(o)],r.prototype,"fitBounds",null),r=__decorate([e.CustomElement({tagName:e.P+"-map-adapter-leaflet"})],r),t.PacemLeafletMapAdapterElement=r}(t.Maps||(t.Maps={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={}));