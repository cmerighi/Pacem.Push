/**
 * pacem v0.10.0-jericho (https://js.pacem.it)
 * Copyright 2020 Pacem (https://pacem.it)
 * Licensed under MIT
 */
var Pacem,__decorate=this&&this.__decorate||function(t,e,r,i){var s,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(o=(a<3?s(o):a>3?s(e,r,o):s(e,r))||o);return a>3&&o&&Object.defineProperty(e,r,o),o};!function(t){!function(e){!function(r){const i=864e5;function s(t,e,r=l){const i=(a=r,o=e-t,Math.log10(o)/Math.log10(a)),s=Math.pow(r,Math.floor(i));var a,o;return{min:Math.floor(t/s)*s,max:Math.ceil(e/s)*s,round:s}}function a(e,r,i){let s=e,a=e;const o=t.Utils.isNull(r),n=t.Utils.isNull(i);if(!o||!n){const t=3;let l,c;o||(l=(e.y-r.y)/(e.x-r.x)),n||(c=(i.y-e.y)/(i.x-e.x));const h=((c||l||0)+(l||c||0))/2,d=o?0:(e.x-r.x)/t,u=n?0:(i.x-e.x)/t;s={x:e.x-d,y:e.y-d*h},a={x:e.x+u,y:e.y+u*h}}return{c0:s,c1:a}}let o=class PacemChartSeriesElement extends e.PacemItemElement{};__decorate([t.Watch({converter:t.PropertyConverters.Json})],o.prototype,"datasource",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],o.prototype,"label",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],o.prototype,"color",void 0),o=__decorate([t.CustomElement({tagName:t.P+"-chart-series"})],o),r.PacemChartSeriesElement=o;const n=10,l=10,c=t.CustomElementUtils.getAttachedPropertyValue,h=t.CustomElementUtils.setAttachedPropertyValue,d=(t.CustomElementUtils.deleteAttachedPropertyValue,"http://www.w3.org/2000/svg");let u=class PacemChartElement extends e.PacemItemsContainerElement{constructor(){super(),this._itemPropertyChangedCallback=(t=>{const e=t.detail.propertyName;"datasource"!==e&&"label"!==e&&"cssClass"!==e&&"color"!==e||this.draw()}),this._series=[],this._key=t.Utils.uniqueCode()}validate(t){return t instanceof o}register(e){return!!super.register(e)&&(e.addEventListener(t.PropertyChangeEventName,this._itemPropertyChangedCallback,!1),!0)}unregister(e){return!!super.unregister(e)&&(e.removeEventListener(t.PropertyChangeEventName,this._itemPropertyChangedCallback,!1),!0)}propertyChangedCallback(e,r,i,s){if(super.propertyChangedCallback(e,r,i,s),"target"===e){this._div!=r&&this._div&&this._div.remove(),this._div=null,this._body=null;const e=r;e&&(e.classList.remove(t.PCSS+"-chart-area"),e.innerHTML=""),this.draw()}else s||"items"!==e&&"xAxisLabels"!==e||this.draw()}disconnectedCallback(){this._div&&this._div.remove(),super.disconnectedCallback()}viewActivatedCallback(){super.viewActivatedCallback(),this.draw()}_ensureChartContainer(){if(t.Utils.isNull(this._div)){let e=this._div=this.target||document.createElement("div");e.classList.add(t.PCSS+"-chart-area"),e!=this.target&&this.parentElement.insertBefore(e,this)}return this._div}_ensureChartBody(e,r){if(t.Utils.isNull(this._body)){let e=this._body=document.createElementNS(d,"svg");e.setAttribute("pacem",""),e.setAttribute("class",t.PCSS+"-category-chart"),e.setAttribute("preserveAspectRatio","xMinYMax slice");const r=this._grid=document.createElementNS(d,"svg");r.setAttribute("pacem",""),r.setAttribute("class","chart-grid");let i=document.createElementNS(d,"defs"),s=this._mask=document.createElementNS(d,"mask"),a=document.createElementNS(d,"rect");a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("width","100%"),a.setAttribute("height","100%");let o=document.createElementNS(d,"rect");o.setAttribute("y","0"),o.setAttribute("width","100%"),o.setAttribute("fill","#fff"),s.id="gnrc_mask_"+this._key,s.appendChild(a),s.appendChild(o),i.appendChild(s),e.appendChild(i),e.appendChild(r),this._div.appendChild(e)}return this._body}_chartDataItemToPoint(e,r){switch(this.xAxisType){case"number":return{x:parseFloat(e.label),y:e.value};case"date":return{x:t.Utils.parseDate(e.label).valueOf(),y:e.value};case"string":throw{x:r.indexOf(e),y:e.value};default:throw"Not supported."}}_getVirtualGrid(e,r,a,o,c,h=this.xAxisType,d=l){const u=s(o,c),m=u.round;var p=[];for(let t=u.min;t<=u.max;t+=m)p.push(Math.round(t*u.round)/u.round);return{x:function(e,r,s,a,o,l=n){var c=e.length;"number"!==r&&"date"!==r||(c=a-s);for(var h=[],d=1,u=l-1;u>1;u--)if(c%u==0){d=c/u;break}1===d&&c>l&&(d=c);const m=d>=i?Date.prototype.toLocaleDateString:Date.prototype.toLocaleTimeString;for(var p=0;p<=c;p+=d){let a;switch(r){case"string":a=e[p].label;break;case"number":a=s+p+"";break;case"date":let n=t.Utils.parseDate(s+p);a=(0==p&&d<i?Date.prototype.toLocaleString:m).apply(n,[o]);break;default:throw"Not supported."}h.push(a)}return h}(this.items[0].datasource,h,r,a,t.Utils.lang(this)),y:p}}_wipe(){const t=this._series;for(var e=t.length-1;e>=0;e--)t[e].remove();t.splice(0)}draw(){if(!this.isReady)return;const e=this._ensureChartContainer(),r=this.type||"line",i=24;var s=t.Utils.offset(e);if(s.height<=i||s.width<=i)return;if(!this.items||!this.items.length)return void this._wipe();const o=this._ensureChartBody(s.width,s.height);this.log(t.Logging.LogLevel.Debug,`Drawing ${r} chart.`);const n=this.xAxisType||"string";let l=Number.NaN,u=Number.NaN,m=Number.NaN,p=Number.NaN,g=1;for(let t of this.items){let e=t.datasource;if(e&&e.length){let t=0;for(let r of e){let r=this._chartDataItemToPoint(e[t]);l=isNaN(l)?r.y:Math.min(l,r.y),u=isNaN(u)?r.y:Math.max(u,r.y),0===t?m=isNaN(m)?r.x:Math.min(m,r.x):t===e.length-1&&(p=isNaN(p)?r.x:Math.max(p,r.x)),t++}}}const v=this._getVirtualGrid(this.items[0].datasource,m,p,l,u,n),_=v.y[v.y.length-1],y=v.y[0];if(_===y)return;const C=s.width-2*i,f=s.height-2*i,b=f*(1-(_-y-(u-l))/(_-y)),w=f*(_-u)/(_-y);("number"!==n||"monometric"!==this.aspectRatio&&"logaritmic"!==this.aspectRatio)&&(g=C/b,o.setAttribute("height",s.height.toString()),o.setAttribute("width",s.width.toString())),o.setAttribute("viewBox",`0 0 ${s.width} ${s.height}`);let A=0;const x=100*g/(p-m),N=100/(u-l),E=100*i/b,P=t=>{let e=this._chartDataItemToPoint(t);return e.y*=N,e.x=(e.x-m)*x,e};for(let e of this.items){let s;if(this._series.length>A)s=this._series[A];else{(s=document.createElementNS(d,"svg")).setAttribute("pacem",""),this._grid.insertAdjacentElement("afterend",s);document.createElementNS(d,"path");s.appendChild(document.createElementNS(d,"path")),this._series.push(s)}var S="chart-series",k="area"===r||"splinearea"===r;k&&(S+=" series-fill"),t.Utils.isNullOrEmpty(e.className)||(S+=" "+e.className),s.setAttribute("class",S),s.setAttribute("x",i.toString()),s.setAttribute("y",w.toString()),s.setAttribute("width",C.toString()),s.setAttribute("height",(b+2*i).toString());let o=s.firstElementChild;if(o.style.stroke=e.color,k){let t=getComputedStyle(o);o.style.fill=e.color||t.fill}else o.style.fill="none";let n="",u=e.datasource;if(u&&u.length){const i="spline"===r||"splinearea"===r;if(i){let r,s,o;for(let l=0;l<u.length;l++){const d=u[l];let m;s||(s=P(d)),i&&l<u.length-1&&(m=P(u[l+1]));let p=c(e,"pacem:chart-series:area",0);p+=d.value,h(e,"pacem:chart-series:area",p);var M=a(s,r,m);n+=t.Utils.isNullOrEmpty(n)?`M${s.x},${-s.y} `:`C${o.x},${-o.y} ${M.c0.x},${-M.c0.y} ${s.x},${-s.y} `,r=s,s=m,o=M.c1}}else for(let r of u){const i=P(r);let s=c(e,"pacem:chart-series:area",0);s+=r.value,h(e,"pacem:chart-series:area",s),n+=t.Utils.isNullOrEmpty(n)?`M${i.x},${-i.y} `:`L${i.x},${-i.y} `}k&&(n+=`V${-l*N} H0 Z`)}o.setAttribute("d",n),A++}for(let t=this._series.length-1;t>=A;t--){this._series.splice(t,1)[0].remove()}const $=`0 ${-(u*N+E)} ${100*g} ${100+2*E}`;for(var U of this._series)U.setAttribute("viewBox",$);let L,T=this._mask.children.item(1);if(T.setAttribute("x",(0).toString()),T.setAttribute("height",(s.height-i).toString()),this._grid.setAttribute("viewBox",`0 0 ${s.width} ${s.height}`),v.x.length<=1||v.y.length<=1){for(let t=this._grid.children.length-1;t>=0;t--)this._grid.children.item(t).remove();return}this._grid.children.length>0?L=this._grid.children.item(0):(L=document.createElementNS(d,"path"),this._grid.appendChild(L));const D=.25*i;let O=0,W=(t,e,r,i)=>{const s=t+1;let a;return this._grid.children.length<=s?(a=document.createElementNS(d,"text"),this._grid.appendChild(a)):a=this._grid.children.item(s),a.textContent=i,a.setAttribute("x",e.toString()),a.setAttribute("y",r.toString()),a},I=`M${i},${i} v${f}`,R=0;const V=C/(v.x.length-1),B=f/(v.y.length-1);if("none"!==this.xAxisPosition)for(var H of v.x){let t=i+R*V;if("top"===this.xAxisPosition){I+=` M${t},${i} v${-D}`;let e=W(O++,t,0,H);e.setAttribute("text-anchor","middle"),e.setAttribute("alignment-baseline","hanging")}else{let e=f+i;I+=` M${t},${e} v${D}`,W(O++,t,e+i,H).setAttribute("text-anchor","middle")}R++}for(var G of(R=0,v.y)){let t=f+i-R*B;I+=` M${i-D},${t} H${C+i}`,W(O++,0,t,G.toString()).removeAttribute("text-anchor"),R++}L.setAttribute("d",I);for(let t=this._grid.children.length-1;t>O;t--)this._grid.children.item(t).remove()}};__decorate([t.Watch({converter:t.PropertyConverters.String})],u.prototype,"type",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Element})],u.prototype,"target",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Boolean})],u.prototype,"aspectRatio",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],u.prototype,"xAxisType",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],u.prototype,"xAxisPosition",void 0),__decorate([t.Throttle()],u.prototype,"draw",null),u=__decorate([t.CustomElement({tagName:t.P+"-chart"})],u),r.PacemChartElement=u}(e.Charts||(e.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={})),function(t){!function(t){!function(t){t.MANAGED_EVENTS=["keydown","keyup","click","dblclick","mouseover","mouseout","mouseenter","mouseleave","mousedown","mouseup","mousemove","contextmenu"]}(t.Charts||(t.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={})),function(t){!function(e){!function(r){let i=class PacemPieSliceElement extends e.PacemItemElement{constructor(){super(...arguments),this._broadcastHandler=(t=>{this.emit(t)})}findContainer(){return t.CustomElementUtils.findAncestorOfType(this,o)}get chart(){return this.container}getCenterOfMass(){const e=this.chart&&this.chart.area;if(t.Utils.isNull(e))return null;const r=t.Utils.offset(e),i=r.width/2+r.left,s=r.top+r.height/2,o=.5*Math.min(r.width,r.height),n=this.normalizedPolarCoords,l=a-n.angle;return{y:s-o*n.radius*Math.sin(l),x:i+o*n.radius*Math.cos(l)}}propertyChangedCallback(t,e,r,i){super.propertyChangedCallback(t,e,r,i),!i&&this.chart&&"normalizedPolarCoords"!=t&&this.chart.draw()}_assignUi(t){const e=this._ui=t;r.MANAGED_EVENTS.forEach(t=>{e.addEventListener(t,this._broadcastHandler)})}_disposeUi(){t.Utils.isNull(this._ui)||r.MANAGED_EVENTS.forEach(t=>{this._ui.addEventListener(t,this._broadcastHandler)})}};__decorate([t.Watch({converter:t.PropertyConverters.Number})],i.prototype,"value",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],i.prototype,"label",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],i.prototype,"color",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Json})],i.prototype,"normalizedPolarCoords",void 0),i=__decorate([t.CustomElement({tagName:t.P+"-pie-slice"})],i),r.PacemPieSliceElement=i;const s=2*Math.PI,a=.5*Math.PI;let o=class PacemPieChartElement extends e.PacemItemsContainerElement{constructor(){super(),this.cutout=0,this._slices=new WeakMap,this._key=t.Utils.uniqueCode()}validate(t){return t instanceof i}viewActivatedCallback(){super.viewActivatedCallback(),this.draw()}propertyChangedCallback(e,r,i,s){if(super.propertyChangedCallback(e,r,i,s),"target"===e){this._g=null,this._div&&this._div.remove();const e=r;e&&(e.classList.remove(t.PCSS+"-chart-area"),e.innerHTML=""),this.draw()}else s||"cutout"!==e&&"items"!==e||this.draw()}get area(){return this._svg}disconnectedCallback(){this._div&&this._div.remove(),super.disconnectedCallback()}_ensureArea(){if(t.Utils.isNull(this._g)){let e=this.target||(this._div=document.createElement("div"));e.classList.add(t.PCSS+"-chart-area");let r=this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("pacem",""),r.setAttribute("preserveAspectRatio","xMidYMid meet"),r.setAttribute("viewBox","0 0 100 100"),r.classList.add(t.PCSS+"-pie-chart");let i=document.createElementNS("http://www.w3.org/2000/svg","defs"),s=document.createElementNS("http://www.w3.org/2000/svg","mask");s.id="pie_mask_"+this._key;let a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("width","100"),a.setAttribute("height","100"),a.setAttribute("fill","#fff");let o=this._mask=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttribute("cx","50"),o.setAttribute("cy","50");let n=this._g=document.createElementNS("http://www.w3.org/2000/svg","g");n.setAttribute("mask",`url(#${s.id})`),e.appendChild(r),s.appendChild(a),s.appendChild(o),i.appendChild(s),r.appendChild(i),r.appendChild(n),this._div&&this.parentElement.insertBefore(e,this)}const e=50*this._safeCutout;return this._mask.setAttribute("r",`${e}`),this._g}get _safeCutout(){return Math.min(1,Math.max(0,this.cutout))||0}_drawSlice(t,e,r,i){const a=e.value>.5*r?1:0,o=s*e.value/r,n=360*i/r,l=`M50,50 V0 A50,50 0 ${a} 1 ${e.value>=r?49.9:50*(1+Math.sin(o))} ${50*(1-Math.cos(o))} L50,50 Z`;t.setAttribute("d",l),t.style.fill=e.color,t.setAttribute("transform",`rotate(${n} 50 50)`);var c=this._safeCutout;e.normalizedPolarCoords={radius:c+Math.SQRT1_2*(1-c),angle:Math.PI*n/180+o/2}}_isSliceOk(t){return!t.disabled}draw(){const e=this._ensureArea(),r=e.children.length,i=this._svg.parentElement;let s=0,a=0,o=0;if(t.Utils.isNullOrEmpty(this.items))e.innerHTML="",t.Utils.removeClass(i,"chart-has-data");else{t.Utils.addClass(i,"chart-has-data");for(let t of this.items)this._isSliceOk(t)&&(a+=t.value);if(a<=0)e.innerHTML="",t.Utils.removeClass(i,"chart-has-data");else for(let i of this.items){if(!this._isSliceOk(i))continue;let n;if(s>=r){const r=document.createElementNS("http://www.w3.org/2000/svg","g");r.setAttribute("class","chart-series "+t.PCSS+"-pie-slice"+(t.Utils.isNullOrEmpty(i.className)?"":" "+i.className)),n=document.createElementNS("http://www.w3.org/2000/svg","path"),r.appendChild(n),e.appendChild(r),i._assignUi(r),this._slices.set(r,i)}else n=e.children.item(s).firstElementChild;i.value>0?(this._drawSlice(n,i,a,o),o+=i.value,n.removeAttribute("display")):n.setAttribute("display","none"),s++}}for(;s<e.children.length;){const t=this._slices,r=e.children.item(s);t.has(r)&&(t.get(r)._disposeUi(),t.delete(r)),e.removeChild(r)}}};__decorate([t.Watch({converter:t.PropertyConverters.Number})],o.prototype,"cutout",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Element})],o.prototype,"target",void 0),__decorate([t.Debounce(!0)],o.prototype,"draw",null),o=__decorate([t.CustomElement({tagName:t.P+"-pie-chart"})],o),r.PacemPieChartElement=o}(e.Charts||(e.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={}));