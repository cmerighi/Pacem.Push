/**
 * pacem v0.20.0-alexandria (https://js.pacem.it)
 * Copyright 2021 Pacem (https://pacem.it)
 * Licensed under MIT
 */
var Pacem,__decorate=this&&this.__decorate||function(t,e,i,r){var s,a=arguments.length,n=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(n=(a<3?s(n):a>3?s(e,i,n):s(e,i))||n);return a>3&&n&&Object.defineProperty(e,i,n),n};!function(t){!function(e){!function(i){i.MANAGED_EVENTS=["keydown","keyup","click","dblclick","mouseover","mouseout","mouseenter","mouseleave","mousedown","mouseup","mousemove","contextmenu"];const r=864e5,s="pacem:chart-series:dataitem";function a(t,e,i){i>0||(i=n(t,e));const r=(a=i,o=e-t,Math.log10(o)/Math.log10(a)),s=Math.pow(i,Math.floor(r));var a,o;return{min:Math.floor(t/s)*s,max:Math.ceil(e/s)*s,round:s}}function n(t,e){const i=e-t;if(!(i>0))return 2;const r=Math.floor(Math.log10(i)),s=Math.pow(10,-r);if(0!=r)return n(t*s,e*s);const a=t=>{const e=Math.floor(10*Math.abs(t));return(e+10-e%10).roundoff()},l=a(i);let h=10;0!==t&&(h=a(Math.abs(e)));const c=o(h,l);return 1===c?l:Math.max(c,10-c)}function o(t,e){return t<=0?e:o(e%t,t)}class ChartEvent extends t.CustomUIEvent{constructor(t,e,i){super(t,e,i)}}i.ChartEvent=ChartEvent;let l=class PacemChartSeriesElement extends e.PacemItemElement{get values(){return this.datasource}};__decorate([t.Watch({converter:t.PropertyConverters.Json})],l.prototype,"datasource",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],l.prototype,"label",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],l.prototype,"color",void 0),__decorate([t.Watch()],l.prototype,"_uiElements",void 0),l=__decorate([t.CustomElement({tagName:t.P+"-chart-series"})],l),i.PacemChartSeriesElement=l;const h="http://www.w3.org/2000/svg";class PacemSeriesChartElement extends e.PacemItemsContainerElement{constructor(){super(),this._itemPropertyChangedCallback=t=>{const e=t.detail.propertyName;"datasource"!==e&&"label"!==e&&"cssClass"!==e&&"color"!==e||this.draw()},this._series=[],this._resizeHandler=t=>{this._size=t.detail,this.draw()},this._broadcastHandler=e=>{const i=e.currentTarget,r=t.CustomElementUtils.getAttachedPropertyValue(i,s);if(t.Utils.isNull(r))return;const a=this.getAnchorPoint(i),n=new ChartEvent("item"+e.type,{detail:{dataItem:r,anchorPoint:a}},e);this.dispatchEvent(n)},this._key=t.Utils.uniqueCode()}validate(t){return t instanceof l}register(e){return!!super.register(e)&&(e.addEventListener(t.PropertyChangeEventName,this._itemPropertyChangedCallback,!1),!0)}unregister(e){return!!super.unregister(e)&&(e.removeEventListener(t.PropertyChangeEventName,this._itemPropertyChangedCallback,!1),!0)}propertyChangedCallback(e,i,r,s){if(super.propertyChangedCallback(e,i,r,s),"target"===e){this._div!=i&&this._div&&this._div.remove(),this._div=null,this._body=null;const e=i;e&&(e.classList.remove(t.PCSS+"-chart-area"),e.innerHTML=""),this._ensureResizer(),this.draw()}else if(!s)switch(e){case"items":this._databindAndDrawDebounced();break;case"datasource":this._databind();case"yAxisDensity":case"xAxisType":case"xAxisPosition":case"yAxisFormat":this.draw()}}_databindAndDrawDebounced(){cancelAnimationFrame(this._handle),this._handle=requestAnimationFrame((()=>{this._databind(),this.draw()}))}_databind(){this._datasource=t.Utils.isNullOrEmpty(this.datasource)?this.items:this.datasource}disconnectedCallback(){this._div&&this._div.remove();const e=this._resizer;t.Utils.isNull(e)||(e.removeEventListener("resize",this._resizeHandler,!1),e.remove()),super.disconnectedCallback()}viewActivatedCallback(){super.viewActivatedCallback(),this._ensureResizer(),this._databind(),this.draw()}_ensureResizer(i=this.target||this._div){if(t.Utils.isNull(this._resizer)){(this._resizer=this.parentElement.insertBefore(new e.PacemResizeElement,this)).addEventListener("resize",this._resizeHandler,!1)}this._resizer.target=i}get chartSize(){return this._size}get chartSeries(){return this._series}get chartBody(){return this._body}get chartGrid(){return this._grid}get chartMask(){return this._mask}get chartKey(){return this._key}get chartContainer(){return this._div}assignUiBehaviors(e,r,a,n){const o=!t.Utils.isNull(t.CustomElementUtils.getAttachedPropertyValue(e,s)),l={series:r.label,label:a.label,value:a.value,color:n||r.color};t.CustomElementUtils.setAttachedPropertyValue(e,s,l),o||i.MANAGED_EVENTS.forEach((t=>{e.addEventListener(t,this._broadcastHandler)}))}disposeUiBehaviors(e){t.CustomElementUtils.deleteAttachedPropertyValue(e,s),i.MANAGED_EVENTS.forEach((t=>{e.removeEventListener(t,this._broadcastHandler)}))}ensureChartContainer(){if(t.Utils.isNull(this._div)){let e=this._div=this.target||document.createElement("div");e.classList.add(t.PCSS+"-chart-area"),e!=this.target&&this.parentElement.insertBefore(e,this)}return this._div}ensureChartBody(e,i,r){if(t.Utils.isNull(this._body)){let i=this._body=document.createElementNS(h,"svg");i.setAttribute("pacem",""),i.setAttribute("class",t.PCSS+"-"+e+"-chart"),i.setAttribute("preserveAspectRatio","xMinYMax slice");const r=this._grid=document.createElementNS(h,"svg");r.setAttribute("pacem",""),r.setAttribute("class","chart-grid");let s=document.createElementNS(h,"defs"),a=this._mask=document.createElementNS(h,"mask"),n=document.createElementNS(h,"rect");n.setAttribute("x","0"),n.setAttribute("y","0"),n.setAttribute("width","100%"),n.setAttribute("height","100%");let o=document.createElementNS(h,"rect");o.setAttribute("y","0"),o.setAttribute("width","100%"),o.setAttribute("fill","#fff"),a.id="gnrc_mask_"+this._key,a.appendChild(n),a.appendChild(o),s.appendChild(a),i.appendChild(s),i.appendChild(r),this._div.appendChild(i)}return this._body}chartDataItemToPoint(e,i){switch(this.xAxisType||"string"){case"number":return{x:parseFloat(e.label),y:e.value};case"date":return{x:t.Utils.parseDate(e.label).valueOf(),y:e.value};case"string":return{x:i.findIndex((t=>t.label==e.label)),y:e.value};default:throw"Not supported."}}getVirtualGrid(e,i,s,n,o,l=this.xAxisType,h){const c=a(n,o,h),d=c.round;var u=[];for(let t=c.min;t<=c.max;t+=d)u.push(t.roundoff());let m=t.Utils.lang(this),p=null;const g=this.xAxisFormat;if(!t.Utils.isNullOrEmpty(g))switch(l){case"number":p=t=>Intl.NumberFormat(m,g).format(t);break;case"date":p=e=>Intl.DateTimeFormat(m,g).format(t.Utils.parseDate(e))}return{x:function(e,i,s,a,n,o=10){const l="number"===i||"date"===i?a-s:Math.max(1,e.length-1);for(var h=[],c=1,d=o-1;d>1;d--)if(l%d==0){c=l/d;break}1===c&&l>o&&(c=l);const u="function"==typeof n?n:c>=r?t=>t.toLocaleDateString(n):t=>t.toLocaleTimeString(n),m="function"==typeof n?n:c<r?t=>t.toLocaleString(n):u,p="function"==typeof n?n:t=>t.toLocaleString(n);for(var g=0;g<=l;g+=c){let r;switch(i){case"string":if(g>=e.length)continue;r=e[g].label;break;case"number":r=p(s+g);break;case"date":r=(0==g?m:u)(t.Utils.parseDate(s+g));break;default:throw"Not supported."}h.push(r)}return h}(e,l,i,s,null!=p?p:m),y:u}}wipeOut(t=this._series,e=0){for(var i=t.length-1;i>=e;i--)t[i].remove();t.splice(e)}buildLinearGradient(e,i=!1){const r=document.createElementNS(h,"linearGradient");r.id=this.chartKey+"_grad"+e+(i?"_inverted":""),i&&t.Utils.addClass(r,"bottom-up"),r.setAttribute("x1","0%"),r.setAttribute("x2","0%"),r.setAttribute("y1","0%"),r.setAttribute("y2","100%"),r.setAttribute("spreadMethod","pad");const s=document.createElementNS(h,"stop");s.setAttribute("offset","0%");const a=document.createElementNS(h,"stop");return a.setAttribute("offset","100%"),r.appendChild(s),r.appendChild(a),r}setGradientColor(t,e){for(let i=0;i<t.children.length;i++){const r=t.children.item(i);r instanceof SVGStopElement&&(r.style.stopColor=e)}}estimateYAxisLabelWidth(t){const e=this.formatYAxisLabel(t);return this.estimateLabelWidth(e)}estimateLabelWidth(e){const i=this._grid;if(t.Utils.isNull(i))throw new Error("Unable to estimate label without an underlying grid available.");const r=document.createElementNS(h,"text");r.textContent=e,i.appendChild(r);const s=t.Utils.offset(r);return r.remove(),s.width}formatYAxisLabel(e){const i=this.yAxisFormat;return t.Utils.isNullOrEmpty(i)?e.toString():Intl.NumberFormat(t.Utils.lang(this),i).format(e)}estimateXAxisLabelWidth(t){const e=this.formatXAxisLabel(t);return this.estimateLabelWidth(e)}formatXAxisLabel(e){const i=this.xAxisFormat,r=t.Utils.lang(this);switch(this.xAxisType){case"date":const s=t.Utils.Dates.parse(e);return t.Utils.isNullOrEmpty(i)?s.toLocaleString(r):Intl.DateTimeFormat(r,i).format(s);case"number":const a=e;return t.Utils.isNullOrEmpty(i)?a.toLocaleString(r):Intl.NumberFormat(r,i).format(a);default:return e}}draw(){this.drawSeries(this._datasource)}getAnchorPoint(e){const i=t.Utils.offset(e);return{x:i.left+.5*i.width,y:i.top+.5*i.height}}}__decorate([t.Watch({converter:t.PropertyConverters.Element})],PacemSeriesChartElement.prototype,"target",void 0),__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.String})],PacemSeriesChartElement.prototype,"xAxisType",void 0),__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.String})],PacemSeriesChartElement.prototype,"xAxisPosition",void 0),__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.Json})],PacemSeriesChartElement.prototype,"datasource",void 0),__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.Number})],PacemSeriesChartElement.prototype,"yAxisDensity",void 0),__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.Json})],PacemSeriesChartElement.prototype,"yAxisFormat",void 0),__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.Json})],PacemSeriesChartElement.prototype,"xAxisFormat",void 0),i.PacemSeriesChartElement=PacemSeriesChartElement}(e.Charts||(e.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={})),function(t){!function(e){!function(e){const i="http://www.w3.org/2000/svg";let r=class PacemColumnChartElement extends e.PacemSeriesChartElement{constructor(){super(...arguments),this.groupWidth=0}propertyChangedCallback(t,e,i,r){super.propertyChangedCallback(t,e,i,r),"type"!==t&&"groupWidth"!==t||this.draw()}_safen(t=this.groupWidth){return Math.min(1,Math.max(t||.75,0))}drawSeries(e){if(!this.isReady||t.Utils.isNull(this.chartSize))return;this.ensureChartContainer();const r=this.type||"cluster",s=24;var a=this.chartSize;if(a.height<=s||a.width<=s)return;if(t.Utils.isNullOrEmpty(e)||e.every((e=>t.Utils.isNullOrEmpty(e.values))))return void this.wipeOut();const n=this.ensureChartBody("column",a.width,a.height);this.log(t.Logging.LogLevel.Debug,`Drawing ${r} chart.`);const o=this.xAxisType||"string";let l=0,h=0,c=0,d=0,u=0,m=1;const p={negative:[],positive:[]};for(let i of e){let e=i.values;if(!t.Utils.isNullOrEmpty(e)){let t=0;for(let i of e){p.positive[t]=p.positive[t]||0,p.negative[t]=p.negative[t]||0;let r=this.chartDataItemToPoint(i,e);l=Math.min(l,r.y),h=Math.max(h,r.y),c=Math.min(c,r.x),d=Math.max(d,r.x),r.y>0?p.positive[t]+=r.y:r.y<0&&(p.negative[t]+=r.y),t++}u=Math.max(u,e.length)}}const g="stack"===r;g&&(l=Math.min.apply(null,p.negative),h=Math.max.apply(null,p.positive));const v=Math.max(s,this.estimateYAxisLabelWidth(h)+12);0===d&&d===c&&(d=1);const y=(d-c)/u,f=.5*y,b=y*this._safen(this.groupWidth),C=.5*b,_=e.find((e=>!t.Utils.isNullOrEmpty(e.values))),x=this.getVirtualGrid(_.values,c-f,d+f,l,h,o,this.yAxisDensity),A=x.y[x.y.length-1],E=x.y[0];if(A===E)return;const w=a.width-2*v,N=a.height-48,S=N*(1-(A-E-(h-l))/(A-E)),P=N*(A-h)/(A-E);m=w/S,n.setAttribute("height",a.height.toString()),n.setAttribute("width",a.width.toString()),n.setAttribute("viewBox",`0 0 ${a.width} ${a.height}`);let M=0;const U=100*m/(d-c),k=100/(h-l),$=2400/S,L=this.chartSeries,W=this.chartGrid,O=(f-c)*U,D=(t,e)=>{const i=this.chartDataItemToPoint(t,e);return{x:O+2*i.x*O,y:i.y*k}};var T=new Array(u);for(let r of e){let s,a,n,o;if(L.length>M)s=L[M],a=s.firstElementChild.firstElementChild,n=s.firstElementChild.lastElementChild,o=s.lastElementChild;else{s=document.createElementNS(i,"svg"),s.setAttribute("pacem",""),W.insertAdjacentElement("afterend",s);const t=document.createElementNS(i,"defs");t.appendChild(a=this.buildLinearGradient(M)),t.appendChild(n=this.buildLinearGradient(M,!0)),s.appendChild(t),s.appendChild(o=document.createElementNS(i,"g")),L.push(s)}var G="chart-series series-fill";t.Utils.isNullOrEmpty(r.className)||(G+=" "+r.className),s.setAttribute("class",G),s.setAttribute("x",v.toString()),s.setAttribute("y",P.toString()),s.setAttribute("width",w.toString()),s.setAttribute("height",(S+48).toString());const l=r.values,h=t=>{for(;t>=o.children.length;)o.appendChild(document.createElementNS(i,"rect"));const e=o.children.item(t);e.style.stroke=r.color;const s=l[t].value<0?n:a;return this.setGradientColor(s,r.color),e.style.fill=`url(#${s.id})`,e},c=10,d=(t,e,i,r=e)=>{const s=-Math.max(e.y,i.y),a=Math.abs(i.y-e.y),n=()=>{t.setAttribute("y",s.toFixed(c)),t.setAttribute("height",a.toFixed(c))};t.hasAttribute("y")?n():(t.setAttribute("y","-"+r.y.toFixed(c)),t.setAttribute("height","0"),requestAnimationFrame(n))};if(!t.Utils.isNullOrEmpty(l)){const i=D({value:0,label:l[0].label},l);if(g){const e=C*U,s=(b*U).toFixed(c);for(let a=0;a<l.length;a++){const n=l[a];t.Utils.isNullOrEmpty(T[a])&&(T[a]={positive:0,negative:0});const o=T[a];let u=o.positive,m=o.negative;const p=n.value<0,g=p?m:u+n.value,v=p?m+n.value:u,y=D({label:n.label,value:g},l),f=D({label:n.label,value:v},l),b=y.x-e,C=h(a);this.assignUiBehaviors(C,r,n),C.setAttribute("x",b.toFixed(c)),C.setAttribute("width",s),d(C,f,y,i),p?o.negative=v:o.positive=g}}else{const t=C*U,s=2*t/e.length,a=s.toFixed(c);for(let e=0;e<l.length;e++){const n=l[e],o=D(n,l),u=o.x-t+s*M,m=h(e);this.assignUiBehaviors(m,r,n),m.setAttribute("x",u.toFixed(c)),m.setAttribute("width",a),d(m,i,o)}}}for(let t=o.children.length-1;t>=(null==l?void 0:l.length);t--){const e=o.children.item(t);this.disposeUiBehaviors(e),e.remove()}M++}this.wipeOut(L,M);const z=`0 ${-(h*k+$)} ${100*m} ${100+2*$}`;for(var B of L)B.setAttribute("viewBox",z);let F,I=this.chartMask.children.item(1);if(I.setAttribute("x",(0).toString()),I.setAttribute("height",(a.height-s).toString()),W.setAttribute("viewBox",`0 0 ${a.width} ${a.height}`),x.x.length<1||x.y.length<=1){for(let t=W.children.length-1;t>=0;t--)W.children.item(t).remove();return}W.children.length>0?F=W.children.item(0):(F=document.createElementNS(i,"path"),W.appendChild(F));let V=0,R=(t,e,r,s)=>{const a=t+1;let n;return W.children.length<=a?(n=document.createElementNS(i,"text"),W.appendChild(n)):n=W.children.item(a),n.textContent=s,n.setAttribute("x",e.toString()),n.setAttribute("y",r.toString()),n},H=`M${v},24 v${N}`,Y=0;const j=w/x.x.length,J=N/(x.y.length-1);if("none"!==this.xAxisPosition){const t=.5*j+v;for(var q of x.x){let e=t+Y*j;if("top"===this.xAxisPosition){H+=` M${e},24 v-6`;let t=R(V++,e,0,q);t.setAttribute("text-anchor","middle"),t.setAttribute("alignment-baseline","hanging")}else{let t=N+s;H+=` M${e},${t} v6`,R(V++,e,t+s,q).setAttribute("text-anchor","middle")}Y++}}for(var X of(Y=0,x.y)){const t=N+s-Y*J,e=v-6;H+=` M${e},${t} H${w+v}`,R(V++,e-6,t,this.formatYAxisLabel(X)).setAttribute("text-anchor","end"),Y++}F.setAttribute("d",H);for(let t=W.children.length-1;t>V;t--)W.children.item(t).remove()}};__decorate([t.Watch({converter:t.PropertyConverters.String})],r.prototype,"type",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Number})],r.prototype,"groupWidth",void 0),r=__decorate([t.CustomElement({tagName:t.P+"-column-chart"})],r),e.PacemColumnChartElement=r}(e.Charts||(e.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={})),function(t){!function(e){!function(e){function i(e,i,r){let s=e,a=e;const n=t.Utils.isNull(i),o=t.Utils.isNull(r);if(!n||!o){const t=3;let l,h;n||(l=(e.y-i.y)/(e.x-i.x)),o||(h=(r.y-e.y)/(r.x-e.x));const c=((h||l||0)+(l||h||0))/2,d=n?0:(e.x-i.x)/t,u=o?0:(r.x-e.x)/t;s={x:e.x-d,y:e.y-d*c},a={x:e.x+u,y:e.y+u*c}}return{c0:s,c1:a}}const r=t.CustomElementUtils.getAttachedPropertyValue,s=t.CustomElementUtils.setAttachedPropertyValue,a=(t.CustomElementUtils.deleteAttachedPropertyValue,"pacem:chart-series:area"),n="http://www.w3.org/2000/svg";let o=class PacemChartElement extends e.PacemSeriesChartElement{_getVirtualGrid(t,e,i,r,s,a=this.xAxisType,n){return super.getVirtualGrid(t,e,i,r,s,a,n)}_wipe(t=this.chartSeries,e=0){super.wipeOut(t,e)}propertyChangedCallback(t,e,i,r){super.propertyChangedCallback(t,e,i,r),"type"===t&&this.draw()}_buildLinearGradient(t){return super.buildLinearGradient(t)}_setGradientColor(t,e){super.setGradientColor(t,e)}drawSeries(e){if(!this.isReady||t.Utils.isNull(this.chartSize))return;this.ensureChartContainer();const o=this.type||"line",l=24;var h=this.chartSize;if(h.height<=l||h.width<=l)return;if(t.Utils.isNullOrEmpty(e)||e.every((e=>t.Utils.isNullOrEmpty(e.values))))return void this._wipe();const c=this.ensureChartBody("line",h.width,h.height);this.log(t.Logging.LogLevel.Debug,`Drawing ${o} chart.`);const d=this.xAxisType||"string";let u=Number.NaN,m=Number.NaN,p=Number.NaN,g=Number.NaN,v=1;for(let t of e){let e=t.values;if(e&&e.length){let t=0;for(let i of e){let r=this.chartDataItemToPoint(i,e);u=isNaN(u)?r.y:Math.min(u,r.y),m=isNaN(m)?r.y:Math.max(m,r.y),0===t?p=isNaN(p)?r.x:Math.min(p,r.x):t===e.length-1&&(g=isNaN(g)?r.x:Math.max(g,r.x)),t++}}}const y=Math.max(l,.5*this.estimateXAxisLabelWidth(p)+24),f=Math.max(y,this.estimateYAxisLabelWidth(m)+12),b=e.find((e=>!t.Utils.isNullOrEmpty(e.values))),C=this._getVirtualGrid(b.values,p,g,u,m,d,this.yAxisDensity),_=C.y[C.y.length-1],x=C.y[0];if(_===x)return;const A=h.width-f-y,E=h.height-48,w=E*(1-(_-x-(m-u))/(_-x)),N=E*(_-m)/(_-x);("number"!==d||"monometric"!==this.aspectRatio&&"logaritmic"!==this.aspectRatio)&&(v=A/w,c.setAttribute("height",h.height.toString()),c.setAttribute("width",h.width.toString())),c.setAttribute("viewBox",`0 0 ${h.width} ${h.height}`);let S=0;const P=100*v/(g-p),M=100/(m-u),U=2400/w,k=(t,e)=>{let i=this.chartDataItemToPoint(t,e);return i.y*=M,i.x=(i.x-p)*P,i},$=this.chartSeries,L=this.chartGrid,W="spline"===o||"splinearea"===o;for(let l of e){let e,h;if($.length>S)e=$[S],h=e.firstElementChild.firstElementChild;else{e=document.createElementNS(n,"svg"),e.setAttribute("pacem",""),L.insertAdjacentElement("afterend",e);const t=document.createElementNS(n,"defs");t.appendChild(h=this._buildLinearGradient(S)),e.appendChild(t),e.appendChild(document.createElementNS(n,"path")),e.appendChild(document.createElementNS(n,"path")),$.push(e)}var O="chart-series",D="area"===o||"splinearea"===o;t.Utils.isNullOrEmpty(l.className)||(O+=" "+l.className),e.setAttribute("class",O),e.setAttribute("x",f.toString()),e.setAttribute("y",N.toString()),e.setAttribute("width",A.toString()),e.setAttribute("height",(w+48).toString());let c=e.children.item(1),d=e.lastElementChild;d.style.stroke=l.color,c.style.stroke=d.style.fill="none",this._setGradientColor(h,l.color),c.style.fill=`url(#${h.id})`,c.style.display=D?"":"none";let m="",p=l.values;if(p&&p.length)if(W){let e,n,o;for(let h=0;h<p.length;h++){const c=p[h];if(isNaN(c.value))continue;let d;n||(n=k(c,p)),W&&h<p.length-1&&(d=k(p[h+1],p));let u=r(l,a,0);u+=c.value,s(l,a,u);var T=i(n,e,d);m+=t.Utils.isNullOrEmpty(m)?`M${n.x},${-n.y} `:`C${o.x},${-o.y} ${T.c0.x},${-T.c0.y} ${n.x},${-n.y} `,e=n,n=d,o=T.c1}}else for(let e of p){if(isNaN(e.value))continue;const i=k(e,p);let n=r(l,a,0);n+=e.value,s(l,a,n),m+=t.Utils.isNullOrEmpty(m)?`M${i.x},${-i.y} `:`L${i.x},${-i.y} `}d.setAttribute("d",m),c.setAttribute("d",m+`V${-u*M} H0 Z`),S++}this._wipe($,S);const G=`0 ${-(m*M+U)} ${100*v} ${100+2*U}`;for(var z of $)z.setAttribute("viewBox",G);let B,F=this.chartMask.children.item(1);if(F.setAttribute("x",(0).toString()),F.setAttribute("height",(h.height-l).toString()),L.setAttribute("viewBox",`0 0 ${h.width} ${h.height}`),C.x.length<=1||C.y.length<=1){for(let t=L.children.length-1;t>=0;t--)L.children.item(t).remove();return}L.children.length>0?B=L.children.item(0):(B=document.createElementNS(n,"path"),L.appendChild(B));let I=0,V=(t,e,i,r)=>{const s=t+1;let a;return L.children.length<=s?(a=document.createElementNS(n,"text"),L.appendChild(a)):a=L.children.item(s),a.textContent=r,a.setAttribute("x",e.toString()),a.setAttribute("y",i.toString()),a},R=`M${f},24 v${E}`,H=0;const Y=A/(C.x.length-1),j=E/(C.y.length-1);if("none"!==this.xAxisPosition)for(var J of C.x){let t=f+H*Y;if("top"===this.xAxisPosition){R+=` M${t},24 v-6`;let e=V(I++,t,0,J);e.setAttribute("text-anchor","middle"),e.setAttribute("alignment-baseline","hanging")}else{let e=E+l;R+=` M${t},${e} v6`,V(I++,t,e+l,J).setAttribute("text-anchor","middle")}H++}for(var q of(H=0,C.y)){const t=E+l-H*j,e=f-6;R+=` M${e},${t} H${A+f}`,V(I++,e-6,t,this.formatYAxisLabel(q)).setAttribute("text-anchor","end"),H++}B.setAttribute("d",R);for(let t=L.children.length-1;t>I;t--)L.children.item(t).remove()}};__decorate([t.Watch({emit:!1,converter:t.PropertyConverters.String})],o.prototype,"type",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Boolean})],o.prototype,"aspectRatio",void 0),o=__decorate([t.CustomElement({tagName:t.P+"-chart"})],o),e.PacemChartElement=o}(e.Charts||(e.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={})),function(t){!function(e){!function(i){let r=class PacemPieSliceElement extends e.PacemItemElement{constructor(){super(...arguments),this._broadcastHandler=t=>{this.emit(t)}}findContainer(){return t.CustomElementUtils.findAncestorOfType(this,n)}get chart(){return this.container}getCenterOfMass(){const e=this.chart&&this.chart.area;if(t.Utils.isNull(e))return null;const i=t.Utils.offset(e),r=i.width/2+i.left,s=i.top+i.height/2,n=.5*Math.min(i.width,i.height),o=this.normalizedPolarCoords,l=a-o.angle;return{y:s-n*o.radius*Math.sin(l),x:r+n*o.radius*Math.cos(l)}}propertyChangedCallback(t,e,i,r){super.propertyChangedCallback(t,e,i,r),!r&&this.chart&&"normalizedPolarCoords"!=t&&this.chart.draw()}_assignUi(t){const e=this._ui=t;i.MANAGED_EVENTS.forEach((t=>{e.addEventListener(t,this._broadcastHandler)}))}_disposeUi(){t.Utils.isNull(this._ui)||i.MANAGED_EVENTS.forEach((t=>{this._ui.removeEventListener(t,this._broadcastHandler)}))}};__decorate([t.Watch({converter:t.PropertyConverters.Number})],r.prototype,"value",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],r.prototype,"label",void 0),__decorate([t.Watch({converter:t.PropertyConverters.String})],r.prototype,"color",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Json})],r.prototype,"normalizedPolarCoords",void 0),r=__decorate([t.CustomElement({tagName:t.P+"-pie-slice"})],r),i.PacemPieSliceElement=r;const s=2*Math.PI,a=.5*Math.PI;let n=class PacemPieChartElement extends e.PacemItemsContainerElement{constructor(){super(),this.cutout=0,this._slices=new WeakMap,this._key=t.Utils.uniqueCode()}validate(t){return t instanceof r}viewActivatedCallback(){super.viewActivatedCallback(),this.draw()}propertyChangedCallback(e,i,r,s){if(super.propertyChangedCallback(e,i,r,s),"target"===e){this._g=null,this._div&&this._div.remove();const e=i;e&&(e.classList.remove(t.PCSS+"-chart-area"),e.innerHTML=""),this.draw()}else s||"cutout"!==e&&"items"!==e||this.draw()}get area(){return this._svg}disconnectedCallback(){this._div&&this._div.remove(),super.disconnectedCallback()}_ensureArea(){if(t.Utils.isNull(this._g)){let e=this.target||(this._div=document.createElement("div"));e.classList.add(t.PCSS+"-chart-area");let i=this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("pacem",""),i.setAttribute("preserveAspectRatio","xMidYMid meet"),i.setAttribute("viewBox","0 0 100 100"),i.classList.add(t.PCSS+"-pie-chart");let r=document.createElementNS("http://www.w3.org/2000/svg","defs"),s=this._g=document.createElementNS("http://www.w3.org/2000/svg","g");i.appendChild(r),i.appendChild(s),e.appendChild(i),this._div&&this.parentElement.insertBefore(e,this)}if(this.maskBasedRendering){if(t.Utils.isNull(this._mask)){let t=document.createElementNS("http://www.w3.org/2000/svg","mask");t.id="pie_mask_"+this._key;let e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100"),e.setAttribute("height","100"),e.setAttribute("fill","#fff");let i=this._mask=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttribute("cx","50"),i.setAttribute("cy","50");const r=this._svg.firstElementChild;t.appendChild(e),t.appendChild(i),r.appendChild(t),this._g.setAttribute("mask",`url(#${t.id})`)}const e=50*this._safeCutout;this._mask.setAttribute("r",`${e}`)}else t.Utils.isNull(this._mask)||(this._svg.firstElementChild.innerHTML="",this._mask=null,this._g.removeAttribute("mask"));return this._g}get _safeCutout(){return Math.min(1,Math.max(0,this.cutout))||0}_drawSlice(t,e,i,r){const a=e.value>.5*i?1:0,n=s*e.value/i,o=360*r/i,l=e.value>=i?49.9:50*(1+Math.sin(n)),h=50*(1-Math.cos(n)),c=this._safeCutout,d=50*c;t.style.fill=e.color,t.style.transform=`rotate(${o}deg)`,t.style.transformOrigin="50% 50%";const u=this.maskBasedRendering?`M50,50 V0 A50,50 0 ${a} 1 ${l} ${h} L50,50 Z`:`M50,0 A50,50 0 ${a} 1 ${l} ${h} l${(50-l)*(1-c)},${(50-h)*(1-c)} A${d},${d} 0 ${a} 0 50,${50-d} Z`;t.setAttribute("d",u),e.normalizedPolarCoords={radius:c+Math.SQRT1_2*(1-c),angle:Math.PI*o/180+n/2}}_isSliceOk(t){return!t.disabled}draw(){const e=this._ensureArea(),i=e.children.length,r=this._svg.parentElement;let s=0,a=0,n=0;if(t.Utils.isNullOrEmpty(this.items))e.innerHTML="",t.Utils.removeClass(r,"chart-has-data");else{t.Utils.addClass(r,"chart-has-data");for(let t of this.items)this._isSliceOk(t)&&(a+=t.value);if(a<=0)e.innerHTML="",t.Utils.removeClass(r,"chart-has-data");else for(let r of this.items){if(!this._isSliceOk(r))continue;let o;if(s>=i){const i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("class","chart-series "+t.PCSS+"-pie-slice"+(t.Utils.isNullOrEmpty(r.className)?"":" "+r.className)),o=document.createElementNS("http://www.w3.org/2000/svg","path"),i.appendChild(o),e.appendChild(i),r._assignUi(i),this._slices.set(i,r)}else o=e.children.item(s).firstElementChild;r.value>0?(this._drawSlice(o,r,a,n),n+=r.value,o.removeAttribute("display")):o.setAttribute("display","none"),s++}}for(;s<e.children.length;){const t=this._slices,i=e.children.item(s);t.has(i)&&(t.get(i)._disposeUi(),t.delete(i)),e.removeChild(i)}}};__decorate([t.Watch({converter:t.PropertyConverters.Number})],n.prototype,"cutout",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Element})],n.prototype,"target",void 0),__decorate([t.Watch({converter:t.PropertyConverters.Boolean})],n.prototype,"maskBasedRendering",void 0),__decorate([t.Debounce(!0)],n.prototype,"draw",null),n=__decorate([t.CustomElement({tagName:t.P+"-pie-chart"})],n),i.PacemPieChartElement=n}(e.Charts||(e.Charts={}))}(t.Components||(t.Components={}))}(Pacem||(Pacem={}));