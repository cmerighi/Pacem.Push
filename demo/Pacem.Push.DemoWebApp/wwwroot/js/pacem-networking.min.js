/**
 * pacem v0.20.0-alexandria (https://js.pacem.it)
 * Copyright 2021 Pacem (https://pacem.it)
 * Licensed under MIT
 */
var Pacem,__decorate=this&&this.__decorate||function(e,t,o,n){var i,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(s<3?i(r):s>3?i(t,o,r):i(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r};!function(e){!function(t){const o="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/5.0.7/signalr.min.js";let n=class PacemHubListener extends t.PacemItemElement{constructor(){super(...arguments),this.onreceive=(...e)=>{this.dispatchEvent(new CustomEvent("receive",{detail:Array.from(e)}))}}propertyChangedCallback(t,o,n,s){if(super.propertyChangedCallback(t,o,n,s),this.container instanceof i&&!e.Utils.isNull(this.container.connection)){const i=this.container.connection;switch(t){case"method":e.Utils.isNullOrEmpty(o)||i.off(o,this.onreceive),e.Utils.isNullOrEmpty(n)||i.on(n,this.onreceive);break;case"disabled":if(!e.Utils.isNullOrEmpty(this.method)){(n?i.off:i.on)(this.method,this.onreceive)}}}}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],n.prototype,"method",void 0),n=__decorate([e.CustomElement({tagName:e.P+"-hub-listener"})],n),t.PacemHubListener=n;let i=class PacemHubProxy extends t.PacemItemsContainerElement{validate(e){return e instanceof n}get connection(){return this._hub}invoke(e,...t){if(this.connected)return this._hub.invoke.apply(this._hub,arguments);throw"Hub is not connected. Cannot call `invoke` method."}send(e,...t){if(this.connected)return this._hub.send.apply(this._hub,arguments);throw"Hub is not connected. Cannot call `send` method."}start(){this._resetProxy()}propertyChangedCallback(e,t,o,n){super.propertyChangedCallback(e,t,o,n),"url"!==e&&"disabled"!==e&&"accesstoken"!==e||this._resetProxy()}disconnectedCallback(){this.connected&&this._hub.stop(),super.disconnectedCallback()}async _resetProxy(){e.Utils.isNull(this._hub)||(await this._hub.stop(),this.connected=!1),this._setupProxy()}_initialize(){return e.CustomElementUtils.importjs(o)}async _setupProxy(){if(!this.disabled&&!e.Utils.isNullOrEmpty(this.url)){await this._initialize();const o=new signalR.HubConnectionBuilder;o.withUrl(this.url,{accessTokenFactory:()=>this.accesstoken});const n=this._hub=o.build();for(var t of(n.onclose((()=>{this.connected=!1,this._hub=null})),await n.start(),this.connected=!0,this.items))t.disabled||e.Utils.isNullOrEmpty(t.method)||n.on(t.method,t.onreceive)}}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"url",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"accesstoken",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],i.prototype,"connected",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-hub-proxy"})],i),t.PacemHubProxy=i}(e.Components||(e.Components={}))}(Pacem||(Pacem={}));