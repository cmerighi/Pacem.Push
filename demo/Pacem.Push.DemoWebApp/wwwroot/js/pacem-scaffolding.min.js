/**
 * pacem v0.10.0-jericho (https://js.pacem.it)
 * Copyright 2020 Pacem (https://pacem.it)
 * Licensed under MIT
 */
var Pacem,__decorate=this&&this.__decorate||function(e,t,a,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,i);else for(var n=e.length-1;n>=0;n--)(r=e[n])&&(o=(s<3?r(o):s>3?r(t,a,o):r(t,a))||o);return s>3&&o&&Object.defineProperty(t,a,o),o},__awaiter=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))(function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function n(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(o,n)}l((i=i.apply(e,t||[])).next())})};!function(e){!function(t){!function(a){a.CHAR_COUNTER_CHILD=`<${e.P}-char-count hide="{{ :host.readonly || !(:host.minlength > 0 || :host.maxlength > 0) }}" minlength="{{ :host.minlength }}" maxlength="{{ :host.maxlength }}" string="{{ :host.value }}"></${e.P}-char-count>`;let i=class PacemCharCountElement extends t.PacemElement{_isValid(e){const t=this._length(e);return!(this.minlength>0&&t<this.minlength)&&!(this.maxlength>0&&t>this.maxlength)}_length(e){return e&&e.length||0}};__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"minlength",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxlength",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"string",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-char-count",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-panel class="${e.PCSS}-char-count" css-class="{{ {'valid': :host._isValid(:host.string), 'invalid': !:host._isValid(:host.string) } }}">\n    <${e.P}-span hide="{{ !(:host.minlength > 0) }}" class="${e.PCSS}-char-min" content="{{ :host.minlength }}"></${e.P}-span>\n    <${e.P}-span class="${e.PCSS}-char-curr" content="{{ :host._length(:host.string) || '0' }}"></${e.P}-span>\n    <${e.P}-span hide="{{ !(:host.maxlength > 0) }}" class="${e.PCSS}-char-max" content="{{ :host.maxlength }}"></${e.P}-span>\n</${e.P}-panel>`})],i),a.PacemCharCountElement=i}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){const i="pacem:model:original-value";class PacemFormRelevantElement extends t.PacemElement{viewActivatedCallback(){super.viewActivatedCallback(),this.form=e.CustomElementUtils.findAncestorOfType(this,a.PacemFormElement)}}__decorate([e.Watch({converter:e.PropertyConverters.Element})],PacemFormRelevantElement.prototype,"form",void 0),a.PacemFormRelevantElement=PacemFormRelevantElement;class PacemModelElement extends PacemFormRelevantElement{viewActivatedCallback(){super.viewActivatedCallback(),e.Utils.isNullOrEmpty(this.name)||this.form&&this.form.registerField(this.name,this),this._setAsOriginalValue(this.value)}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"value":this.viewValue=this.getViewValue(i);break;case"valid":i?e.Utils.removeClass(this,e.PCSS+"-invalid"):e.Utils.addClass(this,e.PCSS+"-invalid");break;case"dirty":i?e.Utils.addClass(this,e.PCSS+"-dirty"):e.Utils.removeClass(this,e.PCSS+"-dirty");break;case"name":let s=this.form;null!=s&&(a&&s.unregisterField(a),s.registerField(i,this));break;case"form":let o=this.name;e.Utils.isNullOrEmpty(o)||(null!=a&&a.unregisterField(o),null!=i&&i.registerField(o,this))}}disconnectedCallback(){let t=this.name,a=this.form;e.Utils.isNullOrEmpty(t)||e.Utils.isNull(a)||a.unregisterField(t),super.disconnectedCallback()}get originalValue(){return e.CustomElementUtils.getAttachedPropertyValue(this,i)}_setAsOriginalValue(t){e.CustomElementUtils.setAttachedPropertyValue(this,i,t)}reset(){this.value=this.originalValue,this.dirty=!1}setPristine(){this._setAsOriginalValue(this.value),this.dirty=!1}setDirty(){this.dirty=!0}}__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemModelElement.prototype,"viewValue",void 0),__decorate([e.Watch({converter:{convert:(e,t)=>t instanceof PacemModelElement?t.convertValueAttributeToProperty(e):e,convertBack:e=>e.toString()}})],PacemModelElement.prototype,"value",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemModelElement.prototype,"dirty",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemModelElement.prototype,"valid",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemModelElement.prototype,"name",void 0),a.PacemModelElement=PacemModelElement;class PacemBaseElement extends PacemModelElement{constructor(){super(...arguments),this.focusHandler=(t=>{const a=(t=!0)=>{e.Utils.is(this.parentElement,"."+e.PCSS+"-fieldgroup")&&(t?e.Utils.addClass:e.Utils.removeClass).apply(this,[this.parentElement,e.PCSS+"-focus"])};switch(t.type){case"focus":e.Utils.addClass(this,e.PCSS+"-focus"),a(),this._preFocusValue=this.value;break;case"blur":e.Utils.removeClass(this,e.PCSS+"-focus"),(()=>a(!1))()}t.bubbles?this.emit(t):this.dispatchEvent(new FocusEvent(t.type))}),this.changeHandler=(e=>{const t=this.value;this.onChange(e).then(e=>{this.compareValuePropertyValues(t,e)||(this.dispatchEvent(new Event("change")),this.dirty=!0)},e=>{})}),this.keydownHandler=(t=>{e.stopPropagationHandler(t)}),this.keyupHandler=(t=>{switch(t.keyCode){case 27:e.stopPropagationHandler(t),this.compareValuePropertyValues(this.originalValue,this._preFocusValue)?this.reset():this.value=this._preFocusValue,this.blur();break;case 13:this.preventKeyboardSubmit&&e.stopPropagationHandler(t)}})}compareValuePropertyValues(t,a){return e.DefaultComparer(t,a)}get preventKeyboardSubmit(){return!1}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"required":case"disabled":case"autofocus":case"placeholder":case"readonly":for(let e of this.inputFields)i?e.setAttribute(t,i):e.removeAttribute(t);break;case"tabOrder":for(let e of this.inputFields)e.setAttribute("tabindex",i);break;case"value":this.acceptValue(i)}if("required"===t||"disabled"===t||"readonly"===t){let a=`${e.PCSS}-${t}`;i?e.Utils.addClass(this,a):e.Utils.removeClass(this,a)}"readonly"===t?this.toggleReadonlyView(i):"required"===t?this.aria.attributes.set("required",!!i+""):"valid"===t&&this.aria.attributes.set("invalid",(!i&&!!this.dirty)+"")}viewActivatedCallback(){if(super.viewActivatedCallback(),this.toggleReadonlyView(this.readonly||!1),!e.Utils.isNullOrEmpty(this.id)){const e=document.querySelector(`label[for=${this.id}]`);e?e.id?this.aria.attributes.set("labelledby",e.id):this.aria.attributes.set("label",e.textContent):(this.aria.attributes.remove("labelledby"),this.aria.attributes.remove("label"))}for(let t of this.inputFields)t.addEventListener("focus",this.focusHandler,!1),t.addEventListener("blur",this.focusHandler,!1),t.addEventListener("change",this.changeHandler,!1),t.addEventListener("keydown",this.keydownHandler,!1),t.addEventListener("keyup",this.keyupHandler,!1),t.addEventListener("mousedown",e.stopPropagationHandler,!1),t.addEventListener("touchstart",e.stopPropagationHandler,{passive:!1,capture:!1})}disconnectedCallback(){for(let t of this.inputFields)e.Utils.isNull(t)||(t.removeEventListener("touchstart",e.stopPropagationHandler,{capture:!1}),t.removeEventListener("keydown",this.keydownHandler,!1),t.removeEventListener("keyup",this.keyupHandler,!1),t.removeEventListener("mousedown",e.stopPropagationHandler,!1),t.removeEventListener("change",this.changeHandler,!1),t.removeEventListener("focus",this.focusHandler,!1),t.removeEventListener("blur",this.focusHandler,!1));super.disconnectedCallback()}focus(){const e=this.inputFields;e&&e.length&&e[0].focus()}blur(){const t=this.inputFields;if(!e.Utils.isNullOrEmpty(t))for(let e of t)e.blur()}}__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemBaseElement.prototype,"required",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemBaseElement.prototype,"autofocus",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemBaseElement.prototype,"readonly",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemBaseElement.prototype,"name",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemBaseElement.prototype,"placeholder",void 0),a.PacemBaseElement=PacemBaseElement;let r=class PacemDataItemElement extends HTMLElement{_findContainer(){return e.CustomElementUtils.findAncestor(this,e=>e instanceof PacemDataSourceElement)}viewActivatedCallback(){const t=this._container=this._findContainer();e.Utils.isNull(t)||t.register(this)}disconnectedCallback(){e.Utils.isNull(this._container)||this._container.unregister(this)}};__decorate([e.Watch({converter:{convert:(t,a)=>{if("true"===t)return!0;if("false"===t)return!1;let i=parseFloat(t);if(!isNaN(i))return i;let r=e.Utils.Dates.parse(t);return e.Utils.Dates.isDate(r)?r:t},convertBack:e=>e.toString()}})],r.prototype,"value",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],r.prototype,"label",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],r.prototype,"disabled",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-data-item"})],r),a.PacemDataItemElement=r;class PacemDataSourceElement extends PacemBaseElement{constructor(e=!1){super(),this.multipleChoice=e,this._itemPropertyChangedHandler=(e=>{this.databind()})}register(t){let a=!0;return e.Utils.isNull(this.items)?this.items=[t]:-1===this.items.indexOf(t)?this.items.push(t):a=!1,a&&t.addEventListener(e.PropertyChangeEventName,this._itemPropertyChangedHandler,!1),a}unregister(t){const a=!e.Utils.isNull(this.items)&&this.items.indexOf(t);if(a>=0){return this.items.splice(a,1)[0].removeEventListener(e.PropertyChangeEventName,this._itemPropertyChangedHandler,!1),!0}return!1}buildAdaptedDatasource(e=this.datasource){return e&&e.map(e=>this.mapEntityToItem(e))}databind(t=this.buildAdaptedDatasource(this.datasource)){if(e.Utils.isNull(t)&&e.Utils.isNull(this.adaptedDatasource))return;const a=this.adaptedDatasource=t||[];e.Utils.isNullOrEmpty(a.filter(e=>this.isDataSourceItemSelected(e)))&&this.handleDatasourceMismatch(a)}handleDatasourceMismatch(e){this.value=void 0}isItemSelected(t,a=this.value){if(e.Utils.isNullOrEmpty(a))return!1;const i=this.mapEntityToValue(t),r=this.compareBy;return this.multipleChoice&&e.Utils.isArray(a)?!e.Utils.isNull(a.find(t=>t==i||"object"==typeof t&&!e.Utils.isNullOrEmpty(r)&&r in i&&r in t&&i[r]==t[r])):!this.multipleChoice&&(a==i||"object"==typeof a&&!e.Utils.isNullOrEmpty(r)&&r in i&&r in a&&i[r]==a[r])}isDataSourceItemSelected(t,a=this.value){if(e.Utils.isNullOrEmpty(a))return!1;if(t.disabled)return!1;const i=this.compareBy;if(this.multipleChoice&&e.Utils.isArray(a)){let r=a.find(a=>a==t.value||"object"==typeof a&&!e.Utils.isNullOrEmpty(i)&&i in a&&!e.Utils.isNullOrEmpty(t.value)&&i in t.value&&a[i]==t.value[i]);return!e.Utils.isNull(r)}return!this.multipleChoice&&(a==t.value||"object"==typeof a&&!e.Utils.isNullOrEmpty(i)&&i in a&&!e.Utils.isNullOrEmpty(t.value)&&i in t.value&&a[i]==t.value[i])}mapEntityToValue(e){if(null==e)throw"entity cannot be null";if(e instanceof r)return e.value;let t,a=e;return(t=this.valueProperty)&&(a=e[t]),a}mapEntityToViewValue(e){if(null==e)throw"entity cannot be null";if(e instanceof r)return e.label||e.value;let t,a=e.toString();return(t=this.textProperty)&&(a=e[t]),a}mapEntityToItem(t){if(null==t)throw"entity cannot be null";if(t instanceof r)return{value:t.value,viewValue:t.label||t.value,disabled:t.disabled};let a=!1;const i=this.disabledProperty;return e.Utils.isNullOrEmpty(i)||(a=t[i]||!1),{value:this.mapEntityToValue(t),viewValue:this.mapEntityToViewValue(t),disabled:a}}propertyChangedCallback(e,t,a,i){switch(super.propertyChangedCallback(e,t,a,i),e){case"datasource":case"textProperty":case"disabledProperty":case"valueProperty":cancelAnimationFrame(this._handle),this._handle=requestAnimationFrame(()=>{this.databind(),this.viewValue=this.getViewValue(this.value)});break;case"items":cancelAnimationFrame(this._handleItems),this._handleItems=requestAnimationFrame(()=>{this.datasource=this.items})}}getViewValue(t){if(!e.Utils.isNullOrEmpty(this.datasource))return this.datasource.filter(e=>this.isItemSelected(e)).map(e=>this.mapEntityToViewValue(e)).join(", ")}convertValueAttributeToProperty(e){return this.multipleChoice?e.split(",").map(e=>e.trim()):e}compareValuePropertyValues(t,a){return e.Utils.areSemanticallyEqual(t,a)}}__decorate([e.Watch()],PacemDataSourceElement.prototype,"items",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],PacemDataSourceElement.prototype,"datasource",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],PacemDataSourceElement.prototype,"valueProperty",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],PacemDataSourceElement.prototype,"textProperty",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],PacemDataSourceElement.prototype,"disabledProperty",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],PacemDataSourceElement.prototype,"compareBy",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],PacemDataSourceElement.prototype,"adaptedDatasource",void 0),__decorate([e.Debounce(!0)],PacemDataSourceElement.prototype,"databind",null),a.PacemDataSourceElement=PacemDataSourceElement}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemCheckboxListElement extends t.PacemDataSourceElement{constructor(){super(!0),this._selectedUiItems=[],this.key="_"+e.Utils.uniqueCode()}acceptValue(e){}get inputFields(){return[]}propertyChangedCallback(e,t,a,i){super.propertyChangedCallback(e,t,a,i),"disabled"===e&&(this._disable.model=a)}viewActivatedCallback(){super.viewActivatedCallback(),this._disable.model=this.disabled}toggleReadonlyView(e){this._span.hidden=!e,this._repeater.hidden=e}_selectionChanged(e,t,a){if("selected"===e.detail.propertyName){let a,i=this._selectedUiItems;!0===e.detail.currentValue?i.push(this.datasource[t]):-1!==(a=i.indexOf(this.datasource[t]))&&i.splice(a,1)}}onChange(t){const a=this.value=this._selectedUiItems.map(e=>this.mapEntityToValue(e));return e.Utils.fromResult(a)}};__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],a.prototype,"_span",void 0),__decorate([e.ViewChild(e.P+"-repeater")],a.prototype,"_repeater",void 0),__decorate([e.ViewChild(e.P+"-data")],a.prototype,"_disable",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-checkbox-list",template:`<${e.P}-repeater datasource="{{ :host.adaptedDatasource }}">\n    <ol class="${e.PCSS}-checkbox-list ${e.PCSS}-viewfinder" pacem>\n        <template>\n            <li><${e.P}-checkbox disabled="{{ ::_disable.model || ^item.disabled }}" name="{{ :host.key, once }}" caption="{{ ^item.viewValue }}" true-value="{{ ^item.value }}" selected="{{ :host.isDataSourceItemSelected(^item, :host.value) }}"\non-focus=":host.focusHandler($event)" on-blur=":host.focusHandler($event)"\non-${e.PropertyChangeEventName}=":host._selectionChanged($event, ^index, ^item)" on-change=":host.changeHandler($event)"></${e.P}-checkbox></li>\n        </template>\n    </ol>\n</${e.P}-repeater><span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span><${e.P}-data></${e.P}-data><${e.P}-content></${e.P}-content>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemCheckboxListElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const a={convert:e=>"true"===e||"false"!==e&&e,convertBack:e=>e.toString()};let i=class PacemCheckboxElement extends t.PacemBaseElement{constructor(){super("checkbox"),this.caption="",this._key="_"+e.Utils.uniqueCode()}convertValueAttributeToProperty(e){a.convert(e)===this.trueValue?this.trueValue:this.falseValue}toggleReadonlyView(e){this.span.hidden=!e,this._checkbox.hidden=this._label.hidden=e}get inputFields(){return[this._checkbox]}onChange(t){this.selected=this._checkbox.checked;const a=this.value=this.selected?this.trueValue:this.falseValue;return e.Utils.fromResult(a)}viewActivatedCallback(){super.viewActivatedCallback(),this._checkbox.id=this._label.htmlFor=this._key,this._synchronizeUi(),this.value==this.trueValue?this.selected=!0:this.value==this.falseValue&&(this.selected=!1)}propertyChangedCallback(t,a,i,r){if(super.propertyChangedCallback(t,a,i,r),this.isReady)switch(t){case"caption":this._label.hidden=e.Utils.isNullOrEmpty(i);break;case"name":this._checkbox.name=i;break;case"selected":this._synchronizeUi()}}_synchronizeUi(t=this.selected){(this._checkbox.checked=t)?(this.value=this.trueValue,e.Utils.addClass(this,e.PCSS+"-selected"),this.aria.attributes.set("checked","true")):(this.value=this.falseValue,e.Utils.removeClass(this,e.PCSS+"-selected"),this.aria.attributes.set("checked","false"))}acceptValue(e){this.selected=e==this.trueValue}getViewValue(t){return e.Utils.isNull(t)?"":this.caption}};__decorate([e.ViewChild("input[type=checkbox]")],i.prototype,"_checkbox",void 0),__decorate([e.ViewChild("label")],i.prototype,"_label",void 0),__decorate([e.ViewChild(`.${e.PCSS}-readonly`)],i.prototype,"span",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"caption",void 0),__decorate([e.Watch({emit:!1,converter:a})],i.prototype,"trueValue",void 0),__decorate([e.Watch({emit:!1,converter:a})],i.prototype,"falseValue",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],i.prototype,"selected",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-checkbox",template:`<${e.P}-span class="${e.PCSS}-readonly ${e.PCSS}-checkbox" text="{{ :host.caption }}"></${e.P}-span>\n<input type="checkbox" class="${e.PCSS}-input" /><label class="${e.PCSS}-label ${e.PCSS}-checkbox ${e.PCSS}-viewfinder" pacem><${e.P}-text text="{{ :host.caption }}"></${e.P}-text></label>`,shadow:e.Defaults.USE_SHADOW_ROOT})],i),t.PacemCheckboxElement=i}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){a.FormSubmitEventName="submit",a.FormResetEventName="reset";class FormSubmitEvent extends e.CustomTypedEvent{constructor(e){super(a.FormSubmitEventName,e,{bubbles:!0,cancelable:!0})}}a.FormSubmitEvent=FormSubmitEvent;class FormResetEvent extends Event{constructor(){super(a.FormResetEventName,{bubbles:!0,cancelable:!0})}}a.FormResetEvent=FormResetEvent;const i=["download",e.CommandEventName];class FormEventEmitter{constructor(t){this._element=t,this._itemEmitHandler=(t=>{if(this._element.handle(t),t.type===e.CommandEventName){const e=t;this._element.handle(new CustomEvent("item"+e.detail.commandName.toLowerCase(),{detail:e.detail.commandArgument}))}})}start(){i.forEach(e=>this._element.addEventListener(e,this._itemEmitHandler,!1))}stop(){i.forEach(e=>this._element.removeEventListener(e,this._itemEmitHandler,!1))}}a.FormEventEmitter=FormEventEmitter;let r=class PacemFormElement extends a.PacemFormRelevantElement{constructor(){super("form"),this.method=e.Net.HttpMethod.Post,this._emitter=null,this._buttons={submit:void 0,reset:void 0},this._keyupHandler=(t=>{if(!(13!==t.keyCode||t.shiftKey||t.ctrlKey||t.altKey||t.metaKey)){let a=t.currentTarget.querySelector(e.P+"-button[type=submit]");e.Utils.isNull(a)||!e.Utils.isVisible(a)||a.disabled||a.click()}}),this._submit=((t,a)=>{e.Utils.isNull(a)||e.avoidHandler(a),Promise.all(this._validateAllFields()).then(e=>{-1===e.findIndex(e=>!1===e)&&this.submit(t).then(e=>{this.setPristine()},e=>{})})}),this._reset=(t=>{e.Utils.isNull(t)||e.avoidHandler(t);var i=new FormResetEvent;if(this.dispatchEvent(i),!i.defaultPrevented){for(var r in this._fields){var s=this._fields[r];s instanceof a.PacemModelElement&&s.reset()}for(var o of this._subForms)o._reset()}}),this._fields={},this._validators={},this._subForms=[],this._fieldPropertyChanged=(e=>{switch(e.detail.propertyName){case"value":let t=e.target;this._checkFieldValidity(t.name);break;case"dirty":this._checkDirtyness();break;case"valid":this._checkValidity()}}),this._validatorPropertyChanged=(e=>{const t=e.target,a=t.watch;if("invalid"===e.detail.propertyName){let e=this._fields[t.watch];t.invalid?e.valid=!1:this._checkFieldValidity(a)}else this._checkFieldValidity(a)}),this.suddenValidation=!0,this.resettable=!0,this._emitter=new FormEventEmitter(this)}propertyChangedCallback(t,a,i,r){super.propertyChangedCallback(t,a,i,r),("method"===t&&!0===this.autogenerate&&!e.Utils.isNullOrEmpty(this.metadata)||"metadata"===t&&!0===this.autogenerate||"autogenerate"===t&&!0===i&&this.metadata&&(this.metadata.props||this.metadata).length>0)&&this._buildUpForm()}viewActivatedCallback(){super.viewActivatedCallback(),this.form&&this.form.registerSubForm(this),this._checkValidity(),this.addEventListener("keyup",this._keyupHandler,!1),this._emitter.start()}disconnectedCallback(){this._emitter.stop(),this.removeEventListener("keyup",this._keyupHandler,!1),this.form&&this.form.unregisterSubForm(this),super.disconnectedCallback()}_buildUpForm(){const t="_"+e.Utils.uniqueCode(),a=this.id=this.id||t,i="fetch"+t,r=document.createElement("form");r.id="form"+t,r.className=e.PCSS+"-form",r.setAttribute("pacem",""),r.setAttribute("novalidate","");const s=`<${e.P}-repeater class="${e.PCSS}-animatable-list ${e.PCSS}-list-bottom" datasource="{{ #${a}.metadata && (#${a}.metadata.props || #${a}.metadata) }}">\n    <${e.P}-panel css="{{ #${a}.metadata.display && #${a}.metadata.display.css }}" css-class="{{ (#${a}.metadata.display && #${a}.metadata.display.cssClass || []).concat(#${a}.suddenValidation ? [] : ['lazy-validation']) }}">\n        <template>\n            <${e.P}-form-field css-class="{{ ^item.display && ^item.display.cssClass }}" css="{{ ^item.display && ^item.display.css }}"\n                             fetch-credentials="{{ #${a}.fetchCredentials }}" fetch-headers="{{ #${a}.fetchHeaders }}"\n                             logger="{{ #${a}.logger }}" entity="{{ #${a}.entity, twoway }}" metadata="{{ ^item }}" readonly="{{ #${a}.readonly || ^item.isReadOnly }}"></${e.P}-form-field>\n        </template>\n    </${e.P}-panel>\n</${e.P}-repeater>\n<${e.P}-fetch logger="{{ #${a}.logger }}" id="${i}" method="${this.method}" credentials="{{ #${a}.fetchCredentials }}" headers="{{ #${a}.fetchHeaders }}"></${e.P}-fetch> \n<div class="${e.PCSS}-buttonset buttons">\n    <div class="buttonset-left">\n        <${e.P}-button logger="{{ #${a}.logger }}" on-click="#${a}._submit(#${i}, $event)" type="submit" hide="{{ #${a}.readonly || Pacem.Utils.isNullOrEmpty(#${a}.action) || !Pacem.Utils.isNull(#${a}.form) }}" class="button primary button-size size-small" css-class="{{ {'buttonset-last': !#${a}.resettable || !#${a}.dirty || !Pacem.Utils.isNull(#${a}.form) } }}" disabled="{{ #${a}.suddenValidation && (!(#${a}.valid && #${a}.dirty) || #${i}.fetching) }}">\n            <${e.P}-text text="{{ #${a}.submitCaption || 'OK' }}"></${e.P}-text>\n        </${e.P}-button>\n        <${e.P}-button logger="{{ #${a}.logger }}" on-click="#${a}._reset($event)" type="reset" class="button button-size size-small" css-class="{{ {'buttonset-first': #${a}.readonly || Pacem.Utils.isNullOrEmpty(#${a}.action) || !Pacem.Utils.isNull(#${a}.form)} }}" hide="{{ !#${a}.resettable || #${a}.readonly || !#${a}.dirty || !Pacem.Utils.isNull(#${a}.form) }}" disabled="{{ #${i}.fetching }}">\n            <${e.P}-text text="{{ #${a}.resetCaption || 'Reset' }}"></${e.P}-text>\n        </${e.P}-button>\n</div></div>`;r.innerHTML=s,this.innerHTML="",this.appendChild(r),r.addEventListener("submit",e.avoidHandler,!1);const o=this._buttons,n=this._buttons={submit:r.lastElementChild.firstElementChild.firstElementChild,reset:r.lastElementChild.firstElementChild.lastElementChild};this.dispatchEvent(new e.PropertyChangeEvent({propertyName:"formButtons",currentValue:n,oldValue:o}))}get formButtons(){return this._buttons}submit(t){if(e.Utils.isNull(t))throw"Fetcher cannot be null while submitting a form.";var a=e.DeferPromise.defer();return this._submitInternally(t).then(e=>{this.dispatchEvent(new CustomEvent("success",{detail:e})),a.resolve(e)},e=>{!1!==e&&this.dispatchEvent(new CustomEvent("fail",{detail:e})),a.reject(e)}),a.promise}reset(){this._reset()}_submitInternally(a,i){if(e.Utils.isNull(a))throw"Fetcher cannot be null while submitting a form.";var r=e.DeferPromise.defer();const s=this.entity,o=this.entityName;var n={};e.Utils.isNullOrEmpty(o)?n=s:n[o]=s;i={parameters:n,fields:this._getAllFields()};var l=new FormSubmitEvent(i);if(this.dispatchEvent(l),l.defaultPrevented)r.reject(!1);else{a.parameters=e.Utils.extend({},l.detail.parameters);const i=t=>{a.removeEventListener(e.Net.FetchSuccessEventName,i,!1),a.removeEventListener(e.Net.FetchErrorEventName,o,!1),"0"==t.detail.headers.get("Content-Length")&&(a.removeEventListener(e.Net.FetchResultEventName,s,!1),this.success=!0,r.resolve({}))},s=t=>{a.removeEventListener(e.Net.FetchResultEventName,s,!1);var i=t.detail;"object"==typeof i&&i.hasOwnProperty("success")?!0===i.success?(this.success=!0,r.resolve(i.result||{})):(this.fail=!0,r.reject(i.error)):(this.success=!0,r.resolve(i))},o=t=>{a.removeEventListener(e.Net.FetchSuccessEventName,i,!1),a.removeEventListener(e.Net.FetchResultEventName,s,!1),a.removeEventListener(e.Net.FetchErrorEventName,o,!1),this.fail=!0;const n=t.detail;r.reject(n.statusText)},n=t=>{switch(t.detail.propertyName){case"fetching":!0===t.detail.currentValue?e.Utils.addClass(this,e.PCSS+"-fetching"):(e.Utils.removeClass(this,e.PCSS+"-fetching"),a.removeEventListener(e.PropertyChangeEventName,n,!1))}};a.addEventListener(e.PropertyChangeEventName,n,!1),a.addEventListener(e.Net.FetchSuccessEventName,i,!1),a.addEventListener(e.Net.FetchResultEventName,s,!1),a.addEventListener(e.Net.FetchErrorEventName,o,!1),e.Utils.isNullOrEmpty(this.action)||(a.url=this.action),a instanceof t.PacemFetchElement&&!a.autofetch&&a.fetch(),this.success=this.fail=!1}return r.promise}_getAllFields(t={}){for(var a of(e.Utils.extend(t,this._fields),this._subForms))a._getAllFields(t);return t}setPristine(){for(var e in this._fields){var t=this._fields[e];t instanceof a.PacemModelElement&&t.setPristine()}for(var i of this._subForms)i.setPristine()}_checkFieldValidity(e){e in this._fields&&this._validateField(e,!1)}validate(t){e.Utils.isNullOrEmpty(t)?this._validateAllFields():this._checkFieldValidity(t)}_validateAllFields(e=!0){const t=[];for(let a in this._fields)t.push(this._validateField(a,e));for(let a of this._subForms)Array.prototype.push.apply(t,a._validateAllFields(e));return t}_validateField(t,a){var i=e.DeferPromise.defer(),r=this._fields[t];if(r){var s=this._validators[r.name];s&&s.length>0?(this.log(e.Logging.LogLevel.Log,`Computing "${r.name}" validity.`),Promise.all(s.map(e=>e.validate(r.value).then(t=>!(e.invalid=!t)))).then(t=>{let s=!0;for(var o of t)if(!1===o){s=!1,a&&r.setDirty();break}this.log(e.Logging.LogLevel.Log,`Property "${r.name}" turns out to be ${s?"":"not "}valid.`),i.resolve(r.valid=s)})):(this.log(e.Logging.LogLevel.Log,`Property "${r.name}" has no validators.`),i.resolve(r.valid=!0))}else this.log(e.Logging.LogLevel.Log,`Property "${t}" has no fields in this form.`),i.resolve(!0);return i.promise}_checkDirtyness(){let e=!1;for(var t in this._fields)if(!0===this._fields[t].dirty){e=!0;break}if(!1===e)for(var a of this._subForms)if(a.dirty){e=!0;break}this.dirty=e}_checkValidity(){let t=!0;for(var a in this._fields)if(this.log(e.Logging.LogLevel.Log,`Checking "${a}" validity.`),!1===this._fields[a].valid){this.log(e.Logging.LogLevel.Log,`"${a}" is not valid.`),t=!1;break}if(!0===t)for(var i of this._subForms)if(!i.valid){t=!1;break}this.valid=t}registerSubForm(t){let a=this._subForms;-1==a.indexOf(t)&&(t.addEventListener(e.PropertyChangeEventName,this._fieldPropertyChanged,!1),a.push(t),this._checkValidity(),this._checkDirtyness())}unregisterSubForm(t){let a=this._subForms,i=a.indexOf(t);i>=0&&(t.removeEventListener(e.PropertyChangeEventName,this._fieldPropertyChanged,!1),a.splice(i,1),this._checkValidity(),this._checkDirtyness())}registerField(t,a){var i=this._fields;i[t]!=a&&(this.unregisterField(t,!1),i[t]=a,this.log(e.Logging.LogLevel.Log,`Registering "${t}" field.`),a instanceof HTMLElement&&a.addEventListener(e.PropertyChangeEventName,this._fieldPropertyChanged,!1),this._checkFieldValidity(t),this._checkDirtyness())}unregisterField(t,a=!0){var i=this._fields,r=i[t];r instanceof HTMLElement&&r.removeEventListener(e.PropertyChangeEventName,this._fieldPropertyChanged,!1),delete i[t],r&&!0===a&&(this._checkValidity(),this._checkDirtyness())}registerValidator(t,a){var i=this._validators[t]=this._validators[t]||[];-1==i.indexOf(a)&&(i.push(a),a instanceof HTMLElement&&a.addEventListener(e.PropertyChangeEventName,this._validatorPropertyChanged,!1),this.log(e.Logging.LogLevel.Log,`Calling "${t}" validity check after validator registration.`),this._checkFieldValidity(t))}unregisterValidator(e,t){this._unregisterValidator(e,t,!0)}_unregisterValidator(t,a,i){var r=this._validators[t]=this._validators[t]||[],s=r.indexOf(a);s>=0&&(a instanceof HTMLElement&&a.removeEventListener(e.PropertyChangeEventName,this._validatorPropertyChanged,!1),r.splice(s,1),i&&this._checkFieldValidity(t))}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],r.prototype,"fetchCredentials",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],r.prototype,"fetchHeaders",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],r.prototype,"method",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],r.prototype,"submitCaption",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],r.prototype,"resetCaption",void 0),__decorate([e.Debounce(100)],r.prototype,"_buildUpForm",null),__decorate([e.Concurrent()],r.prototype,"validate",null),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.Boolean})],r.prototype,"valid",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.Boolean})],r.prototype,"dirty",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.Boolean})],r.prototype,"readonly",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],r.prototype,"success",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],r.prototype,"fail",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],r.prototype,"entity",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],r.prototype,"entityName",void 0),__decorate([e.Watch()],r.prototype,"metadata",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],r.prototype,"autogenerate",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],r.prototype,"suddenValidation",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],r.prototype,"resettable",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],r.prototype,"action",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-form"})],r),a.PacemFormElement=r}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){let i=class PacemChildFormPropagatorElement extends t.PacemEventTarget{propertyChangedCallback(e,t,a,i){super.propertyChangedCallback(e,t,a,i),("watch"===e||"property"===e||"model"===e&&a&&a.length>(t&&t.length||0))&&this._synchronize()}viewActivatedCallback(){super.viewActivatedCallback(),this._synchronize()}_synchronize(){const t=this.model,a=this.property,i=this.watch;if(!e.Utils.isNullOrEmpty(t)&&!e.Utils.isNullOrEmpty(a))if(e.Utils.isArray(t)){for(let e of t)e[a]=i;t.splice(t.length)}else t[a]=i,this.model=e.Utils.clone(t)}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"property",void 0),__decorate([e.Watch({emit:!1})],i.prototype,"watch",void 0),__decorate([e.Watch({emit:!1})],i.prototype,"model",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-childform-propagator"})],i),a.PacemChildFormPropagatorElement=i;let r=class PacemChildFormElement extends a.PacemBaseElement{constructor(){super(...arguments),this._model=[],this._subForms=[]}get inputFields(){return[]}toggleReadonlyView(e){}onChange(e){return new Promise((e,t)=>{var a=this._modelToEntity();e(this.value=a)})}acceptValue(e){this._entityToModel(e)}getViewValue(e){return""}convertValueAttributeToProperty(t){return e.PropertyConverters.Json.convert(t,this)}propertyChangedCallback(e,t,a,i){switch(super.propertyChangedCallback(e,t,a,i),e){case"mode":this._entityToModel()}}_dragStart(t){var a=t.detail;const i=e.Utils.offset(a.element),r=a.floater;r.style.width=i.width+"px",r.style.height=i.height+"px"}_dragEnd(e){"array"===this.mode&&this._triggerChange()}reset(){super.reset(),this._subForms.forEach(e=>{e.setPristine()})}_itemCreate(t){const a=t.detail.index,i=this._subForms;t.detail.dom[0].childNodes.forEach(t=>{t instanceof Element&&t.localName===e.P+"-form"&&i.splice(a,i.length-a,t)})}_itemChange(t,a){"entity"===a.detail.propertyName&&e.Utils.Json.stringify(this._model[t])!==e.Utils.Json.stringify(a.detail.currentValue)&&(this._model.splice(t,1,a.detail.currentValue),this._triggerChange())}_deleteAt(t){e.avoidHandler(t.srcEvent),"array"===this.mode?this._model.splice(t.detail,1):this._model.splice(0,this._model.length,{}),this._triggerChange()}_addItem(e){"array"===this.mode&&(this._model.push({}),this._triggerChange())}_triggerChange(){this.changeHandler(new Event("change"))}_entityToModel(t=this.value){switch(this.mode){case"array":let a=t||[];e.Utils.isArray(a)&&this._model.cloneFrom(a);break;default:const i=this._model,r=i.length;1===r&&i[0]===t||i.splice(0,r,t||{})}}_modelToEntity(t=this._model){switch(this.mode){case"array":return e.Utils.clone(t);default:return t&&t.length&&t[0]||null}}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],r.prototype,"fetchCredentials",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],r.prototype,"fetchHeaders",void 0),__decorate([e.ViewChild("."+e.PCSS+"-childform")],r.prototype,"_container",void 0),__decorate([e.ViewChild(e.P+"-drag-drop")],r.prototype,"_dragger",void 0),__decorate([e.ViewChild("."+e.PCSS+"-childform-item-floater")],r.prototype,"_floater",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],r.prototype,"mode",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],r.prototype,"lockItems",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],r.prototype,"metadata",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],r.prototype,"_model",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-childform",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-repeater datasource="{{ :host._model }}" on-itemdelete=":host._deleteAt($event)" on-${t.RepeaterItemCreateEventName}=":host._itemCreate($event)">\n    <div class="${e.PCSS}-childform">\n    <template>\n        <${e.P}-panel class="${e.PCSS}-childform-item" behaviors="{{ [::_dragger] }}">\n            <${e.P}-panel class="childform-item-handle ${e.PCSS}-margin margin-right-1" hide="{{ :host.lockItems || :host.readonly || :host.mode !== 'array' || !(:host._model && :host._model.length > 1) }}"><i class="${e.PCSS}-icon drag-handle">drag_handle</i></${e.P}-panel>\n            <${e.P}-panel class="childform-item-index text-small"><${e.P}-span hide="{{ !:host.readonly || :host.mode !== 'array' }}" class="${e.PCSS}-margin margin-right-1" text="{{ ^index+1 }}"></${e.P}-span></${e.P}-panel>\n            <${e.P}-form entity="{{ ^item }}" fetch-headers="{{ :host.fetchHeaders }}" fetch-credentials="{{ :host.fetchCredentials }}" on-${e.PropertyChangeEventName}=":host._itemChange(^index, $event)" readonly="{{ :host.readonly }}" metadata="{{ :host.metadata }}" autogenerate="true" logger="{{ :host.logger }}"></${e.P}-form>\n            <${e.P}-button tab-order="-1" class="flat circular circle-small clear ${e.PCSS}-margin margin-left-1" hide="{{ :host.lockItems || :host.readonly }}" command-name="delete" command-argument="{{ ^index }}"></${e.P}-button>\n        </${e.P}-panel>\n    </template>\n    </div>\n    <${e.P}-button tab-order="-1" class="flat circular circle-small add" hide="{{ :host.lockItems || :host.readonly || :host.mode !== 'array' }}" on-click=":host._addItem($event)"></${e.P}-button>\n</${e.P}-repeater>\n<div class="${e.PCSS}-childform-item-floater ${e.PCSS}-panel panel-border">\n    <div class="corner top-left"></div><div class="corner top-right"></div><div class="corner bottom-left"></div><div class="corner bottom-right"></div>\n</div>\n<${e.P}-drag-drop floater="{{ ::_floater }}" disabled="{{ :host.lockItems }}"\n    on-${e.UI.DragDropEventType.Start}=":host._dragStart($event)"\n    on-${e.UI.DragDropEventType.End}=":host._dragEnd($event)" \n    drop-behavior="${e.UI.DropBehavior.InsertChild}" mode="${e.UI.DragDataMode.Alias}" handle-selector=".drag-handle" drop-targets="{{ [::_container] }}"></${e.P}-drag-drop>`})],r),a.PacemChildFormElement=r}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){t.KNOWN_COMMANDS=["bold","italic","underline","hyperlink","orderedList","unorderedList"];const a={BOLD:t.KNOWN_COMMANDS[0],ITALIC:t.KNOWN_COMMANDS[1],UNDERLINE:t.KNOWN_COMMANDS[2],LINK:t.KNOWN_COMMANDS[3],ORDEREDLIST:t.KNOWN_COMMANDS[4],UNORDEREDLIST:t.KNOWN_COMMANDS[5]};class PacemExecCommand{getSurroundingNode(e,t){for(var a=e.anchorNode;a&&a.nodeName.toUpperCase()!==t.toUpperCase();)a=a.parentNode;return a}exec(e,t,i){return new Promise((r,s)=>{switch(e){case a.LINK:var o=document.getSelection(),n=this.getSurroundingNode(o,"A"),l="http://",d=/<a.*href=\"([^\"]*)/;if(n&&d.test(n.outerHTML)&&(l=d.exec(n.outerHTML)[1]),"current"===t)return"http://"==l?"":l;var c=t||void 0===t&&window.prompt("link (empty to unlink):",l);c?(document.execCommand("createLink",!1,c),(n=this.getSurroundingNode(o,"A"))&&n.setAttribute("target",i||"_blank")):document.execCommand("unlink"),r();break;case a.ORDEREDLIST:document.execCommand("insertOrderedList"),r();break;case a.UNORDEREDLIST:document.execCommand("insertUnorderedList"),r();break;default:document.execCommand(e),r()}})}}t.PacemExecCommand=PacemExecCommand;class ContentEditableChangeEvent extends e.CustomTypedEvent{constructor(e){super("contenteditablechange",{html:e})}}let i=class PacemContenteditableElement extends t.PacemBaseElement{constructor(t=new PacemExecCommand){super(),this._commands=t,this._checkChangedHandler=(e=>{var t=this._cleanup(this._container.innerHTML);"<br>"==t&&(t=""),t!=this.value&&this.changeHandler(new ContentEditableChangeEvent(t))}),this._keydownHandler=(t=>{const i=this._commands,r=a;if(t.ctrlKey){let a=!1;switch(t.keyCode){case 49:a=!0,i.exec(r.ORDEREDLIST);break;case 189:a=!0,i.exec(r.UNORDEREDLIST);break;case 72:a=!0,i.exec(r.LINK).then(()=>this.onChange())}a&&e.avoidHandler(t)}}),this._workspace=document.createElement("div")}convertValueAttributeToProperty(e){return e}toggleReadonlyView(e){this._repeater.hidden=e,e?this._container.removeAttribute("contenteditable"):this._container.setAttribute("contenteditable","")}get preventKeyboardSubmit(){return!0}get inputFields(){return[this._container]}onChange(t){var a=e.DeferPromise.defer();if(e.CustomEventUtils.isInstanceOf(t,ContentEditableChangeEvent)){const e=this.value=t.detail.html;a.resolve(e)}else a.resolve(this.value);return a.promise}_cleanup(e){const t=this._workspace;t.innerHTML=e;let a,i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1);for(;a=i.nextNode();)a instanceof Element&&a.removeAttribute("style");return t.innerHTML}acceptValue(t){e.Utils.isNull(this._container)||t==this._container.innerHTML||(this._container.innerHTML=t)}viewActivatedCallback(){super.viewActivatedCallback(),this._repeater.datasource=e.Components.Scaffolding.KNOWN_COMMANDS,this._container.addEventListener("blur",this._checkChangedHandler,!1),this._container.addEventListener("input",this._checkChangedHandler,!1),this._container.addEventListener("keydown",this._keydownHandler,!1)}disconnectedCallback(){e.Utils.isNull(this._container)||(this._container.removeEventListener("blur",this._checkChangedHandler,!1),this._container.removeEventListener("input",this._checkChangedHandler,!1),this._container.removeEventListener("keydown",this._keydownHandler,!1)),super.disconnectedCallback()}getViewValue(e){return e}};__decorate([e.ViewChild("div[pacem]")],i.prototype,"_container",void 0),__decorate([e.ViewChild(e.P+"-repeater")],i.prototype,"_repeater",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"minlength",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxlength",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-contenteditable",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<div class="${e.PCSS}-contenteditable ${e.PCSS}-viewfinder">\n    <div contenteditable pacem></div>\n</div>${t.CHAR_COUNTER_CHILD}\n<${e.P}-repeater>\n<div class="${e.PCSS}-commands">\n<template>\n    <${e.P}-button class="button ${e.PCSS}-command" css-class="{{ ['${e.PCSS}-'+ ^item.toLowerCase()] }}" on-click=":host._commands.exec(^item).then(() => :host.changeHandler($event))"></${e.P}-button>\n</template>\n</div>\n</${e.P}-repeater>`})],i),t.PacemContenteditableElement=i}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemDatetimePickerElement extends t.PacemBaseElement{constructor(){super(),this.precision="day",this._months=[],this._dates=[],this._a24=[],this._a60=[],this._years=[],this.hours="00",this.minutes="00",this.seconds="00"}get inputFields(){return[this._yearel,this._monthel,this._dateel,this._hourel,this._minel,this._secel]}toggleReadonlyView(e){this._allFields.hidden=e}convertValueAttributeToProperty(t){return e.PropertyConverters.Datetime.convert(t)}connectedCallback(){super.connectedCallback();const t=new Date;let a=this.year=t.getFullYear();this.min=new Date(a-100,0,1),this.max=new Date(a+10,11,31),this.month=t.getMonth();let i=[],r=[],s=[],o=e.Utils.leftPad;for(let t=0;t<12;t++){let r=new Date(a,t,1),s=r.toLocaleString(e.Utils.lang(this),{month:"short"});i.push({value:t,date:r,label:s})}this._months=i;for(let e=0;e<24;e++)r.push(o(e,2,"0"));this._a24=r;for(let e=0;e<60;e++)s.push(o(e,2,"0"));this._a60=s}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"dateValue":this.log(e.Logging.LogLevel.Log,`dateValue changed from ${a} to ${i}`),this._disassembleDate(i);break;case"min":case"max":e.Utils.isNullOrEmpty(this.min)||e.Utils.isNullOrEmpty(this.max)||this.setupYears();break;case"year":case"month":this._buildupDates();break;case"date":case"hours":case"minutes":case"seconds":this._buildup()}}acceptValue(t){this.dateValue=e.Utils.parseDate(t)}_disassembleDate(t){if(!t)return void(this.date=void 0);"string"==typeof t&&(t=e.Utils.parseDate(t));const a=t=>e.Utils.leftPad(t,2,"0");this.year=t.getFullYear(),this.month=t.getMonth(),this.date=t.getDate(),this.hours=a(t.getHours()),this.minutes=a(t.getMinutes()),this.seconds=a(t.getSeconds())}setupYears(){let t=[];const a=e.Utils.parseDate(this.min),i=e.Utils.parseDate(this.max);for(let e=a.getFullYear();e<=i.getFullYear();e++)t.push(e);this._years=t}onChange(e){return new Promise((e,t)=>{e(this.value=this._computeValue())})}_buildupDates(t){t&&t.stopPropagation();const a=this,i={weekday:"short",day:"numeric"},r=e=>{try{let t=+a.month;return new Date(+a.year,+a.month,e).getMonth()==t}catch(e){return!1}};var s=[];if(!e.Utils.isNullOrEmpty(a.year)&&!e.Utils.isNullOrEmpty(a.month)){let t=1;do{let r=new Date(+a.year,+a.month,t),o=r.toLocaleString(e.Utils.lang(this),i);s.push({value:t,date:r,label:o,disabled:r<this.min||r>this.max})}while(r(++t))}this._dates=s,r(+this.date)?this._buildup():this.date=""}_computeValue(){const t=this;if(e.Utils.isNullOrEmpty(t.year)||e.Utils.isNullOrEmpty(t.month)||e.Utils.isNullOrEmpty(t.date))return null;try{let e=new Date(+t.year,+t.month,+t.date);return e.setHours(+t.hours),e.setMinutes(+t.minutes),e.setSeconds(+t.seconds),e.setMilliseconds(0),Number.isNaN(e.valueOf())?null:e}catch(e){return null}}_buildup(e){e&&e.stopPropagation(),this.dateValue=this._computeValue()}getViewValue(t){const a=t;return a?e.Utils.core.date(a,"day"!=this.precision?"full":"short",e.Utils.lang(this)):""}};__decorate([e.ViewChild("."+e.PCSS+"-datetime-picker-year >       "+e.P+"-select")],a.prototype,"_yearel",void 0),__decorate([e.ViewChild("."+e.PCSS+"-datetime-picker-month >      "+e.P+"-select")],a.prototype,"_monthel",void 0),__decorate([e.ViewChild("."+e.PCSS+"-datetime-picker-date >       "+e.P+"-select")],a.prototype,"_dateel",void 0),__decorate([e.ViewChild("."+e.PCSS+"-datetime-picker-hours >      "+e.P+"-select")],a.prototype,"_hourel",void 0),__decorate([e.ViewChild("."+e.PCSS+"-datetime-picker-minutes >    "+e.P+"-select")],a.prototype,"_minel",void 0),__decorate([e.ViewChild("."+e.PCSS+"-datetime-picker-seconds >    "+e.P+"-select")],a.prototype,"_secel",void 0),__decorate([e.ViewChild(`div.${e.PCSS}-datetime-picker-fields`)],a.prototype,"_allFields",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Datetime})],a.prototype,"dateValue",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Datetime})],a.prototype,"min",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Datetime})],a.prototype,"max",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],a.prototype,"precision",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],a.prototype,"format",void 0),__decorate([e.Watch()],a.prototype,"_dates",void 0),__decorate([e.Watch()],a.prototype,"_years",void 0),__decorate([e.Watch()],a.prototype,"year",void 0),__decorate([e.Watch()],a.prototype,"month",void 0),__decorate([e.Watch()],a.prototype,"date",void 0),__decorate([e.Watch()],a.prototype,"hours",void 0),__decorate([e.Watch()],a.prototype,"minutes",void 0),__decorate([e.Watch()],a.prototype,"seconds",void 0),__decorate([e.Debounce(10)],a.prototype,"_buildup",null),a=__decorate([e.CustomElement({tagName:e.P+"-datetime-picker",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<div class="${e.PCSS}-datetime-picker">\n    <div class="${e.PCSS}-datetime-picker-fields ${e.PCSS}-viewfinder">\n\n    <div class="${e.PCSS}-datetime-picker-year">\n    <${e.P}-select value="{{ :host.year, twoway }}" placeholder="..." datasource="{{ :host._years }}">\n    </${e.P}-select></div>\n\n    <div class="${e.PCSS}-datetime-picker-month">\n    <${e.P}-select value="{{ :host.month, twoway }}" placeholder="..." value-property="value" text-property="label" datasource="{{ :host._months }}">\n    </${e.P}-select></div>\n\n    <div class="${e.PCSS}-datetime-picker-date">\n    <${e.P}-select value="{{ :host.date, twoway }}" placeholder="..." value-property="value" text-property="label" datasource="{{ :host._dates }}">\n    </${e.P}-select></div>\n\n    <${e.P}-panel class="${e.PCSS}-datetime-picker-hours" hide="{{ :host.precision === 'day' }}">\n    <${e.P}-select value="{{ :host.hours, twoway }}" datasource="{{ :host._a24 }}">\n    </${e.P}-select></${e.P}-panel>\n\n    <${e.P}-panel class="${e.PCSS}-datetime-picker-minutes" hide="{{ :host.precision === 'day' }}">\n    <${e.P}-select value="{{ :host.minutes, twoway }}" datasource="{{ :host._a60 }}">\n    </${e.P}-select></${e.P}-panel>\n\n    <${e.P}-panel class="${e.PCSS}-datetime-picker-seconds" hide="{{ :host.precision !== 'second' }}">\n    <${e.P}-select value="{{ :host.seconds, twoway }}" datasource="{{ :host._a60 }}">\n    </${e.P}-select></${e.P}-panel>\n\n    </div>\n    <${e.P}-panel hide="{{ Pacem.Utils.isNullOrEmpty(:host.dateValue) || :host.precision === 'day' || :host.readonly }}">\n    <dl class="${e.PCSS}-datetime-picker-preview">\n        <dt>local:</dt><dd><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></dd>\n        <dt>iso:</dt><dd><${e.P}-text text="{{ (:host.dateValue && :host.dateValue.toISOString()) || '' }}"></${e.P}-text></dd>\n    </dl>\n    </${e.P}-panel>\n    <${e.P}-span class="${e.PCSS}-readonly" css-class="{{ { 'date': :host.precision === 'day', 'datetime': :host.precision !== 'day' } }}" content="{{ :host.viewValue }}" hide="{{ !:host.readonly }}"></${e.P}-span>\n</div>`})],a),t.PacemDatetimePickerElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){function i(e){return new RegExp(e).source}let r=class PacemFormFieldElement extends t.PacemElement{constructor(t=new e.MarkdownService){super(),this._md=t,this._key="_"+e.Utils.uniqueCode(),this._entityPropertyChangeHandler=(t=>{this.dispatchEvent(new e.PropertyChangeEvent({propertyName:"entity",currentValue:this.entity}))})}get key(){return this._key}get fetcher(){return this._fetcher}get field(){return this._field}viewActivatedCallback(){super.viewActivatedCallback(),this._buildUpForm(),this._buildUpFetcher()}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"readonly":this._ensureBalloon();break;case"metadata":this._ensureBalloon(),this._buildUpLabel(),this._buildUpField();break;case"entity":a instanceof HTMLElement&&a.removeEventListener(e.PropertyChangeEventName,this._entityPropertyChangeHandler,!1),i instanceof HTMLElement&&i.addEventListener(e.PropertyChangeEventName,this._entityPropertyChangeHandler,!1)}}disconnectedCallback(){this.entity instanceof HTMLElement&&this.entity.removeEventListener(e.PropertyChangeEventName,this._entityPropertyChangeHandler,!1),e.Utils.isNull(this._balloon)||this._balloon.remove(),super.disconnectedCallback()}_ensureBalloon(){var a,i;const r=this.readonly||e.Utils.isNullOrEmpty(i=this.metadata&&this.metadata.extra&&this.metadata.extra.tooltip||!1)||!0!==i&&"html"!==i&&"md"!==i&&"markdown"!==i||e.Utils.isNullOrEmpty(a=this.metadata&&this.metadata.display&&this.metadata.display.description);if(e.Utils.isNull(this._balloon)&&!r){let a=document.createElement(e.P+"-balloon");a.options={behavior:t.UI.BalloonBehavior.Tooltip,position:t.UI.BalloonPosition.Top,hoverDelay:200,hoverTimeout:50,align:t.UI.BalloonAlignment.Auto},e.Utils.addClass(a,e.PCSS+"-field-tooltip"),e.CustomElementUtils.findAncestorShell(this).appendChild(this._balloon=a)}const s=this._balloon;if(!e.Utils.isNull(s)){s.target=this.label,s.disabled=r;const e=a||"";switch(i){case"md":case"markdown":s.innerHTML=this._md.toHtml(e);break;case"html":s.innerHTML=e;break;default:s.innerText=e}}}_buildUpLabel(){var t=this.label;let a=this.metadata;t.htmlFor=this._key,e.Utils.addClass(t,e.PCSS+"-label");const i=this.metadata.validators;i&&i.find(e=>"required"===e.type)?e.Utils.addClass(t,e.PCSS+"-required"):e.Utils.removeClass(t,e.PCSS+"-required"),e.Utils.isNull(this._balloon)||this._balloon.disabled?e.Utils.removeClass(t,e.PCSS+"-tooltip"):e.Utils.addClass(t,e.PCSS+"-tooltip"),t.textContent=a.display&&a.display.name||a.prop,t.setAttribute("id","label"+this._key)}_isValueNullOrEmpty(t=this.entity,a=this.metadata){return e.Utils.isNullOrEmpty(t&&a&&t[a.prop])}_handleValueChange(t){if("value"===t.detail.propertyName){const a=t.detail.currentValue,i=this.metadata.prop;if(this.entity instanceof HTMLElement){let t=e.CustomElementUtils.camelToKebab(i);e.Utils.isNullOrEmpty(a)?this.entity.removeAttribute(t):this.entity.setAttribute(t,a.toString())}else this.entity[i]=a}}_buildUpFetcher(){this._fetcher.setAttribute("id","fetch"+this._key)}_buildUpForm(){this._form.setAttribute("id","form"+this._key)}_buildUpField(){this._field&&this._field.remove(),this._fetcher.removeAttribute("parameters"),this._fetcher.result=this._fetcher.url=null;for(var t=this._validators.children.length-1;t>=0;t--)this._validators.children[t].remove();var a=this.metadata;let r=e.P+"-input-text",s=e.P+(a.display&&"slider"===a.display.ui?"-slider":"-input-number"),o={id:this._key,name:a.prop,readonly:"{{ :host.readonly || :host.metadata.isReadOnly || ::_form.readonly }}",value:`{{ :host.entity.${a.prop}, twoway }}`,placeholder:`${a.display&&a.display.watermark||""}`},n=a.extra,l={},d="false",c="",h="",p="",u=[];if(!e.Utils.isNullOrEmpty(n&&n.dependsOn)){u=n.dependsOn;let t={empty:[],notEqual:{}},a={empty:[],notEqual:{}},i=[],r=[];for(var m of u){let s=":host.entity."+m.prop,o="$this.entity."+m.prop;if(e.Utils.isNullOrEmpty(m.value)){let e=e=>"Pacem.Utils.isNullOrEmpty("+e+")";t.empty.push(e(s)),m.hide&&a.empty.push(e(o))}else{let e=e=>e+" !== "+JSON.stringify(m.value);(t.notEqual[s]=t.notEqual[s]||[]).push(e(s)),m.hide&&(a.notEqual[o]=a.notEqual[o]||[]).push(e(o))}r.push(s),i.push(`${m.alias||m.prop} : ${s}`),c+=s+" && "}p=i.join(", ");let s=t=>{let a="false",i="false";if(!e.Utils.isNullOrEmpty(t.notEqual)){const e=[];for(let a in t.notEqual)e.push("("+t.notEqual[a].join(" && ")+")");a="("+e.join(" || ")+")"}return e.Utils.isNullOrEmpty(t.empty)||(i="("+t.empty.join(" || ")+")"),a+" || "+i};h=s(t),d=`{{ ${h} }}`,this.setAttribute("hide",`{{ ${s(a)} }}`)}const v=this.fn=this.fn||{};if("function"==typeof a.type){var _=a.type(this,":host",":host.entity");r=_.tagName,e.Utils.extend(o,_.attrs||{})}else switch(a.display&&a.display.ui){case"contentEditable":console.warn("`contentEditable` ui hint is deprecated. Lean on `dataType` equal to 'HTML' instead."),r=e.P+"-contenteditable";break;case"snapshot":r=e.P+"-thumbnail";o.width=""+a.extra.width,o.height=""+a.extra.height,o.mode="string"===a.type.toLowerCase()?"string":"binary";break;case"oneToMany":if(r=e.P+"-select",o["on-wheel"]="$event.preventDefault()",e.Utils.isNullOrEmpty(n.textProperty)||(o["text-property"]=n.textProperty),e.Utils.isNullOrEmpty(n.disabledProperty)||(o["disabled-property"]=n.disabledProperty),e.Utils.isNullOrEmpty(n.valueProperty)||(a.isComplexType?o["compare-by"]=n.valueProperty:o["value-property"]=n.valueProperty),e.Utils.isNullOrEmpty(n.source))this._fetcher.id=`fetch${this._key}`,this._fetcher.url=n.sourceUrl,this._fetcher.method=n.verb,l.parameters=`{{ { ${p} } }}`,l.disabled=d,o.datasource=`{{ ${c}Pacem.Utils.getApiResult(#fetch${this._key}.result) }}`;else{let t=(u||[]).map(e=>":host.entity."+e.prop).join(", ");const a="fn"+e.Utils.uniqueCode();switch(typeof n.source){case"function":v[a]=n.source;break;default:if(!e.Utils.isArray(n.source))throw"Unsupported source format.";v[a]=(()=>n.source)}o.datasource=`{{ :host.fn.${a}(${t}) }}`}break;case"manyToMany":r=e.P+"-checkbox-list",delete o.placeholder,o.datasource=`{{ Pacem.Utils.getApiResult(#fetch${this._key}.result) }}`,e.Utils.isNullOrEmpty(n.textProperty)||(o["text-property"]=n.textProperty),e.Utils.isNullOrEmpty(n.disabledProperty)||(o["disabled-property"]=n.disabledProperty),e.Utils.isNullOrEmpty(n.valueProperty)||(o["compare-by"]=n.valueProperty),this._fetcher.id=`fetch${this._key}`,this._fetcher.url=n.sourceUrl,this._fetcher.method=n.verb;break;case"suggest":case"tags":case"autocomplete":const t="tags"===a.display.ui;r=e.P+(t?"-tags":"-suggest"),this._fetcher.id=`fetch${this._key}`,e.Utils.isNullOrEmpty(n.textProperty)||(o["text-property"]=n.textProperty);let i=`#${this._key}.value`;e.Utils.isNullOrEmpty(n.valueProperty)||(o["compare-by"]=n.valueProperty,t?i=`(${i} && ${i}.${n.valueProperty}) || ''`:o["value-property"]=n.valueProperty),e.Utils.isNullOrEmpty(n.sourceUrl)||(l.url=`${n.sourceUrl}`,this._fetcher.method=n.verb,e.Utils.isNullOrEmpty(n.dependsOn)?l.parameters=`{{ {q: #${this._key}.hint || '', ${n.valueProperty||"value"}: ${i} || '' } }}`:(l.parameters=`{{ { ${p}, q: #${this._key}.hint || '', ${n.valueProperty||"value"}: ${i} || '' } }}`,l.disabled=d),o.datasource=`{{ ${c}Pacem.Utils.getApiResult(#fetch${this._key}.result) }}`),"tags"===a.display.ui&&(o["allow-new"]=(!0===a.extra.allowNew).toString(),o["allow-duplicates"]=(!0===a.extra.allowDuplicates).toString());break;case"switcher":if("boolean"!==(a.type||"").toLowerCase())break;o.class="checkbox-switch";default:let h=(a.dataType||a.type||"").toLowerCase();switch(h){case"imageurl":r=e.P+"-input-image";const t=this._fetcher.id=`fetch${this._key}`;o["image-set"]=`{{ Pacem.Utils.getApiResult(#${t}.result) }}`,o["on-imagefetchrequest"]=`#${t}.url = '${a.extra.fetchUrl}'; #${t}.parameters = { q: $event.detail.hint, skip: $event.detail.skip, take: $event.detail.take }`,o["max-width"]=""+a.extra.width,o["max-height"]=""+a.extra.height,o["max-thumbnail-height"]=""+a.extra.thumbHeight,o["max-thumbnail-width"]=""+a.extra.thumbWidth,o["upload-url"]=a.extra.uploadUrl,o["allow-snapshot"]=""+a.extra.snapshot;break;case"upload":r=e.P+"-upload";let i=a.extra||{};o.url=i.uploadUrl,o.parallelism=""+i.parallelism,o["chunk-size"]=""+i.chunkSize,o["max-image-width"]=""+i.maxImageWidth,o["max-image-height"]=""+i.maxImageHeight;break;case"html":r=e.P+"-contenteditable";break;case"enumeration":r=e.P+"-radio-list",o.class=e.PCSS+"-radio-list",o["value-property"]="value",o["text-property"]="caption",o.datasource="{{ "+JSON.stringify(a.extra.enum)+" }}",delete o.placeholder;break;case"password":r=e.P+"-input-password";break;case"emailaddress":r=e.P+"-input-email";break;case"color":r=e.P+"-input-color";break;case"time":r=e.P+"-datetime-picker";break;case"datetime":r=e.P+"-datetime-picker",delete o.placeholder,o.precision="minute";break;case"date":r=e.P+"-datetime-picker",delete o.placeholder;break;case"url":r=e.P+"-input-url";break;case"phonenumber":r=e.P+"-input-tel";break;case"multilinetext":r=e.P+"-textarea";break;case"markdown":r=e.P+"-textarea-markdown";break;case"latlng":r=e.P+"-latlng",e.Utils.isNullOrEmpty(a.extra)||"object"!=typeof a.extra||e.Utils.isArray(a.extra)||(o.options=JSON.stringify(a.extra));break;case"percent":case"percentage":case"currency":let l="currency"===h?{style:"currency",currency:"EUR"}:{style:"percent",maximumFractionDigits:2},d=Object.assign(l,a.extra);o.format=JSON.stringify(d);default:switch((a.type||"").toLowerCase()){case"boolean":r=e.P+"-checkbox",o["true-value"]="{{ true }}",o["false-value"]="{{ false }}",o.caption=o.placeholder,delete o.placeholder;break;case"byte":o.min="0",o.max="255";case"int16":case"int32":case"int64":case"short":case"integer":case"int":case"long":o.step="1",r=s;break;case"double":case"decimal":case"float":case"single":case"number":r=s,o.step=""+(a.extra&&a.extra.step||"any");break;default:if(("array"===a.type||"object"===a.type)&&!e.Utils.isNullOrEmpty(a.props)){if(r=e.P+"-childform",delete o.placeholder,o.metadata=e.Utils.Json.stringify(a.props,{functions:e.JsonFunctionConversion.Reference}),o.mode=a.type,o["lock-items"]=""+(a.extra&&a.extra.lockItems||!1),o.logger="{{ :host.logger }}",!e.Utils.isNullOrEmpty(n&&n.dependsOn)){var y="";for(let t of u)y+=`<${e.P}-childform-propagator model="${o.value}" watch="{{ :host.entity.${t.prop} }}" property="${t.alias||t.prop}"></${e.P}-childform-propagator>\n`;this._container.innerHTML=y}o["fetch-credentials"]="{{ :host.fetchCredentials }}",o["fetch-headers"]="{{ :host.fetchHeaders }}"}}}}if(!e.Utils.isNullOrEmpty(a.commands)){e.Utils.addClass(this._container,e.PCSS+"-fieldgroup");const t=this._container.appendChild(document.createElement("div")),i=this._container.appendChild(document.createElement("div"));e.Utils.addClass(t,`fieldgroup-prepend ${e.PCSS}-buttonset buttons`),e.Utils.addClass(i,`fieldgroup-append ${e.PCSS}-buttonset buttons`);const r=h||"false";a.commands.forEach(s=>{const o=document.createElement(e.P+"-button");o.setAttribute("icon-glyph",s.icon),o.setAttribute("command-name",s.name),s.dependsOnValue?(o.setAttribute("disabled",`{{ (${r}) || !::_form.valid || Pacem.Utils.isNullOrEmpty(:host.entity.${a.prop}) }}`),o.setAttribute("command-argument",`{{ :host.entity.${a.prop} }}`)):o.setAttribute("disabled",d),o.setAttribute("tooltip",s.tooltip),e.Utils.isNullOrEmpty(s.cssClass)||e.Utils.addClass(o,s.cssClass.join(" ")),(s.prepend?t:i).appendChild(o)})}e.Utils.isNullOrEmpty(a.validators)||a.validators.forEach(t=>{var s,n=t;switch(n.type){case"required":o.required="true",s=document.createElement(e.P+"-required-validator");break;case"length":let t=document.createElement(e.P+"-length-validator");s=t;let l=n.params&&n.params.max,d=n.params&&n.params.min;null!=l&&(o.maxlength=""+(t.max=l)),null!=d&&(o.minlength=""+(t.min=d));break;case"range":let c=document.createElement(e.P+"-range-validator");s=c;let h=n.params&&n.params.max,p=n.params&&n.params.min,u=r===e.P+"-datetime-picker";null!=h&&(c.max=h,o.max="{{ "+(u?"'"+h+"'":h)+" }}"),null!=p&&(c.min=p,o.min="{{ "+(u?"'"+p+"'":p)+" }}");break;case"email":let m=document.createElement(e.P+"-regex-validator");s=m,o.pattern=i(m.pattern="[\\w\\.-]+@[\\w\\.-]+\\.[a-zA-Z0-9]{2,6}");break;case"regex":let v=document.createElement(e.P+"-regex-validator");s=v;let _=n.params.pattern;o.pattern=i(_),v.pattern=_;break;case"binary":let y=document.createElement(e.P+"-binary-validator");s=y;let g=n.params.pattern;null!=g&&(o.pattern=i(g),y.pattern=g);let P=n.params&&n.params.maxSize;null!=P&&(y.maxSize=P,o["max-size"]=""+P);break;case"compare":let f=document.createElement(e.P+"-compare-validator");s=f;let C="";C="value"in n.params?`{{ ${n.params.value} }}`:`{{ :host.entity.${n.params.to} }}`,f.setAttribute("to",C);let b=f.operator=n.params.operator||"equal";if(r===e.P+"-datetime-picker")switch(b){case"lessOrEqual":case"less":o.max=C;break;case"greaterOrEqual":case"greater":o.min=C}break;case"async":let E=document.createElement(e.P+"-async-validator");s=E,E.url=n.params.url;let S=[],$=n.params.dependsOn;S.push(`${a.prop} : :host.entity.${a.prop}`);for(let e of $||[])S.push(`${e.alias||e.prop} : :host.entity.${e.prop}`);E.setAttribute("parameters",`{{ { ${S.join(", ")} } }}`),E.method=n.params.verb||e.Net.HttpMethod.Get,E.setAttribute("fetch-credentials","{{ :host.fetchCredentials }}"),E.setAttribute("fetch-headers","{{ :host.fetchHeaders }}")}if(e.Utils.isNull(s))throw`Cannot generate a formfield validator based on type: ${n.type}.`;s.watch=a.prop,s.setAttribute("hide","{{ !this.invalid }}"),s.setAttribute("disabled",d),s.errorMessage=n.errorMessage,this._validators.appendChild(s)});let g=document.createElement(r);for(var P in o){let t;e.Utils.isNullOrEmpty(t=o[P])||g.setAttribute(P,t)}for(var P in this._field=g,this._container.insertBefore(g,this._container.firstElementChild),l){let t;e.Utils.isNullOrEmpty(t=l[P])||this._fetcher.setAttribute(P,t)}this.dispatchEvent(new e.PropertyChangeEvent({propertyName:"field",currentValue:g}))}};__decorate([e.ViewChild("label")],r.prototype,"label",void 0),__decorate([e.ViewChild(`div.${e.PCSS}-input-container`)],r.prototype,"_container",void 0),__decorate([e.ViewChild(e.P+"-fetch")],r.prototype,"_fetcher",void 0),__decorate([e.ViewChild(e.P+"-form")],r.prototype,"_form",void 0),__decorate([e.ViewChild(e.P+"-panel."+e.PCSS+"-validators")],r.prototype,"_validators",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],r.prototype,"metadata",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],r.prototype,"fetchHeaders",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],r.prototype,"fetchCredentials",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],r.prototype,"readonly",void 0),__decorate([e.Watch()],r.prototype,"entity",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-form-field",template:`<${e.P}-form class="${e.PCSS}-field" logger="{{ :host.logger }}" \ncss-class="{{ {'${e.PCSS}-fetching': ::_fetcher.fetching, '${e.PCSS}-dirty': this.dirty, '${e.PCSS}-invalid': !this.valid, '${e.PCSS}-editable': !:host.readonly, '${e.PCSS}-readonly': :host.readonly, '${e.PCSS}-pristine': !this.dirty, '${e.PCSS}-valid': this.valid, '${e.PCSS}-has-value': !:host._isValueNullOrEmpty(:host.entity, :host.metadata) } }}">\n    <label class="${e.PCSS}-label"></label>\n    <div class="${e.PCSS}-input-container"></div>\n    <${e.P}-fetch debounce="50" logger="{{ :host.logger }}" credentials="{{ :host.fetchCredentials }}" headers="{{ :host.fetchHeaders }}" diff-by-values="true"></${e.P}-fetch>\n    <${e.P}-panel class="${e.PCSS}-validators" hide="{{ ::_form.valid || !::_form.dirty || :host.readonly }}"></${e.P}-panel>\n</${e.P}-form>`})],r),a.PacemFormFieldElement=r}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a;!function(e){e.Input="input",e.Blur="blur"}(a=t.ChangePolicy||(t.ChangePolicy={}));class PacemBaseInputElement extends t.PacemBaseElement{constructor(){super(...arguments),this.debounce=!1,this.changePolicy=a.Input,this._focusHandler=(t=>{this.autoselect&&!e.Utils.isNull(this.inputField)&&this.inputField.select()})}propertyChangedCallback(e,t,a,i){switch(super.propertyChangedCallback(e,t,a,i),e){case"placeholder":this.inputField&&this.inputField.setAttribute(e,a)}}acceptValue(t){this.inputField&&t!==this.inputField.value&&(this.inputField.value=e.Utils.isNullOrEmpty(t)?"":t)}get inputField(){return this.inputFields[0]}onChange(t){var i=e.DeferPromise.defer();if("input"===t.type&&this.changePolicy===a.Blur)i.resolve(this.value);else{const e=()=>{const e=this.getValue(this.inputField.value);e!==this.value&&(this.value=e),i.resolve(e)},t=this.debounce;"number"==typeof t&&t>0?(clearTimeout(this._handle),this._handle=setTimeout(e,t)):!0===t?(cancelAnimationFrame(this._handle),this._handle=requestAnimationFrame(e)):requestAnimationFrame(e)}return i.promise}viewActivatedCallback(){super.viewActivatedCallback();let e=this.inputField;e.size=1,e.autocomplete="off",e.addEventListener("input",this.changeHandler,!1),e.addEventListener("focus",this._focusHandler,!1)}disconnectedCallback(){let t=this.inputField;e.Utils.isNull(t)||(t.removeEventListener("focus",this._focusHandler,!1),t.removeEventListener("input",this.changeHandler,!1)),super.disconnectedCallback()}}__decorate([e.Watch({emit:!1,converter:{convert:e=>{switch(e){case"true":return!0;case"false":return!1;default:return parseFloat(e)}},convertBack:e=>e.toString()}})],PacemBaseInputElement.prototype,"debounce",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],PacemBaseInputElement.prototype,"changePolicy",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],PacemBaseInputElement.prototype,"autoselect",void 0),t.PacemBaseInputElement=PacemBaseInputElement;class PacemOrdinalInputElement extends PacemBaseInputElement{convertValueAttributeToProperty(e){return parseFloat(e)}propertyChangedCallback(e,t,a,i){switch(super.propertyChangedCallback(e,t,a,i),e){case"min":case"max":case"step":null!=a?this.inputField.setAttribute(e,a):this.inputField.removeAttribute(e)}}}__decorate([e.Watch({converter:e.PropertyConverters.Number})],PacemOrdinalInputElement.prototype,"min",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],PacemOrdinalInputElement.prototype,"max",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],PacemOrdinalInputElement.prototype,"step",void 0),t.PacemOrdinalInputElement=PacemOrdinalInputElement;class PacemTextualInputElement extends PacemBaseInputElement{convertValueAttributeToProperty(e){return e}propertyChangedCallback(e,t,a,i){switch(super.propertyChangedCallback(e,t,a,i),e){case"pattern":case"maxlength":case"minlength":null!=a?this.inputField.setAttribute(e,a):this.inputField.removeAttribute(e)}}getValue(e){return e}getViewValue(e){return e}}__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemTextualInputElement.prototype,"pattern",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],PacemTextualInputElement.prototype,"minlength",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],PacemTextualInputElement.prototype,"maxlength",void 0),t.PacemTextualInputElement=PacemTextualInputElement}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemColorInputElement extends t.PacemBaseElement{constructor(){super()}acceptValue(e){const t=this._parseValue(e);null!=t&&(this._tint.value=t.tint,this._alpha.value=t.alpha.toString())}convertValueAttributeToProperty(e){return e}onChange(t){const a=this._alpha.valueAsNumber||parseInt(this._alpha.value),i=this._tint.value,r=this.value=this._getValue(i,a);return e.Utils.fromResult(r)}toggleReadonlyView(e){this._wrapper.hidden=e,this._span.hidden=!e}_getValue(e,t){if(isNaN(t)||100===t)return e;return`rgba(${parseInt(e.substr(1,2),16)},${parseInt(e.substr(3,2),16)},${parseInt(e.substr(5,2),16)},${.01*t})`}_parseValue(t){var a;if(null!=(a=/^rgba?\(([\d,\s\.]+)\)$/.exec(t))){let t=a[1].split(",");if(t.length>=3){const a=t=>e.Utils.leftPad(parseInt(t).toString(16),2,"0"),i=a(t[0]),r=a(t[1]),s=a(t[2]),o=t.length>3?parseFloat(t[3]):1;return{tint:"#"+i+r+s,alpha:Math.round(100*Math.max(0,Math.min(1,isNaN(o)?1:o)))}}}else if(!0===/^#[0-9a-fA-F]{3,6}/.test(t)){let e=t.substr(1);return 3===e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),{tint:"#"+e,alpha:100}}return null}getViewValue(e){return e}get inputFields(){return[this._tint,this._alpha]}};__decorate([e.ViewChild("input[type=color]")],a.prototype,"_tint",void 0),__decorate([e.ViewChild("input[type=number]")],a.prototype,"_alpha",void 0),__decorate([e.ViewChild(`.${e.PCSS}-viewfinder`)],a.prototype,"_wrapper",void 0),__decorate([e.ViewChild(`.${e.PCSS}-readonly`)],a.prototype,"_span",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-color",template:`<div class="${e.PCSS}-viewfinder">\n<${e.P}-panel class="${e.PCSS}-input-color" css="{{ { 'background-color': :host.viewValue } }}"><input type="color" class="${e.PCSS}-input" /></${e.P}-panel>\n<input class="${e.PCSS}-input" type="number" min="0" max="100" step="1" value="100" />\n</div>\n<${e.P}-span class="${e.PCSS}-readonly" css="{{ { 'background-color': :host.viewValue } }}"></${e.P}-span>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemColorInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemEmailInputElement extends t.PacemTextualInputElement{constructor(){super()}toggleReadonlyView(e){this.input.hidden=e,this.anchor.hidden=!e}get inputFields(){return[this.input]}};__decorate([e.ViewChild("input[type=email]")],a.prototype,"input",void 0),__decorate([e.ViewChild(e.P+"-a")],a.prototype,"anchor",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-email",template:`<input type="email" class="${e.PCSS}-input ${e.PCSS}-viewfinder" />${t.CHAR_COUNTER_CHILD}<${e.P}-a class="${e.PCSS}-readonly" disabled="{{ $pacem.isNullOrEmpty(:host.value) }}" href="{{ 'mailto:'+ :host.value }}"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></${e.P}-a>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemEmailInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){t.FileUploadEventName="fileupload";class FileUploadEvent extends e.CustomTypedEvent{constructor(e){super(t.FileUploadEventName,e)}}t.FileUploadEvent=FileUploadEvent;let a=class PacemUploadElement extends t.PacemBaseElement{constructor(t=new e.Animations.TweenService){super(),this._tweener=t,this.undoCaption="undo",this.retryCaption="retry",this.uploading=!1,this.size=0,this.percentage=0,this.complete=!1,this.failed=!1,this.invalidFile=!1,this._fields={parallelism:3,uid:"",ongoing:0,enqueuer:null,blob:null,retryFrom:0,chunkSize:131072,undone:!1}}convertValueAttributeToProperty(e){return e}acceptValue(e){this.percentage=0,this.uploading=!1,this._fileupload.value=""}_getMimeIcon(t=this.value,a=this.uploading){if(a)return"sync";var i=t;if(e.Utils.isNullOrEmpty(t))return"file_upload";"object"==typeof t&&(i=t.name);const r=/\.([\w]+)(\s|$)/.exec(i);if(r&&r.length)switch(r[1].toLowerCase()){case"pdf":return"picture_as_pdf";case"jpg":case"jpeg":case"gif":case"png":return"filter"}return"filter_none"}get blob(){return this._fields.blob}get inputFields(){return[this._fileupload]}getViewValue(t){const a=this._localValue||t;return e.Utils.isNullOrEmpty(a)||"object"!=typeof a?a:`${a.name}\n(${e.Utils.core.size(a.size)})`}toggleReadonlyView(e){this._fileupload.hidden=e}viewActivatedCallback(){super.viewActivatedCallback(),this._fileupload.addEventListener("click",e.stopPropagationHandler,!1)}disconnectedCallback(){this._fileupload&&this._fileupload.removeEventListener("click",e.stopPropagationHandler,!1),super.disconnectedCallback()}_dispatchDownload(t){e.avoidHandler(t);const a=this._localValue||this.value,i=e=>{this.dispatchEvent(new CustomEvent("download",{detail:e,bubbles:!0,cancelable:!1}))};e.Utils.isNullOrEmpty(a)||("string"==typeof a?i(a):e.Utils.isNullOrEmpty(a.content)?i(a.name):e.Utils.download(e.Utils.dataURLToBlob("data:application/download;base64,"+a.content),a.name,a.type))}reset(){super.reset(),this._localValue=null,this.invalidFile=!1}_validate(e=this._fileupload.files[0],t){e instanceof File&&(t=e.name),t=t.substr(t.lastIndexOf("\\")+1);const a=this.maxSize;if(a>0&&a<e.size)return this.invalidFile=!0,!1;const i=this.pattern;return i&&!new RegExp(i,"i").test(t)?(this.invalidFile=!0,!1):(this.invalidFile=!1,!0)}upload(e,t,a){if(this._validate(e,t))return this._upload(e,t,a)}_upload(e,t,a){return __awaiter(this,void 0,void 0,function*(){var i=this._fields;if(!e)return;!t&&e instanceof File&&(t=e.name),this.failed=!1,i.undone=!1,i.ongoing=0;const r=e,s=this.size=r.size;t=t.substr(t.lastIndexOf("\\")+1),this.percentage=0,this.complete=!1;var o={filename:t,length:s,action:"start",state:a};this.uploading=!0;try{var n=yield this._fetch(o);if(n.ok){var l=yield n.json();i.retryFrom=0,i.blob=r,i.uid=l.uid,this._manage()}else this.uploading=!1;return n}catch(e){this.uploading=!1}})}_blobToBase64(t){return __awaiter(this,void 0,void 0,function*(){const a=yield e.Utils.blobToDataURL(t);return a.substr(a.indexOf("base64,")+7)})}_doUpload(e,t){return __awaiter(this,void 0,void 0,function*(){var a=this._fields;a.ongoing++;var i={chunk:yield this._blobToBase64(e),uid:a.uid,position:t,action:"do"};try{const e=yield this._fetch(i);if(e.ok){if(a.ongoing--,a.undone)return;const t=yield e.json();t.percentage>this.percentage&&(yield this._tweenPercentage(Math.round(Math.max(1,t.percentage)),200)),this.complete!=t.complete&&(this.complete=t.complete,!0===this.complete&&(this.uploading=!1,this.changeHandler(new FileUploadEvent(t))))}else a.retryFrom=t,this.failed=!0,this.uploading=!1}catch(e){a.retryFrom=t,this.failed=!0,this.uploading=!1}})}_manage(){const e=this._fields,t=this.size,a=e.blob,i=this.chunkSize||e.chunkSize;var r=e.retryFrom,s=r+i;e.enqueuer=setInterval(()=>{if(r<t&&!this.failed){const t=this.parallelism||e.parallelism;if(e.ongoing>=t)return;this._doUpload(a.slice(r,s),r),s=(r=s)+i}else{this._fileupload.value="",window.clearInterval(e.enqueuer)}},100)}_buildLocalValue(t,a=t.name,i=t){return __awaiter(this,void 0,void 0,function*(){return this._localValue={name:a,size:t.size,type:t.type,lastModified:e.Utils.parseDate(t.lastModified).toISOString(),content:yield this._blobToBase64(i)}})}onChange(t){return new Promise((a,i)=>__awaiter(this,void 0,void 0,function*(){if(e.CustomEventUtils.isInstanceOf(t,FileUploadEvent)){const e=this.value=t.detail.filename;this.dispatchEvent(t),a(e)}else{let t=this,o=t._fileupload;var i=o.files[0],r=i.name,s=i;this._validate(i)||e.Utils.isNullOrEmpty(this.url)?(/\.(jpe?g|png)$/i.test(r)&&this.maxImageWidth>0&&this.maxImageHeight>0&&(s=yield e.Utils.resizeImage(s,this.maxImageWidth,this.maxImageHeight,.6)),yield this._buildLocalValue(i,r,s),e.Utils.isNullOrEmpty(this.url)?(this.uploading=!0,e.Utils.isNullOrEmpty(this.value)?yield e.Utils.idle(250):(this.percentage=0,yield e.Utils.waitForAnimationEnd(this._tuner)),yield this._tweener.run(0,100,500,0,e.Animations.Easings.sineInOut,(e,t)=>{this.percentage=t}),this.percentage=0,this.uploading=!1,a(this.value=this._localValue)):(t._upload(s,o.value),a(this.value))):a(this.value=yield this._buildLocalValue(i))}}))}_fetch(t){return fetch(this.url,{method:"POST",credentials:this.fetchCredentials,headers:e.Utils.extend({Accept:"application/json","Content-Type":"application/json"},this.fetchHeaders||{}),body:JSON.stringify(t)})}_undo(e){return __awaiter(this,void 0,void 0,function*(){e.preventDefault(),e.stopPropagation();var t=this._fields,a=this._fileupload;clearInterval(t.enqueuer);var i={action:"undo",uid:t.uid};try{var r=yield this._fetch(i);return r.ok&&(t.undone=!0,this.size=0,this._tweenPercentage(0,300)),r}catch(e){}finally{return a.value="",this.uploading=!1,r}})}_tweenPercentage(t,a=500){const i=this.percentage;return this._tweener.run(i,t,a,0,e.Animations.Easings.sineInOut,(e,t)=>{this.percentage=t})}_retry(e){e.preventDefault(),e.stopPropagation(),this.failed=!1,this._manage()}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],a.prototype,"fetchCredentials",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],a.prototype,"fetchHeaders",void 0),__decorate([e.ViewChild("input[type=file]")],a.prototype,"_fileupload",void 0),__decorate([e.ViewChild(`${e.P}-tuner`)],a.prototype,"_tuner",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],a.prototype,"undoCaption",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],a.prototype,"retryCaption",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],a.prototype,"pattern",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],a.prototype,"url",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],a.prototype,"maxImageWidth",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],a.prototype,"parallelism",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],a.prototype,"chunkSize",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],a.prototype,"maxImageHeight",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],a.prototype,"maxSize",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],a.prototype,"uploading",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],a.prototype,"size",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],a.prototype,"percentage",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],a.prototype,"complete",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],a.prototype,"failed",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],a.prototype,"invalidFile",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-upload",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-button on-click=":host._dispatchDownload($event)" class="${e.PCSS}-upload ${e.PCSS}-viewfinder flat" css-class="{{ {'upload-chosen': !Pacem.Utils.isNullOrEmpty(:host.value) && !:host.uploading, 'upload-error': !Pacem.Utils.isNullOrEmpty(:host.value) && :host.invalidFile && Pacem.Utils.isNullOrEmpty(:host.url), 'upload-readonly': :host.readonly } }}">\n\n        <${e.P}-panel class="upload-button" hide="{{ (:host.uploading || :host.failed) && !Pacem.Utils.isNullOrEmpty(:host.url) }}">\n            <${e.P}-button tooltip="{{ :host.readonly ? :host.viewValue : 'upload' }}" class="circular pos-relative overflow-hidden" icon-glyph="{{ :host._getMimeIcon(:host.value, :host.uploading) }}" \n                on-mouseover="$this.iconGlyph = :host._getMimeIcon(:host.readonly ? :host.value : '', :host.uploading)" on-mouseout="$this.iconGlyph = :host._getMimeIcon(:host.value, :host.uploading)"\n                css-class="{{ {'${e.PCSS}-anim anim-rotate': :host.uploading, 'button-error': :host.invalidFile, 'button-primary': Pacem.Utils.isNullOrEmpty(:host.value) && !:host.invalidFile, 'button-success': !Pacem.Utils.isNullOrEmpty(:host.value) && !:host.invalidFile } }}">\n                <input type="file" class="${e.PCSS}-transparent ${e.PCSS}-clickable pos-absolute absolute-left absolute-right absolute-top absolute-bottom" />\n            </${e.P}-button>\n        </${e.P}-panel>\n        <${e.P}-panel class="upload-button" hide="{{ !:host.failed }}">\n            <${e.P}-button class="circular flat" icon-glyph="refresh"\n            tooltip="{{ :host.retryCaption }}" on-click=":host._retry($event)"><${e.P}-text text="{{ :host.retryCaption }}"></${e.P}-text></${e.P}-button>\n        </${e.P}-panel>\n        <${e.P}-panel class="upload-button" hide="{{ !:host.uploading || Pacem.Utils.isNullOrEmpty(:host.url) }}">\n            <${e.P}-button class="circular flat" icon-glyph="clear" tooltip="{{ :host.undoCaption }}" \n                on-click=":host._undo($event)"><${e.P}-text text="{{ :host.undoCaption }}"></${e.P}-text></${e.P}-button>\n        </${e.P}-panel>\n\n        <${e.P}-span tooltip="{{ :host.viewValue }}" hide="{{ $pacem.isNullOrEmpty(:host.value) || :host.uploading }}" class="readonly text-reset display-block ${e.PCSS}-anim text-truncate text-left text-pre ${e.PCSS}-pad pad-right-3" text="{{ :host.viewValue }}"></${e.P}-span>\n\n        <${e.P}-panel class="upload-progress hit-none" hide="{{ :host.readonly || (!Pacem.Utils.isNullOrEmpty(:host.value) && !:host.uploading) }}">\n            <${e.P}-tuner value="{{ :host.percentage }}" css-class="{{ {'tuner-success': !:host.invalidFile, 'tuner-error': :host.invalidFile} }}" interactive="false"></${e.P}-tuner>\n        </${e.P}-panel>\n\n</${e.P}-button>`})],a),t.PacemUploadElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemHiddenInputElement extends t.PacemTextualInputElement{constructor(){super()}toggleReadonlyView(e){}get inputFields(){return[this.input]}};__decorate([e.ViewChild("input[type=hidden]")],a.prototype,"input",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-hidden",template:'<input type="hidden" />',shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemHiddenInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemUrlInputElement extends t.PacemTextualInputElement{constructor(){super()}toggleReadonlyView(e){this.input.hidden=e,this.anchor.hidden=!e}get inputFields(){return[this.input]}};__decorate([e.ViewChild("input[type=url]")],a.prototype,"input",void 0),__decorate([e.ViewChild(e.P+"-a")],a.prototype,"anchor",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-url",template:`<input type="url" class="${e.PCSS}-input" />${t.CHAR_COUNTER_CHILD}<${e.P}-a class="${e.PCSS}-readonly" disabled="{{ $pacem.isNullOrEmpty(:host.value) }}" href="{{ :host.value }}" target="_blank"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></${e.P}-a>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemUrlInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){a.Picture=class Picture{},a.ImageFetchRequestEventName="imagefetchrequest";class ImageFetchRequestEvent extends e.CustomTypedEvent{constructor(e){super(a.ImageFetchRequestEventName,e,{bubbles:!0})}}a.ImageFetchRequestEvent=ImageFetchRequestEvent;let i=class PacemEditImageElement extends t.PacemElement{constructor(){super(...arguments),this._index=0,this.hint=""}_uploaderPropertyChangedCallback(e){const t=e.detail.currentValue;switch(e.detail.propertyName){case"percentage":this._progressbar.percentage=100*t;break;case"uploading":t&&this._done(!0)}}_thumbnailUploaderPropertyChangedCallback(e){const t=e.detail.currentValue;switch(e.detail.propertyName){case"percentage":this._progressbar.percentage=100*t;break;case"uploading":this._done(t)}}_uploaderFileUploadCallback(t){const a=this._uploader,i=this._thumbUploader,r=i.maxImageWidth,s=i.maxImageHeight;if(r>0&&s>0){var o=a.blob;const n=t.detail.uid;e.Utils.resizeImage(o,r,s).then(e=>{e==o?this._done(!1):i.upload(e,"thumbnail.jpg",n)})}else this._done(!1)}_done(e){e||this._imagefetch(0),this._repeater.hidden=e,this._progressbar.hidden=!e}_snapshotPropertyChangedCallback(t){switch(t.detail.propertyName){case"value":const a=e.Utils.dataURLToBlob(t.detail.currentValue);this._uploader.upload(a,"snapshot.jpg")}}reset(){this._snapshot.step=t.UI.SnapshotStep.Start}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"imageSet":let s=i||{skip:0,set:[]};e.Utils.isNullOrEmpty(this._images)||0===s.skip?this._images=s.set:e.Utils.isNull(this._images)||Array.prototype.splice.apply(this._images,[s.skip,this._images.length-s.skip].concat(s.set)),this._fetching=!1;break;case"hint":r||this._imagefetch(0)}}_imagefetchSuddenly(e){this._fetching=!0,this._imagefetch(e)}_imagefetch(e){e>=0||(e=this._images&&this._images.length||0),this.dispatchEvent(new ImageFetchRequestEvent({hint:this.hint,skip:e,take:18}))}};__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"uploadUrl",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"hint",void 0),__decorate([e.Watch()],i.prototype,"imageSet",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"value",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxWidth",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxHeight",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxThumbnailWidth",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxThumbnailHeight",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],i.prototype,"allowSnapshot",void 0),__decorate([e.Watch()],i.prototype,"_fetching",void 0),__decorate([e.Watch()],i.prototype,"_images",void 0),__decorate([e.ViewChild(e.P+"-repeater")],i.prototype,"_repeater",void 0),__decorate([e.ViewChild(e.P+"-upload[main]")],i.prototype,"_uploader",void 0),__decorate([e.ViewChild(e.P+"-upload[thumb]")],i.prototype,"_thumbUploader",void 0),__decorate([e.ViewChild(e.P+"-snapshot")],i.prototype,"_snapshot",void 0),__decorate([e.ViewChild(e.P+"-progressbar")],i.prototype,"_progressbar",void 0),__decorate([e.Debounce(500)],i.prototype,"_imagefetch",null),i=__decorate([e.CustomElement({tagName:e.P+"-edit-image",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-panel class="${e.PCSS}-edit-image"\n        css-class="{{ {'${e.PCSS}-snapshot': ::_snapshot.step != '${t.UI.SnapshotStep.Start}', '${e.PCSS}-uploading': ::_uploader.uploading, '${e.PCSS}-upload-enabled': !Pacem.Utils.isNullOrEmpty(:host.uploadUrl), '${e.PCSS}-snapshot-enabled': !Pacem.Utils.isNullOrEmpty(:host.uploadUrl) && :host.allowSnapshot} }}">\n        <div>\n            <${e.P}-input-search value="{{ :host.hint, twoway }}"></${e.P}-input-search>\n            <${e.P}-upload main pattern=".+.(jpe?g|png|svg|ico)$" url="{{ :host.uploadUrl }}"\n                    max-image-width="{{ :host.maxWidth }}" max-image-height="{{ :host.maxHeight }}"\n                    on-${a.FileUploadEventName}=":host._uploaderFileUploadCallback($event)"\n                    on-${e.PropertyChangeEventName}=":host._uploaderPropertyChangedCallback($event)" hide="{{ Pacem.Utils.isNullOrEmpty(:host.uploadUrl) || ::_thumbUploader.uploading }}"></${e.P}-upload>\n            <${e.P}-upload thumb pattern=".+.(jpe?g|png|svg|ico)$" url="{{ :host.uploadUrl }}" hide="{{ !::_thumbUploader.uploading  }}"\n                    max-image-width="{{ :host.maxThumbnailWidth }}" max-image-height="{{ :host.maxThumbnailHeight }}"\n                    on-${e.PropertyChangeEventName}=":host._thumbnailUploaderPropertyChangedCallback($event)"></${e.P}-upload>\n            <${e.P}-button class="${e.PCSS}-snapshot" on-click="Pacem.avoidHandler($event); ::_snapshot.step = '${t.UI.SnapshotStep.Taking}'" hide="{{ Pacem.Utils.isNullOrEmpty(:host.uploadUrl) || !:host.allowSnapshot }}"></${e.P}-button>\n            <${e.P}-infinite-scroller container="{{ ::_repeater }}" on-fetchmore=":host._imagefetchSuddenly()" disabled="{{ :host._fetching || :host.disabled || :host._images.length >= :host.imageSet.total }}"></${e.P}-infinite-scroller>\n            <${e.P}-repeater datasource="{{ :host._images }}">\n                <template>\n                    <${e.P}-img css-class="{{ {'${e.PCSS}-selected': ^item.src === :host.value } }}" on-click=":host.value = ^item.src" src="{{ ^item.thumb }}" adapt="contain"></${e.P}-img>\n                </template>\n            </${e.P}-repeater>\n            <${e.P}-progressbar class="progressbar-smaller progressbar-accent" caption="{{ ::_thumbUploader.uploading ? 'thumbnail...' : 'uploading...' }}"></${e.P}-progressbar>\n        </div>\n        <div>\n            <${e.P}-snapshot hide="{{ !:host.allowSnapshot }}" on-${e.PropertyChangeEventName}=":host._snapshotPropertyChangedCallback($event)"></${e.P}-snapshot>\n        </div>\n    </${e.P}-panel>`})],i),a.PacemEditImageElement=i;let r=class PacemImageInputElement extends a.PacemBaseElement{constructor(){super(...arguments),this._broadcastFetchRequestEventName=(e=>{this.dispatchEvent(new ImageFetchRequestEvent(e.detail))}),this._innerValueChangedHandler=(t=>{"value"!==t.detail.propertyName||e.Utils.isNull(this._dialog)||(this._dialog.state=t.detail.currentValue)})}convertValueAttributeToProperty(e){return e}getViewValue(e){return e}get inputFields(){return[]}_clear(e){this.changeHandler(e)}onChange(a){let i=this.value;return e.CustomEventUtils.isInstanceOf(a,t.UI.DialogResultEvent)&&a.detail.button===t.UI.DialogButton.Ok?i=this.value=a.detail.state:a.target===this._input?i=this.value=this._input.value:a.target===this._clearBtn&&(i=this.value=void 0),e.Utils.fromResult(i)}toggleReadonlyView(e){this._input.hidden=this._editBtn.hide=this._clearBtn.hide=e}_addDialog(){var a=document.createElement(e.P+"-dialog");return a.buttons=t.UI.DialogButtons.OkCancel,a.addEventListener(t.UI.DialogResultEventName,this.changeHandler,!1),a.appendChild(this._addEditImage()),document.body.appendChild(a),this._dialog=a}_removeDialog(){this._removeEditImage(),e.Utils.isNull(this._dialog)||(this._dialog.removeEventListener(t.UI.DialogResultEventName,this.changeHandler,!1),this._dialog.remove())}_addEditImage(){var t=document.createElement(e.P+"-edit-image");return t.disabled=!0,t.addEventListener(e.PropertyChangeEventName,this._innerValueChangedHandler,!1),t.addEventListener(a.ImageFetchRequestEventName,this._broadcastFetchRequestEventName,!1),t.uploadUrl=this.uploadUrl,t.allowSnapshot=this.allowSnapshot,t.maxWidth=this.maxWidth,t.maxHeight=this.maxHeight,t.maxThumbnailHeight=this.maxThumbnailHeight,t.maxThumbnailWidth=this.maxThumbnailWidth,this._editImage=t}_removeEditImage(){e.Utils.isNull(this._editImage)||(this._editImage.removeEventListener(e.PropertyChangeEventName,this._innerValueChangedHandler,!1),this._editImage.removeEventListener(a.ImageFetchRequestEventName,this._broadcastFetchRequestEventName,!1))}connectedCallback(){super.connectedCallback(),this._addDialog()}disconnectedCallback(){this._removeDialog(),super.disconnectedCallback()}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"uploadUrl":e.Utils.isNull(this._editImage)||(this._editImage.uploadUrl=i);break;case"allowSnapshot":e.Utils.isNull(this._editImage)||(this._editImage.allowSnapshot=i);break;case"imageSet":e.Utils.isNull(this._editImage)||(this._editImage.imageSet=i);break;case"maxThumbnailHeight":e.Utils.isNull(this._editImage)||(this._editImage.maxThumbnailHeight=i);break;case"maxThumbnailWidth":e.Utils.isNull(this._editImage)||(this._editImage.maxThumbnailWidth=i);break;case"maxHeight":e.Utils.isNull(this._editImage)||(this._editImage.maxHeight=i);break;case"maxWidth":e.Utils.isNull(this._editImage)||(this._editImage.maxWidth=i)}}acceptValue(t){e.Utils.isNull(this._editImage)||(this._editImage.value=t)}_update(e){this._image.src=e}_retrieve(){return this.value}_edit(a){e.avoidHandler(a);var i=this._editImage,r=this.value;i.disabled=!1,i.reset(),i.value=r,this._dialog.open(r).then(e=>{switch(e.button){case t.UI.DialogButton.Cancel:this._update(this.value);break;case t.UI.DialogButton.Ok:this._update(e.state)}this._editImage.disabled=!0})}};__decorate([e.ViewChild(e.P+"-img")],r.prototype,"_image",void 0),__decorate([e.ViewChild(e.P+"-button."+e.PCSS+"-edit")],r.prototype,"_editBtn",void 0),__decorate([e.ViewChild(e.P+"-button."+e.PCSS+"-clear")],r.prototype,"_clearBtn",void 0),__decorate([e.ViewChild(e.P+"-input-url")],r.prototype,"_input",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],r.prototype,"uploadUrl",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],r.prototype,"imageSet",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],r.prototype,"maxWidth",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],r.prototype,"maxHeight",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],r.prototype,"maxThumbnailWidth",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],r.prototype,"maxThumbnailHeight",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],r.prototype,"allowSnapshot",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-input-image",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<div class="${e.PCSS}-input-image"><${e.P}-img src="{{ :host.value }}" adapt="contain"></${e.P}-img><div class="${e.PCSS}-input-image-dashboard">\n    <${e.P}-button on-click=":host._edit($event)" hide="{{ :host.disabled }}" class="${e.PCSS}-edit">Edit</${e.P}-button>\n    <${e.P}-button on-click=":host._clear($event)" hide="{{ :host.disabled }}" class="${e.PCSS}-clear">Clear</${e.P}-button>\n</div><${e.P}-input-url placeholder="{{ :host.placeholder }}" on-change=":host.changeHandler($event)" value="{{ :host.value }}"></${e.P}-input-url>\n\n    <${e.P}-panel hide="{{ Pacem.Utils.isNullOrEmpty(:host.value) }}">\n    <dl class="${e.PCSS}-input-image-preview">\n        <dt>dimensions:</dt><dd><${e.P}-text text="{{ ::_image.size.width +'x'+ ::_image.size.height }}"></${e.P}-text></dd>\n        <dt>size:</dt><dd><${e.P}-text text="{{ $pacem.size(::_image.size.weight) }}"></${e.P}-text></dd>\n    </dl></${e.P}-panel>\n\n</div>`})],r),a.PacemImageInputElement=r}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemNumberInputElement extends t.PacemOrdinalInputElement{toggleReadonlyView(e){this._span.hidden=!e,this._input.hidden=e}get inputFields(){return[this._input]}getViewValue(e){return null!=this.value?this._format(this.value):void 0}_format(t=this.value){const a=this.format;return e.Utils.isNullOrEmpty(a)?t.toString():new Intl.NumberFormat(e.Utils.lang(this),a).format(t)}getValue(e){const t=this.inputField.valueAsNumber||parseFloat(this.inputField.value);return isNaN(t)?void 0:t}};__decorate([e.ViewChild("input[type=number]")],a.prototype,"_input",void 0),__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],a.prototype,"_span",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],a.prototype,"format",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-number",template:`<input type="number" class="${e.PCSS}-input ${e.PCSS}-viewfinder" /><span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemNumberInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemPasswordInputElement extends t.PacemTextualInputElement{constructor(){super()}get inputFields(){return[this.input]}toggleReadonlyView(e){this.input.hidden=e,this.span.hidden=!e}getViewValue(t){return e.Utils.leftPad("",Math.floor(8+3*Math.random()),"•")}};__decorate([e.ViewChild("input[type=password]")],a.prototype,"input",void 0),__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],a.prototype,"span",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-password",template:`<input type="password" class="${e.PCSS}-input ${e.PCSS}-viewfinder" />${t.CHAR_COUNTER_CHILD}<span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemPasswordInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemSearchInputElement extends t.PacemTextualInputElement{constructor(){super()}get inputFields(){return[this.input]}toggleReadonlyView(e){}};__decorate([e.ViewChild("input[type=search]")],a.prototype,"input",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-search",template:'<input type="search" class="'+e.PCSS+'-input" />',shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemSearchInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemTelInputElement extends t.PacemTextualInputElement{constructor(){super()}toggleReadonlyView(e){this.input.hidden=e,this.anchor.hidden=!e}get inputFields(){return[this.input]}};__decorate([e.ViewChild("input[type=tel]")],a.prototype,"input",void 0),__decorate([e.ViewChild(e.P+"-a")],a.prototype,"anchor",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-tel",template:`<input type="tel" class="${e.PCSS}-input" /><${e.P}-a class="${e.PCSS}-readonly" disabled="{{ $pacem.isNullOrEmpty(:host.value) }}" href="{{ 'tel:'+ :host.value }}"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></${e.P}-a>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemTelInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemTextInputElement extends t.PacemTextualInputElement{constructor(){super()}toggleReadonlyView(e){this._span.hidden=!e,this._input.hidden=e}get inputFields(){return[this._input]}};__decorate([e.ViewChild("input[type=text]")],a.prototype,"_input",void 0),__decorate([e.ViewChild("span."+e.PCSS+"-readonly")],a.prototype,"_span",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-input-text",template:`<input type="text" class="${e.PCSS}-input" />${t.CHAR_COUNTER_CHILD}<span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemTextInputElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){t.DEFAULT_TILES="",t.DEFAULT_ATTRIBUTION="";let a=class PacemLatLngElement extends t.PacemBaseElement{convertValueAttributeToProperty(e){const t=/^\s*([+-]?\d+\.?\d+)[,\s]\s*([+-]?\d+\.?\d+)\s*$/.exec(e);if(t&&3===t.length)return{lat:parseFloat(t[1]),lng:parseFloat(t[2])};throw`Invalid coordinates format for "${e}"`}compareValuePropertyValues(e,t){return!(!e||"number"!=typeof e.lat||"number"!=typeof e.lng||!t||"number"!=typeof t.lat||"number"!=typeof t.lng)&&(e.lat===t.lat&&e.lng===t.lng)}getViewValue(e){return this._getViewValue(e)}_getViewValue(e,t=8){return e&&"number"==typeof e.lat&&"number"==typeof e.lng&&e.lat.toFixed(t)+","+e.lng.toFixed(t)||""}get inputFields(){return[this._latInput,this._lngInput]}toggleReadonlyView(e){this._inputContainer.hidden=e}acceptValue(e){let t=this._ensureValue(e);this._lat=t.lat,this._lng=t.lng}_ensureValue(t){return t&&"number"==typeof t.lat&&"number"==typeof t.lng?t:e.Components.Maps.MapConsts.DEFAULT_COORDS}onChange(t){if(t&&"dragend"===t.type){var a=t;this._lat=a.detail.position.lat,this._lng=a.detail.position.lng}const i=this._lat,r=this._lng;return e.Utils.isNull(i)||e.Utils.isNull(r)?e.Utils.fromResult(this.value):e.Utils.fromResult(this.value={lat:i,lng:r})}propertyChangedCallback(t,a,i,r){if(super.propertyChangedCallback(t,a,i,r),"options"===t&&!r){const t=e.Utils.clone(i||{provider:"osm"});this._synchronizeOptions(t)}}viewActivatedCallback(){super.viewActivatedCallback(),this._synchronizeOptions()}_synchronizeOptions(t=this.options||{provider:"osm"}){const a=this._marker,i=this._map;switch(a.icon=t.icon,t&&t.provider){case"azure":this._azureAdapter.subscriptionKey=t.apiKey,i.adapter=this._azureAdapter;break;case"google":case"gmaps":this._googleAdapter.apiKey=t.apiKey,i.adapter=this._googleAdapter;break;default:e.Utils.isNullOrEmpty(t.attribution)||(this._leafletAdapter.attribution=t.attribution),e.Utils.isNullOrEmpty(t.tiles)||(this._leafletAdapter.tiles=t.tiles),i.adapter=this._leafletAdapter}delete t.provider,delete t.icon,delete t.apiKey,delete t.attribution,delete t.tiles;for(let e in t)e in i&&(i[e]=t[e])}};__decorate([e.ViewChild(e.P+"-map-adapter-leaflet")],a.prototype,"_leafletAdapter",void 0),__decorate([e.ViewChild(e.P+"-map-adapter-azure")],a.prototype,"_azureAdapter",void 0),__decorate([e.ViewChild(e.P+"-map-adapter-google")],a.prototype,"_googleAdapter",void 0),__decorate([e.ViewChild(e.P+"-map")],a.prototype,"_map",void 0),__decorate([e.ViewChild(e.P+"-map-marker")],a.prototype,"_marker",void 0),__decorate([e.ViewChild(e.P+"-input-number:nth-child(1)")],a.prototype,"_latInput",void 0),__decorate([e.ViewChild(e.P+"-input-number:nth-child(2)")],a.prototype,"_lngInput",void 0),__decorate([e.ViewChild(`.${e.PCSS}-latlng-fields`)],a.prototype,"_inputContainer",void 0),__decorate([e.ViewChild(e.P+"-fetch")],a.prototype,"_fetcher",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json,emit:!1})],a.prototype,"options",void 0),__decorate([e.Watch()],a.prototype,"_lat",void 0),__decorate([e.Watch()],a.prototype,"_lng",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-latlng",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<div class="${e.PCSS}-latlng">\n    <div class="${e.PCSS}-latlng-fields ${e.PCSS}-viewfinder">\n        <${e.P}-input-number class="${e.PCSS}-lat" value="{{ :host._lat, twoway }}" min="-90" max="90" step="{{ 'any' }}"></${e.P}-input-number>\n        <${e.P}-input-number class="${e.PCSS}-lng" value="{{ :host._lng, twoway }}" min="-180" max="180" step="{{ 'any' }}"></${e.P}-input-number>\n    </div>\n    <${e.P}-panel hide="{{ Pacem.Utils.isNull(:host.value) || :host.readonly }}">\n    <dl class="${e.PCSS}-latlng-preview">\n        <dt>decimals:</dt><dd><${e.P}-text text="{{ :host._getViewValue(:host.value, 12) }}"></${e.P}-text></dd>\n        <dt>address:</dt><dd><${e.P}-text text="{{ ::_fetcher.result.display_name || '?' }}"></${e.P}-text></dd>\n        <dt>degrees:</dt><dd><${e.P}-span css-class="{{ {'${e.PCSS}-lat-north': :host._lat > 0, '${e.PCSS}-lat-south': :host._lat < 0} }}" content="{{ $pacem.decToDeg(Math.abs(:host._lat)) }}"></${e.P}-span>,\n        <${e.P}-span css-class="{{ {'${e.PCSS}-lng-east': :host._lng > 0, '${e.PCSS}-lng-west': :host._lng < 0} }}" content="{{ $pacem.decToDeg(Math.abs(:host._lng)) }}"></${e.P}-span></dd>\n    </dl>\n    </${e.P}-panel>\n    <${e.P}-span class="${e.PCSS}-readonly" hide="{{ !:host.readonly }}" content="{{ :host.viewValue + ($pacem.isNullOrEmpty(::_fetcher.result.display_name) ? '' : (' <small>'+ ::_fetcher.result.display_name +'</small>')) }}"></${e.P}-span>\n\n    <${e.P}-map-adapter-leaflet></${e.P}-map-adapter-leaflet>\n    <${e.P}-map-adapter-azure></${e.P}-map-adapter-azure>\n    <${e.P}-map-adapter-google></${e.P}-map-adapter-google>\n\n    <${e.P}-map adapter="{{ ::_adapter }}">\n        <${e.P}-map-marker position="{{ :host._ensureValue(:host.value) }}" on-dragend=":host.changeHandler($event)" draggable="{{ !:host.readonly }}"></${e.P}-map-marker>\n    </${e.P}-map>\n    <${e.P}-fetch disabled="{{ $pacem.isNull(:host.value) }}" parameters="{{ { format: 'json', lat: :host._lat, lon: :host._lng } }}" url="https://nominatim.openstreetmap.org/reverse"></${e.P}-fetch>\n</div>`})],a),t.PacemLatLngElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const a=`change-policy="${t.ChangePolicy.Blur}" readonly="{{ :host.readonly }}"`;function i(t){return e.Utils.isNullOrEmpty(t&&t.name)}let r=class PacemNameValueListElement extends t.PacemBaseElement{constructor(){super(...arguments),this.inputFields=[],this._bag=[]}toggleReadonlyView(e){}onChange(e){return new Promise((e,t)=>{let a=this._bagToValue(this._bag);this.compareValuePropertyValues(a,this.value)?t():e(this.value=a)})}acceptValue(e){this._bag=this._valueToBag(e)}getViewValue(e){return""}compareValuePropertyValues(t,a){return e.Utils.Json.stringify(t)===e.Utils.Json.stringify(a)}convertValueAttributeToProperty(t){return e.PropertyConverters.Json.convert(t)}propertyChangedCallback(e,t,a,i){super.propertyChangedCallback(e,t,a,i),"dictionary"!==e||i||(this.value=this._bagToValue())}_bagToValue(e=this._bag){if(!this.dictionary){let t=[];for(let a of e||[])i(a)||t.find(e=>e.name===a.name&&e.value===a.value)||t.push(a);return t}let t={};for(let a of e||[])a.name in t||(t[a.name]=a.value);return t}_valueToBag(t=this.value){const a=[];if(!e.Utils.isNullOrEmpty(t)&&"object"==typeof t)if(this.dictionary&&!e.Utils.isArray(t))for(let e in t)a.push({name:e,value:t[e]});else!this.dictionary&&e.Utils.isArray(t)&&Array.prototype.splice.apply(a,[0,0].concat(t.map(t=>e.Utils.clone(t))));return e.Utils.isNullOrEmpty(a)?[{name:"",value:""}]:a}_deleteAt(e){this._bag.splice(e.detail,1),this.changeHandler(e)}_addItem(e){const t=this._bag;i(this._bag[this._bag.length-1])||t.push({name:"",value:""})}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],r.prototype,"dictionary",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],r.prototype,"_bag",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-namevalue-list",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-repeater datasource="{{ :host._bag }}" on-itemdelete=":host._deleteAt($event)">\n    <template>\n        <div class="${e.PCSS}-fieldset ${e.PCSS}-margin margin-bottom-1">\n            <div class="fieldset-auto">\n                <div class="${e.PCSS}-fieldgroup">\n                    <${e.P}-input-text ${a} value="{{ ^item.name, twoway }}" on-change=":host.changeHandler($event)"></${e.P}-input-text>\n                    <div class="fieldgroup-prepend"></div>\n                </div>\n                <div class="${e.PCSS}-fieldgroup">\n                    <${e.P}-input-text ${a} value="{{ ^item.value, twoway }}" on-change=":host.changeHandler($event)"></${e.P}-input-text>\n                    <div class="fieldgroup-append">\n                        <${e.P}-button class="${e.PCSS}-cell cols-2 flat delete" hide="{{ :host.readonly }}" command-name="delete" command-argument="{{ ^index }}"></${e.P}-button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </template>\n    <${e.P}-button class="flat add" hide="{{ :host.readonly }}" on-click=":host._addItem($event)"></${e.P}-button>\n</${e.P}-repeater>`})],r),t.PacemNameValueListElement=r}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemPropertyPickerElement extends t.PacemBaseElement{get inputFields(){return[this._select]}toggleReadonlyView(e){this._select.readonly=e}onChange(t){return e.Utils.fromResult(this.value=this._select.value)}acceptValue(e){this._select.value=e}getViewValue(e){return this._select.viewValue}convertValueAttributeToProperty(t){return e.PropertyConverters.Element.convert(t)}viewActivatedCallback(){super.viewActivatedCallback(),this._databind()}propertyChangedCallback(e,t,a,i){if(super.propertyChangedCallback(e,t,a,i),!i)switch(e){case"target":this._databind()}}_databind(){const t=[],a=(i,r,s)=>{const o=i[r];if("object"==typeof o&&null!=o&&!e.Utils.isArray(o))for(let e of Object.keys(o)){const i=s+"."+e;t.push(i),a(o,e,i)}};let i=this.target;if(!e.Utils.isNull(i)){let r=e.CustomElementUtils.getWatchedProperties(i);for(let e of r){let r=e.name;t.push(r),a(i,r,r)}}this._select.datasource=t.sort()}};__decorate([e.ViewChild(e.P+"-select")],a.prototype,"_select",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Element})],a.prototype,"target",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-property-picker",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-select></${e.P}-select>`})],a),t.PacemPropertyPickerElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemRadioListElement extends t.PacemDataSourceElement{constructor(){super(),this.key="_"+e.Utils.uniqueCode()}acceptValue(e){}get inputFields(){return[]}propertyChangedCallback(e,t,a,i){super.propertyChangedCallback(e,t,a,i),"disabled"===e&&(this._disable.model=a)}viewActivatedCallback(){super.viewActivatedCallback(),this._disable.model=this.disabled}toggleReadonlyView(e){this._repeater.hidden=e,this._span.hidden=!e}_selectionChanged(e,t,a){"selected"===e.detail.propertyName&&!0===e.detail.currentValue&&(this._selectedValue=this.mapEntityToValue(this.datasource[t]),this.changeHandler(e))}onChange(t){return this.value=this._selectedValue,this.databind(),e.Utils.fromResult(this._selectedValue)}};__decorate([e.ViewChild(e.P+"-repeater")],a.prototype,"_repeater",void 0),__decorate([e.ViewChild(e.P+"-data")],a.prototype,"_disable",void 0),__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],a.prototype,"_span",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-radio-list",template:`<${e.P}-repeater datasource="{{ :host.adaptedDatasource }}">\n    <ol class="${e.PCSS}-radio-list ${e.PCSS}-viewfinder" pacem>\n        <template>\n            <li><${e.P}-radio disabled="{{ ::_disable.model || ^item.disabled }}" name="{{ :host.key, once }}" caption="{{ ^item.viewValue }}" value="{{ ^item.value }}" selected="{{ :host.isDataSourceItemSelected(^item, :host.value) }}"\non-focus=":host.focusHandler($event)" on-blur=":host.focusHandler($event)"\non-${e.PropertyChangeEventName}=":host._selectionChanged($event, ^index, ^item)"></${e.P}-radio></li>\n        </template>\n    </ol>\n</${e.P}-repeater><span class="${e.PCSS}-readonly ${e.PCSS}-radio"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span><${e.P}-data></${e.P}-data><${e.P}-content></${e.P}-content>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemRadioListElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemRadioElement extends t.PacemBaseElement{constructor(){super(),this._key="_"+e.Utils.uniqueCode()}convertValueAttributeToProperty(e){return e}toggleReadonlyView(e){this.span.hidden=!e,this._radio.hidden=e}get inputFields(){return[this._radio]}onChange(t){this.selected=this._radio.checked;const a=this.selected?this._radio.value:void 0;return e.Utils.fromResult(a)}viewActivatedCallback(){super.viewActivatedCallback(),this._radio.id=this._label.htmlFor=this._key}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"name":this._radio.name=i;break;case"selected":(this._radio.checked=i)?e.Utils.addClass(this,e.PCSS+"-selected"):e.Utils.removeClass(this,e.PCSS+"-selected")}}acceptValue(t){this._radio.value=e.Utils.isNullOrEmpty(t)?"":t}getViewValue(t){return e.Utils.isNull(t)?"":this.caption}};__decorate([e.ViewChild("input[type=radio]")],a.prototype,"_radio",void 0),__decorate([e.ViewChild("label")],a.prototype,"_label",void 0),__decorate([e.ViewChild(`.${e.PCSS}-readonly`)],a.prototype,"span",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],a.prototype,"caption",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],a.prototype,"selected",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-radio",template:`<${e.P}-span class="${e.PCSS}-readonly ${e.PCSS}-radio" text="{{ :host.caption }}"></${e.P}-span><input type="radio" class="${e.PCSS}-input" /><label class="${e.PCSS}-label ${e.PCSS}-radio ${e.PCSS}-viewfinder"><${e.P}-text text="{{ :host.caption }}"></${e.P}-text></label>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemRadioElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){let i=class PacemSelectElement extends a.PacemDataSourceElement{constructor(){super(),this.emptyOption=!0}toggleReadonlyView(e){this._repeater.hidden=e,this._span.hidden=!e}get inputFields(){return[this._select]}_manageDom(t){const a=t.detail,i=a.item;let r=a.dom.find(e=>e instanceof HTMLOptionElement);r.value=i.value,r.textContent=i.viewValue,r.disabled=i.disabled,r.selected=this.isDataSourceItemSelected(i),(e.Utils.isNullOrEmpty(r.value)?e.Utils.addClass:e.Utils.removeClass).apply(this,[r,e.PCSS+"-watermark"])}onChange(t){let a,i=this._select.selectedIndex,r=this.adaptedDatasource,s=i>=0&&r[i];return a=null!=s?s.value:void 0,e.Utils.fromResult(this.value=a)}propertyChangedCallback(e,t,a,i){switch(super.propertyChangedCallback(e,t,a,i),e){case"placeholder":case"emptyOption":this.databind()}}buildAdaptedDatasource(e=this.datasource){let t=super.buildAdaptedDatasource(e);return t&&this.emptyOption&&t.splice(0,0,{viewValue:this.placeholder||"",value:""}),t}handleDatasourceMismatch(e){this.emptyOption?super.handleDatasourceMismatch(e):this.value=e[0].value}acceptValue(t){const a=this.adaptedDatasource,i=a&&a.filter(e=>this.isDataSourceItemSelected(e,t));if(i&&1==i.length)this._select.selectedIndex=a.indexOf(i[0]);else{this._select.value=void 0;let t=this._select.options;t.length>0&&e.Utils.isNullOrEmpty(t[0].value)&&(this._select.selectedIndex=0)}}viewActivatedCallback(){super.viewActivatedCallback();this._select.addEventListener("wheel",this.emitHandler,{capture:!1,passive:!0})}disconnectedCallback(){if(!e.Utils.isNull(this._select)){this._select.removeEventListener("wheel",this.emitHandler,{capture:!1,passive:!0})}super.disconnectedCallback()}};__decorate([e.ViewChild("select")],i.prototype,"_select",void 0),__decorate([e.ViewChild(e.P+"-repeater")],i.prototype,"_repeater",void 0),__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],i.prototype,"_span",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],i.prototype,"emptyOption",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-select",template:`<${e.P}-repeater datasource="{{ :host.adaptedDatasource }}" on-${t.RepeaterItemCreateEventName}=":host._manageDom($event)">\n    <select class="${e.PCSS}-select ${e.PCSS}-viewfinder">\n        <template>\n            <option></option>\n        </template>\n    </select>\n</${e.P}-repeater><span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span><${e.P}-content></${e.P}-content>`,shadow:e.Defaults.USE_SHADOW_ROOT})],i),a.PacemSelectElement=i}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){let i=class PacemSliderElement extends a.PacemBaseElement{constructor(){super(...arguments),this.inputFields=[],this._dragHandler=(e=>{e.preventDefault(),this._computeAndAssignValue(e.detail.currentPosition.x,"end"!==this.changePolicy)}),this._endHandler=(e=>{e.preventDefault(),this._computeAndAssignValue(e.detail.currentPosition.x,"end"===this.changePolicy)}),this._startHandler=(e=>{this._thumb.focus()}),this._downHandler=(t=>{const a=t instanceof MouseEvent?t.clientX:t.touches&&t.touches.length&&t.touches[0].clientX,i=this._trackSize;e.Utils.isNullOrEmpty(i)||this._computeAndAssignValue(a,!0)}),this._keydownHandler=(t=>{switch(t.keyCode){case 39:case 37:e.avoidHandler(t);let a=39===t.keyCode,i=("number"!=typeof this.step?1:this.step)*(a?1:-1),r=!1,s=t=>{r=!0,window.removeEventListener("keyup",s,!1),e.Utils.removeClass(this,"slider-keydown")};window.addEventListener("keyup",s,!1),e.Utils.addClass(this,"slider-keydown"),e.Utils.accelerateCallback(e=>{(e.cancel=r)||this._setValue(this.value+i)})}})}onChange(e){return new Promise((t,a)=>{"slide"===e.type&&t(this.value=e.detail),t(this.value)})}_draw(t=this.value){const a=this._trackSize;if(e.Utils.isNull(a))return;let i=parseFloat(t)||this.min,r=Math.min(1,Math.max(0,(i-this.min)/(this.max-this.min)));this._progress.style.transform=`scale(${r}, 1)`,this._thumb.style.transform=`translateX(${Math.round(r*a.width)}px)`}_format(t){const a=this.format;if(!e.Utils.isNullOrEmpty(a))return new Intl.NumberFormat(e.Utils.lang(this),a).format(t);let i="-";e.Utils.isNull(t)||(i=t.toLocaleString());let r=new CustomEvent("formatvalue",{detail:{value:t}});return this.dispatchEvent(r),e.Utils.isNull(r.detail.output)?i:r.detail.output}acceptValue(e){this._draw(e)}getViewValue(e){return this._format(e)}convertValueAttributeToProperty(e){return parseFloat(e)}toggleReadonlyView(e){this._thumb.hidden=e}_setTrackSize(e){const t=e.detail;this._trackSize={x:t.left,y:t.top,width:t.width,height:t.height},this._draw(this.value)}_computeAndAssignValue(e,t){const a=this._trackSize,i=this.step;let r=(e-a.x)/a.width,s=(this.max-this.min)*r+this.min;"number"==typeof i&&(s=Math.round(s/i)*i),t?this._setValue(s):this._draw(s)}_setValue(e){e=Math.min(this.max,Math.max(this.min,e)),this.changeHandler(new CustomEvent("slide",{detail:e}))}connectedCallback(){super.connectedCallback(),this.addEventListener("mousedown",this._downHandler,!1),this.addEventListener("touchstart",this._downHandler,!1)}viewActivatedCallback(){super.viewActivatedCallback(),this._dragger.addEventListener(e.UI.DragDropEventType.Init,this._startHandler,!1),this._dragger.addEventListener(e.UI.DragDropEventType.Drag,this._dragHandler,!1),this._dragger.addEventListener(e.UI.DragDropEventType.End,this._endHandler,!1),this._thumb.addEventListener("keydown",this._keydownHandler,!1),this._min.text=this._format(this.min),this._max.text=this._format(this.max);const a=this._shellProxy.dom[0];a.target=this._thumb,a.options={trigger:t.UI.BalloonTrigger.Focus,trackPosition:!0,position:t.UI.BalloonPosition.Top,align:t.UI.BalloonAlignment.Center,behavior:t.UI.BalloonBehavior.Tooltip,hoverDelay:0,hoverTimeout:0},a.disabled=!this.thumbLabel,this._thumb.tabIndex=0}disconnectedCallback(){this.removeEventListener("mousedown",this._downHandler,!1),this.removeEventListener("touchstart",this._downHandler,!1),e.Utils.isNull(this._dragger)||(this._dragger.removeEventListener(e.UI.DragDropEventType.End,this._endHandler,!1),this._dragger.removeEventListener(e.UI.DragDropEventType.Drag,this._dragHandler,!1),this._dragger.removeEventListener(e.UI.DragDropEventType.Init,this._startHandler,!1)),e.Utils.isNull(this._thumb)||this._thumb.removeEventListener("keydown",this._keydownHandler,!1),super.disconnectedCallback()}propertyChangedCallback(t,a,i,r){if(super.propertyChangedCallback(t,a,i,r),!r)switch(t){case"thumbLabel":(i?e.Utils.addClass:e.Utils.removeClass).apply(this,[this,"slider-thumblabel"]),this._shellProxy.dom[0].disabled=!i;break;case"min":case"max":e.Utils.isNull(this._max)||e.Utils.isNull(this._min)||(this._min.text=this._format(this.min),this._max.text=this._format(this.max)),this._setValue(this.value),this._draw()}}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],i.prototype,"min",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],i.prototype,"max",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],i.prototype,"thumbLabel",void 0),__decorate([e.Watch({emit:!1,converter:{convert:e=>{let t=parseFloat(e);return isNaN(t)?"any":t},convertBack:e=>(e||"").toString()}})],i.prototype,"step",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],i.prototype,"changePolicy",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],i.prototype,"format",void 0),__decorate([e.ViewChild(".slider-track")],i.prototype,"_track",void 0),__decorate([e.ViewChild(".slider-progress")],i.prototype,"_progress",void 0),__decorate([e.ViewChild(".slider-thumb")],i.prototype,"_thumb",void 0),__decorate([e.ViewChild(`${e.P}-text[min]`)],i.prototype,"_min",void 0),__decorate([e.ViewChild(`${e.P}-text[max]`)],i.prototype,"_max",void 0),__decorate([e.ViewChild(`${e.P}-drag-drop`)],i.prototype,"_dragger",void 0),__decorate([e.ViewChild(`${e.P}-shell-proxy`)],i.prototype,"_shellProxy",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-slider",template:`<${e.P}-text text="{{ :host._format(:host.min) }}" min></${e.P}-text>\n    <div class="slider-track"><div class="slider-progress"></div></div>\n    <${e.P}-panel class="${e.PCSS}-clickable slider-thumb" behaviors="{{ [::_dragger] }}">\n        <div class="thumb-label"></div>\n    </${e.P}-panel>\n    <${e.P}-text text="{{ :host._format(:host.max) }}" max></${e.P}-text>\n    <div class="slider-footer"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></div>\n<${e.P}-drag-drop lock-timeout="0"></${e.P}-drag-drop><${e.P}-resize watch-position="true" on-${t.ResizeEventName}=":host._setTrackSize($event)" target="{{ ::_track }}"></${e.P}-resize>\n<${e.P}-shell-proxy><${e.P}-balloon class="text-center"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></${e.P}-balloon></${e.P}-shell-proxy>\n`,shadow:e.Defaults.USE_SHADOW_ROOT})],i),a.PacemSliderElement=i}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){class SuggestionSelectEvent extends e.CustomTypedEvent{constructor(e){super("suggestionselect",{selectedValue:e})}}let i=class PacemSuggestElement extends a.PacemDataSourceElement{constructor(){super(...arguments),this._focusHandler=(e=>{this.hint=(this._downOn=this._input).value}),this._keyupHandler=(t=>{t.target!==this._downOn?e.avoidHandler(t):(this.hint=this._input.value,this.changeHandler(new SuggestionSelectEvent(null)))}),this._keydownHandler=(t=>{var a;switch(this._downOn=t.target,t.keyCode){case 40:case 9:case 13:!0!==this._balloon.visible||e.Utils.isNull(a=this._repeater.querySelector("ol > li"))||(e.avoidHandler(t),this._focus(a))}}),this._selectHandler=(t=>{if(t instanceof KeyboardEvent&&(9===t.keyCode||13===t.keyCode||32===t.keyCode)||"click"===t.type)(function(t){const a=JSON.parse(t.currentTarget.dataset.pacemValue);JSON.parse(t.currentTarget.dataset.pacemViewValue);e.avoidHandler(t),this.changeHandler(new SuggestionSelectEvent(a))}).apply(this,[t]);else if(t instanceof KeyboardEvent){this._downOn=t.target;var a,i=t.target;switch(t.keyCode){case 38:a=i.previousElementSibling||this._input,e.avoidHandler(t);break;case 40:i.nextElementSibling&&"li"===i.nextElementSibling.localName&&(a=i.nextElementSibling),e.avoidHandler(t)}this._focus(a)}}),this._afterSelectHandler=(t=>{9!==t.keyCode&&13!==t.keyCode&&32!==t.keyCode||e.avoidHandler(t)})}get inputFields(){return[this._input]}acceptValue(t){this._isTyping()||!this.allowNew&&e.Utils.isNullOrEmpty(this.datasource)||(this.hint="",this._input.value=this.getViewValue(this.value)||"")}getViewValue(t){var a=super.getViewValue(t);return e.Utils.isNullOrEmpty(a)&&this.allowNew&&!e.Utils.isNullOrEmpty(t)&&(a=this.mapEntityToViewValue(t)),a}_isTyping(){return e.Utils.is(this._input,":focus")}onChange(t){var a=e.DeferPromise.defer();if("suggestionselect"===t.type){const e=t.detail.selectedValue;this.value=e,e&&this._balloon.popout(),a.resolve(e)}else a.resolve(this.value);return a.promise}viewActivatedCallback(){super.viewActivatedCallback();var e=this._createBalloon();e.appendChild(this._repeater),this._checkBalloon(e),document.body.appendChild(e),this._balloon=e,this._input.addEventListener("keydown",this._keydownHandler,!1),this._input.addEventListener("keyup",this._keyupHandler,!1),this._input.addEventListener("focus",this._focusHandler,!1)}propertyChangedCallback(t,a,i,r){if(super.propertyChangedCallback(t,a,i,r),!e.Utils.isNull(this._balloon))switch(t){case"datasource":e.Utils.isNullOrEmpty(i)||this._isTyping()||(this._input.value=this.getViewValue(this.value));break;case"hint":this._isTyping()||(this._input.value=i);break;case"disabled":case"readonly":this._checkBalloon()}}disconnectedCallback(){e.Utils.isNull(this._balloon)||this._balloon.remove(),e.Utils.isNull(this._input)||(this._input.removeEventListener("focus",this._focusHandler,!1),this._input.removeEventListener("keydown",this._keydownHandler,!1),this._input.removeEventListener("keyup",this._keyupHandler,!1)),super.disconnectedCallback()}_focus(t){e.Utils.isNull(t)||(t.focus(),t.dispatchEvent(new Event("focus",{bubbles:!0})))}_filter(t,a){let i=t||[];if(!e.Utils.isNullOrEmpty(a&&a.trim())){const t=a.toLowerCase().split(" ");let r=i.filter(e=>{for(let a of t)if(e.viewValue.toLowerCase().indexOf(a)>=0)return!0;return!1});i=this.allowNew&&e.Utils.isNullOrEmpty(this.valueProperty)&&e.Utils.isNullOrEmpty(this.textProperty)&&(e.Utils.isNullOrEmpty(r)||e.Utils.isNull(r.find(e=>e.viewValue===a)))?[{value:a,viewValue:a}].concat(r):r}let r=i.slice(0,this.maxSuggestions||10);return this._isTyping()&&this._balloon.popup(),this._balloon.style.opacity=e.Utils.isNullOrEmpty(r)?"0":"",this.log(e.Logging.LogLevel.Log,`${r.length} dropdown suggestion(s), given hint '${a}' and ${(t||[]).length} datasource items`),r}_itemCreate(e){const t=e.detail.dom.find(e=>e instanceof HTMLLIElement),a=e.detail.item;e.detail.index;t.tabIndex=0,t.dataset.pacemValue=JSON.stringify(a.value),t.dataset.pacemViewValue=JSON.stringify(a.viewValue),t.addEventListener("keydown",this._selectHandler,!1),t.addEventListener("keyup",this._afterSelectHandler,!1),t.addEventListener("click",this._selectHandler,!1)}_itemRemove(e){const t=e.detail.dom.find(e=>e instanceof HTMLLIElement);t.removeEventListener("keydown",this._selectHandler,!1),t.removeEventListener("keyup",this._afterSelectHandler,!1),t.removeEventListener("click",this._selectHandler,!1)}toggleReadonlyView(e){this.span.hidden=!e,this._input.hidden=e}_checkBalloon(t=this._balloon){e.Utils.isNull(t)||(t.disabled=this.readonly||this.disabled)}_createBalloon(){const a=document.createElement(e.P+"-balloon");return e.Utils.addClass(a,"suggest dropdown"),a.options={trackPosition:!0,trigger:t.UI.BalloonTrigger.Focus,position:t.UI.BalloonPosition.Bottom,size:t.UI.BalloonSizing.Match,align:t.UI.BalloonAlignment.Start,behavior:t.UI.BalloonBehavior.Menu,hoverDelay:0,hoverTimeout:200},a.target=this._input,a}};__decorate([e.ViewChild("input[type=text]")],i.prototype,"_input",void 0),__decorate([e.ViewChild(e.P+"-repeater")],i.prototype,"_repeater",void 0),__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],i.prototype,"span",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"hint",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],i.prototype,"maxSuggestions",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],i.prototype,"allowNew",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-suggest",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<input type="text" class="${e.PCSS}-input" />\n<span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span>\n<${e.P}-repeater datasource="{{ :host._filter(:host.adaptedDatasource, :host.hint) }}"\n    on-${t.RepeaterItemCreateEventName}=":host._itemCreate($event)"\n    on-${t.RepeaterItemRemoveEventName}=":host._itemRemove($event)">\n    <ol>\n        <template>\n            <li><${e.P}-span content="{{ $pacem.highlight(^item.viewValue, ::_input.value) }}"></${e.P}-span></li>\n        </template>\n    </ol>\n</${e.P}-repeater><${e.P}-content></${e.P}-content>`})],i),a.PacemSuggestElement=i}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(a){let i=class PacemTagElement extends t.PacemElement{propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"readonly":let s=!!i;(s?e.Utils.addClass:e.Utils.removeClass)(this,"tag-readonly"),this._btn.disabled=this._btn.hide=s;break;case"tag":e.Utils.removeClass(this,"tag-out")}}_remove(){e.Utils.addClass(this,"tag-out"),e.Utils.addAnimationEndCallback(this,()=>{this.dispatchEvent(new Event("remove"))})}};__decorate([e.Watch({converter:e.PropertyConverters.String})],i.prototype,"tag",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],i.prototype,"readonly",void 0),__decorate([e.ViewChild(e.P+"-button")],i.prototype,"_btn",void 0),i=__decorate([e.CustomElement({tagName:e.P+"-tag",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-text text="{{ :host.tag }}"></${e.P}-text>\n                <${e.P}-button on-click=":host._remove()"></${e.P}-button>`})],i),a.PacemTagElement=i;let r=class PacemTagsElement extends a.PacemDataSourceElement{constructor(){super(!0),this.inputFields=[]}toggleReadonlyView(e){this._suggest.readonly=e,this.querySelector(".tag-new").hidden=e}_tagRemove(t){this.changeHandler(new class TagRemoveEvent extends e.CustomTypedEvent{constructor(e){super("tagremove",{index:e})}}(t))}_tagAdd(t){this.changeHandler(new class TagAddEvent extends e.CustomTypedEvent{constructor(e){super("tagadd",{value:e})}}(t))}handleDatasourceMismatch(){}propertyChangedCallback(t,a,i,r){switch(super.propertyChangedCallback(t,a,i,r),t){case"datasource":case"textProperty":this._suggest[t]=i;break;case"valueProperty":if(!e.Utils.isNullOrEmpty(i))throw`Cannot set 'valueProperty' on ${this.constructor.name}s.`;break;case"value":this._tags.datasource=i}}onChange(t){return new Promise((a,i)=>{switch(t.type){case"tagremove":this._justAddedIndex=-1;const i=t.detail.index,r=e.Utils.clone(this.value),s=r.splice(i+1),o=r.splice(0,i);a(this.value=o.concat(s));break;case"tagadd":const n=t.detail.value,l=e.Utils.clone(this.value);if(!e.Utils.isNullOrEmpty(n)&&(this.allowDuplicates||e.Utils.isNullOrEmpty(l&&l.find(e=>this.mapEntityToViewValue(e)==this.mapEntityToViewValue(n))))){let e=(l||[]).concat([n]);a(this.value=e),this._suggest.hint="",this._suggest.reset(),this._justAddedIndex=this.value.length-1,setTimeout(()=>this._suggest.focus(),250)}break;default:a(this.value)}})}acceptValue(e){}};__decorate([e.Watch({converter:e.PropertyConverters.String})],r.prototype,"hint",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],r.prototype,"allowDuplicates",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],r.prototype,"allowNew",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],r.prototype,"_justAddedIndex",void 0),__decorate([e.ViewChild(e.P+"-suggest")],r.prototype,"_suggest",void 0),__decorate([e.ViewChild(e.P+"-repeater."+e.PCSS+"-tags")],r.prototype,"_tags",void 0),r=__decorate([e.CustomElement({tagName:e.P+"-tags",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-repeater class="${e.PCSS}-tags">\n    <ul class="${e.PCSS}-tags ${e.PCSS}-viewfinder ${e.PCSS}-list list-unstyled list-inline">\n        <template>\n            <li class="${e.PCSS}-tag">\n                <${e.P}-tag on-remove=":host._tagRemove(^index)" css-class="{{ { 'tag-in': :host._justAddedIndex === ^index } }}" tag="{{ :host.mapEntityToViewValue(^item) }}" readonly="{{ :host.readonly }}"></${e.P}-tag>\n            </li>\n        </template>\n        <li class="tag-new">\n            <${e.P}-suggest logger="{{ :host.logger }}" placeholder="{{ :host.placeholder }}" allow-new="{{ :host.allowNew }}" class="${e.PCSS}-tags" on-change=":host._tagAdd($this.value)" hint="{{ :host.hint, twoway }}"></${e.P}-suggest>\n        </li>\n    </ul>\n</${e.P}-repeater>`})],r),a.PacemTagsElement=r}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemMarkdownTextAreaElement extends t.PacemTextualInputElement{constructor(t=new e.MarkdownService){super(),this._md=t,this.rows=5,this.cols=50,this._keydownHandler=(t=>{if(9===t.keyCode){const i=this.input,r=i.value;var a=i.selectionStart;i.value=r.substr(0,a)+"    "+r.substr(a),e.preventDefaultHandler(t)}})}toggleReadonlyView(e){this.input.hidden=e}get preventKeyboardSubmit(){return!0}get inputFields(){return[this.input]}getViewValue(e){return this._md.toHtml(e)}propertyChangedCallback(e,t,a,i){super.propertyChangedCallback(e,t,a,i),"rows"===e||"cols"===e?this.inputField.setAttribute(e,a):"viewValue"==e&&(this._markdown.innerHTML=a)}viewActivatedCallback(){super.viewActivatedCallback(),this.input.addEventListener("keydown",this._keydownHandler,!1)}disconnectedCallback(){this.input&&this.input.removeEventListener("keydown",this._keydownHandler,!1),super.disconnectedCallback()}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],a.prototype,"rows",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],a.prototype,"cols",void 0),__decorate([e.ViewChild("textarea")],a.prototype,"input",void 0),__decorate([e.ViewChild(`div.${e.PCSS}-readonly`)],a.prototype,"_markdown",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-textarea-markdown",template:`<textarea class="${e.PCSS}-input" pacem></textarea>${t.CHAR_COUNTER_CHILD}<div class="${e.PCSS}-readonly ${e.PCSS}-markdown"></div>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemMarkdownTextAreaElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let a=class PacemTextAreaElement extends t.PacemTextualInputElement{constructor(){super(...arguments),this.rows=5,this.cols=50}get preventKeyboardSubmit(){return!0}toggleReadonlyView(e){this._span.hidden=!e,this._input.hidden=e}get inputFields(){return[this._input]}propertyChangedCallback(e,t,a,i){super.propertyChangedCallback(e,t,a,i),"rows"!==e&&"cols"!==e||this.inputField.setAttribute(e,a)}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],a.prototype,"rows",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Number})],a.prototype,"cols",void 0),__decorate([e.ViewChild("textarea")],a.prototype,"_input",void 0),__decorate([e.ViewChild(`span.${e.PCSS}-readonly`)],a.prototype,"_span",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-textarea",template:`<textarea class="${e.PCSS}-input" pacem></textarea>${t.CHAR_COUNTER_CHILD}<span class="${e.PCSS}-readonly"><${e.P}-text text="{{ :host.viewValue }}"></${e.P}-text></span>`,shadow:e.Defaults.USE_SHADOW_ROOT})],a),t.PacemTextAreaElement=a}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){class PacemBaseValidatorElement extends t.PacemFormRelevantElement{constructor(){super()}viewActivatedCallback(){super.viewActivatedCallback(),e.Utils.addClass(this,e.PCSS+"-validator")}propertyChangedCallback(t,a,i,r){super.propertyChangedCallback(t,a,i,r);let s=this.form;switch(t){case"watch":a&&s&&s.unregisterValidator(i,this),s&&s.registerValidator(i,this);break;case"invalid":break;case"form":let r=this.watch;e.Utils.isNullOrEmpty(r)||(null!=a&&a.unregisterValidator(r,this),null!=i&&i.registerValidator(r,this));break;case"disabled":s&&s.validate(this.watch)}}validate(t){return this.disabled?e.Utils.fromResult(!0):this.evaluate(t)}}__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemBaseValidatorElement.prototype,"invalid",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemBaseValidatorElement.prototype,"errorMessage",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],PacemBaseValidatorElement.prototype,"watch",void 0),t.PacemBaseValidatorElement=PacemBaseValidatorElement;const a=`<${e.P}-span hide="{{ !:host.invalid  }}" text="{{ :host.errorMessage }}"></${e.P}-span>`;function i(t){return e.Utils.isNullOrEmpty(t)}let r=class PacemRequiredValidatorElement extends PacemBaseValidatorElement{evaluate(t){let a=!i(t);return e.Utils.fromResult(a)}};r=__decorate([e.CustomElement({tagName:e.P+"-required-validator",template:a,shadow:e.Defaults.USE_SHADOW_ROOT})],r),t.PacemRequiredValidatorElement=r;let s=class PacemRegexValidatorElement extends PacemBaseValidatorElement{evaluate(t){let a=!0,r=this.pattern;return i(t)||(a=new RegExp(r).test(t)),e.Utils.fromResult(a)}};__decorate([e.Watch({converter:e.PropertyConverters.String})],s.prototype,"pattern",void 0),s=__decorate([e.CustomElement({tagName:e.P+"-regex-validator",template:a,shadow:e.Defaults.USE_SHADOW_ROOT})],s),t.PacemRegexValidatorElement=s;let o=class PacemLengthValidatorElement extends PacemBaseValidatorElement{evaluate(t){let a=!0;return i(t)||(this.min>=0&&(a=a&&(t||"").toString().length>=this.min),this.max>=0&&(a=a&&(t||"").toString().length<=this.max)),e.Utils.fromResult(a)}};__decorate([e.Watch({converter:e.PropertyConverters.Number})],o.prototype,"min",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],o.prototype,"max",void 0),o=__decorate([e.CustomElement({tagName:e.P+"-length-validator",template:a,shadow:e.Defaults.USE_SHADOW_ROOT})],o),t.PacemLengthValidatorElement=o;let n=class PacemRangeValidatorElement extends PacemBaseValidatorElement{evaluate(t){let a=!0;if(!i(t)){let i=t;t instanceof Date||"number"!=typeof t&&(i=e.Utils.parseDate(t))instanceof Date&&isFinite(i.valueOf())?(null!=this.min&&(a=a&&i.valueOf()>=e.Utils.parseDate(this.min).valueOf()),null!=this.max&&(a=a&&i.valueOf()<=e.Utils.parseDate(this.max).valueOf())):(null!=this.min&&(a=a&&t>=this.min),null!=this.max&&(a=a&&t<=this.max))}return e.Utils.fromResult(a)}};__decorate([e.Watch({converter:e.PropertyConverters.Number})],n.prototype,"min",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],n.prototype,"max",void 0),n=__decorate([e.CustomElement({tagName:e.P+"-range-validator",template:a,shadow:e.Defaults.USE_SHADOW_ROOT})],n),t.PacemRangeValidatorElement=n;let l=class PacemCompareValidatorElement extends PacemBaseValidatorElement{evaluate(t){let a=!0,r=this.to;if(!i(t)&&!i(r))switch(this.operator){case"lessOrEqual":a=t<=r;break;case"less":a=t<r;break;case"greaterOrEqual":a=t>=r;break;case"greater":a=t>r;break;case"notEqual":a=t!==r;break;default:a=t===r}return e.Utils.fromResult(a)}};__decorate([e.Watch({converter:e.PropertyConverters.String})],l.prototype,"operator",void 0),__decorate([e.Watch({reflectBack:!0})],l.prototype,"to",void 0),l=__decorate([e.CustomElement({tagName:e.P+"-compare-validator",template:a,shadow:e.Defaults.USE_SHADOW_ROOT})],l),t.PacemCompareValidatorElement=l;let d=class PacemBinaryValidatorElement extends PacemBaseValidatorElement{evaluate(t){let a=!0,r=this.pattern,s=this.maxSize;if(!i(t)){if(!e.Utils.isNullOrEmpty(r)){let e="string"==typeof t?t:t.name;a=new RegExp(r,"i").test(e)}!e.Utils.isNull(s)&&"object"==typeof t&&t.size>0&&(a=a&&t.size<=s)}return e.Utils.fromResult(a)}};__decorate([e.Watch({converter:e.PropertyConverters.String})],d.prototype,"pattern",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],d.prototype,"maxSize",void 0),d=__decorate([e.CustomElement({tagName:e.P+"-binary-validator",template:a,shadow:e.Defaults.USE_SHADOW_ROOT})],d),t.PacemBinaryValidatorElement=d;let c=class PacemAsyncValidatorElement extends PacemBaseValidatorElement{constructor(){super(...arguments),this._deferredToken=null}_fetch(t){const a=this._deferredToken,i=this._fetcher;var r=this.parameters||{};return r[this.watch]=t,i.parameters=r,i.url=this.url,i.as="text",i.method=this.method,clearTimeout(this._debouncer),this._debouncer=setTimeout(()=>{i.fetch().then(t=>{const r=i.result;switch(r){case"true":a.resolve(!0);break;case"false":a.resolve(!1);break;default:try{let t=JSON.parse(r),i=e.Utils.getApiResult(t);a.resolve(i||!1)}catch(e){a.resolve(!1)}}},e=>{a.resolve(!1)})},1e3),a.promise}evaluate(t){return e.Utils.isNullOrEmpty(t)?e.Utils.fromResult(!0):(this._deferredToken=this._deferredToken=e.DeferPromise.defer(),this._fetch(t).then(e=>(this._deferredToken=null,e),e=>(this._deferredToken=null,!1)))}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],c.prototype,"parameters",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],c.prototype,"fetchCredentials",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],c.prototype,"fetchHeaders",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],c.prototype,"url",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.String})],c.prototype,"method",void 0),__decorate([e.ViewChild(e.P+"-fetch")],c.prototype,"_fetcher",void 0),c=__decorate([e.CustomElement({tagName:e.P+"-async-validator",template:a+`<${e.P}-fetch autofetch="false" credentials="{{ :host.fetchCredentials }}" headers="{{ :host.fetchHeaders }}"></${e.P}-fetch>`,shadow:e.Defaults.USE_SHADOW_ROOT})],c),t.PacemAsyncValidatorElement=c}(t.Scaffolding||(t.Scaffolding={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const a=e.Net.HttpMethod;t.SwaggerParser=class SwaggerParser{load(e,t){return __awaiter(this,void 0,void 0,function*(){let a=yield fetch(e,{mode:"cors",credentials:"omit",headers:t});try{let t=yield a.json();return this.parse(t,e)}catch(e){return null}})}_findDefinitionName(e){var t=/#\/definitions\/(.+)/.exec(e);return null==t||t.length<2?e:t[1]}parse(e,t){let i=e;"string"==typeof i&&(i=JSON.parse(i));const r=i;let s={};for(let e in r.definitions)s[this._findDefinitionName(e)]=r.definitions[e];let o="";if(r.host&&r.schemes.length>0)o=r.schemes[0]+"://"+r.host+r.basePath;else if(t){let e=/^(https?):\/\/([^\/]+)/.exec(t);e&&e.length&&(!r.schemes&&e.length>1&&(r.schemes=[e[1]]),!r.host&&e.length>2&&(r.host=e[2],r.basePath=""),o=e[0])}else console.warn("Not able to find a base url from the OpenApi specs.");let n={endpoints:[],definitions:s,baseUrl:o};for(let e in r.paths){let t=r.paths[e];for(let i of[a.Get,a.Delete,a.Post,a.Put]){let a=t[i.toLowerCase()];if(a){let t=this._tryGetEndpoint(r,a,e,i);n.endpoints.push(t)}}}return n}_tryGetEndpoint(e,t,a,i){return{response:this._tryGetResponse(e,t),path:a,method:i,parameters:this._tryGetParameters(e,t)}}_translateType(e,a){switch(e){case"number":case"integer":return t.ApiParameterType.Number;case"boolean":return t.ApiParameterType.Boolean;case"string":switch(a){case"date":case"date-time":return t.ApiParameterType.Datetime;case"byte":return t.ApiParameterType.Binary;case"binary":throw"Binary octets not supported."}return t.ApiParameterType.String}return t.ApiParameterType.String}_tryGetParameters(e,a){return(a.parameters||[]).map(a=>{const i=a;let r={name:i.name,required:i.required||!1},s=a.type;if(a.schema){let i=a;r.type=t.ApiParameterType.Object;let s=r.fullType=this._findDefinitionName(i.schema.$ref);r.meta=e.definitions[s]}else s&&(r.type=this._translateType(s,a.format));return r})}_tryGetResponse(e,t){let a=t.responses[200];if(!a||!a.schema)return null;let i,r,s=a.schema.type||"object";return a.schema.$ref?(r=this._findDefinitionName(a.schema.$ref),i=e.definitions[r]):(i=a.schema,a.schema.items&&(a.schema.items.hasOwnProperty("$ref")?(r=this._findDefinitionName(a.schema.items.$ref),i=e.definitions[r]):i=a.schema.items)),{type:s,fullType:r,meta:i}}}}(t.OpenApi||(t.OpenApi={}))}(e.Scaffolding||(e.Scaffolding={}))}(Pacem||(Pacem={})),function(e){!function(e){!function(e){let t;!function(e){e.String="string",e.Number="number",e.Datetime="datetime",e.Boolean="boolean",e.Binary="binary",e.Object="object"}(t=e.ApiParameterType||(e.ApiParameterType={}));const a=/^#\/definitions\/(.+)$/;e.getOpenApiDefinition=function(e,t){var i=a.exec(t);return i&&i.length>1?{name:i[1],schema:e.definitions[i[1]]}:null}}(e.OpenApi||(e.OpenApi={}))}(e.Scaffolding||(e.Scaffolding={}))}(Pacem||(Pacem={}));